
<!doctype html>
<html lang="pt" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="pygeoapi is an OGC Reference Implementation supporting numerous OGC API specifications. This workshop will cover publishing geospatial data to the Web using pygeoapi in support of the suite of OGC API standards.">
      
      
        <meta name="author" content="The pygeoapi community">
      
      
        <link rel="canonical" href="https://dive.pygeoapi.io/print_page/">
      
      
      
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Print Site - Mergulhando na pygeoapi</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/pygeoapi.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/termynal.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/custom.css">
    
    <script>__md_scope=new URL("/",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="pygeoapi" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pt" class="md-skip">
          Ir para o conteúdo
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabeçalho">
    <a href="../pt/" title="Mergulhando na pygeoapi" class="md-header__button md-logo" aria-label="Mergulhando na pygeoapi" data-md-component="logo">
      
  <img src="../assets/images/pygeoapi-icon-notrans.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mergulhando na pygeoapi
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Selecione o idioma">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../publishing/ogcapi-tiles/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../pt/publishing/ogcapi-tiles/" hreflang="pt" class="md-select__link">
              Portuguese
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Buscar" placeholder="Buscar" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Pesquisar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpar" aria-label="Limpar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando a pesquisa
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/geopython/diving-into-pygeoapi" title="Ir ao repositório" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegação" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../pt/" title="Mergulhando na pygeoapi" class="md-nav__button md-logo" aria-label="Mergulhando na pygeoapi" data-md-component="logo">
      
  <img src="../assets/images/pygeoapi-icon-notrans.png" alt="logo">

    </a>
    Mergulhando na pygeoapi
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/geopython/diving-into-pygeoapi" title="Ir ao repositório" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Início
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introdução á pygeoapi
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuração do ambiente da workshop
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Normas
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../pt/publishing/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Publicação
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Publicação
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/publishing/first/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercício 1 - O meu primeiro conjunto de dados
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/publishing/ogcapi-features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercício 2 - Dados vetoriais via OGC API - Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/publishing/ogcapi-coverages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercício 3 - Dados raster via OGC API - Coverages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/publishing/ogcapi-maps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercício 4 - Mapas de dados geoespaciais via OGC API - Maps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/publishing/ogcapi-tiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercício 5 - Tiles de dados geoespaciais via OGC API - Tiles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/publishing/ogcapi-records/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercício 6 - Metadados via OGC API - Records
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/publishing/ogcapi-edr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercício 7 - Dados ambientais via OGC API - Environmental Data Retrieval
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/publishing/ogcapi-processes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercício 8 - Funções via OGC API - Processes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../pt/advanced/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tópicos avançados
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Tópicos avançados
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/advanced/i18n/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Suporte multilíngue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/advanced/crs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Suporte a CRS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/advanced/ui-custom-templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Personalização de UI e templating
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/advanced/downstream-applications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Uso da pygeoapi em aplicações downstream
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/advanced/seo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Otimização para mecanismos de busca (SEO)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/advanced/security-access-control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Segurança e controle de acessos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/advanced/semantic-web-linked-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web Semântica e Linked Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/advanced/cloud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implantação na cloud
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/advanced/inspire/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Suporte INSPIRE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/advanced/administration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Administração
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/advanced/bridges/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercício 9 - pygeoapi como uma ponte para outros serviços
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pt/conclusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conclusão
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Índice">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Índice
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pt" class="md-nav__link">
    <span class="md-ellipsis">
      1 Início
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pt-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      2 Introdução á pygeoapi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pt-setup" class="md-nav__link">
    <span class="md-ellipsis">
      3 Configuração do ambiente da workshop
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pt-standards" class="md-nav__link">
    <span class="md-ellipsis">
      4 Normas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-5" class="md-nav__link">
    <span class="md-ellipsis">
      5 Publicação
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5 Publicação">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pt-publishing" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 Publicação de dados
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-publishing-first" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 Exercício 1 - O meu primeiro conjunto de dados
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-publishing-ogcapi-features" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 Exercício 2 - Dados vetoriais via OGC API - Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-publishing-ogcapi-coverages" class="md-nav__link">
    <span class="md-ellipsis">
      5.4 Exercício 3 - Dados raster via OGC API - Coverages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-publishing-ogcapi-maps" class="md-nav__link">
    <span class="md-ellipsis">
      5.5 Exercício 4 - Mapas de dados geoespaciais via OGC API - Maps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-publishing-ogcapi-tiles" class="md-nav__link">
    <span class="md-ellipsis">
      5.6 Exercício 5 - Tiles de dados geoespaciais via OGC API - Tiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-publishing-ogcapi-records" class="md-nav__link">
    <span class="md-ellipsis">
      5.7 Exercício 6 - Metadados via OGC API - Records
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-publishing-ogcapi-edr" class="md-nav__link">
    <span class="md-ellipsis">
      5.8 Exercício 7 - Dados ambientais via OGC API - Environmental Data Retrieval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-publishing-ogcapi-processes" class="md-nav__link">
    <span class="md-ellipsis">
      5.9 Exercício 8 - Funções via OGC API - Processes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-6" class="md-nav__link">
    <span class="md-ellipsis">
      6 Tópicos avançados
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6 Tópicos avançados">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pt-advanced" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 Tópicos avançados
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-advanced-i18n" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 Suporte multilíngue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-advanced-crs" class="md-nav__link">
    <span class="md-ellipsis">
      6.3 Suporte a CRS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-advanced-ui-custom-templates" class="md-nav__link">
    <span class="md-ellipsis">
      6.4 Personalização de UI e templating
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-advanced-downstream-applications" class="md-nav__link">
    <span class="md-ellipsis">
      6.5 Uso da pygeoapi em aplicações downstream
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-advanced-seo" class="md-nav__link">
    <span class="md-ellipsis">
      6.6 Otimização para mecanismos de busca (SEO)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-advanced-security-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      6.7 Segurança e controle de acessos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-advanced-semantic-web-linked-data" class="md-nav__link">
    <span class="md-ellipsis">
      6.8 Web Semântica e Linked Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-advanced-cloud" class="md-nav__link">
    <span class="md-ellipsis">
      6.9 Implantação na cloud
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-advanced-inspire" class="md-nav__link">
    <span class="md-ellipsis">
      6.10 Suporte INSPIRE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-advanced-administration" class="md-nav__link">
    <span class="md-ellipsis">
      6.11 Administração
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pt-advanced-bridges" class="md-nav__link">
    <span class="md-ellipsis">
      6.12 Exercício 9 - pygeoapi como uma ponte para outros serviços
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pt-conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      7 Conclusão
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="pt" heading-number="1"><h1 id="pt-bem-vinds-a-workshop-mergulhando-na-pygeoapi">Bem-vind@s à workshop Mergulhando na pygeoapi!</h1>
<p>Versão: 1.6.0</p>
<p><img alt="pygeoapi logo" src="../assets/images/pygeoapi-logo.png" /></p>
<p>A <a href="https://pygeoapi.io">pygeoapi</a> é uma implementação em Python de um servidor da suíte de standards <a href="https://ogcapi.ogc.org">OGC API</a>. O projeto surgiu como parte dos esforços da próxima geração da OGC API em 2018 e oferece a capacidade de as organizações implementarem um ponto de acesso (endpoint) RESTful OGC API usando OpenAPI, GeoJSON e HTML. A pygeoapi é de código aberto e disponibilizada sob a licença MIT.</p>
<p>A <strong>Mergulhando na pygeoapi</strong> é uma workshop de meio dia, desenhada para que os utilizadores se familiarizem com a instalação, configuração, publicação de dados e extensão da pygeoapi. Esta workshop abordará a publicação de dados geoespaciais na Web usando a pygeoapi, em conformidade com a suíte de standards OGC API.</p>
<p>Esta workshop abrange uma vasta gama de tópicos (instalação/configuração, publicação, cloud, modelos, plugins, etc.). Por favor, consulte o menu de navegação à esquerda para aceder ao índice.</p>
<h1 id="pt-a-vossa-equipa-da-workshop-da-fsl">A vossa equipa da workshop da <a href="https://festa2025.softwarelivre.eu/">FSL</a></h1>
<table>    
    <tr>
        <td><a href="https://github.com/doublebyte"><img width="150" src="https://avatars.githubusercontent.com/u/1038897?v=4"/></a></td>
        <td><a href="https://github.com/ricardogsilva"><img width="150" src="https://avatars.githubusercontent.com/u/732010?v=4"/></a></td>
        <td><a href="https://codeberg.org/ldesousa"><img width="150" src="https://codeberg.org/avatars/8508bf63cba1d561f24407341653cf925cd7a7b468fcffbb1ce7a8db0e010a30?size=512"/></a></td>
        <td><a href="https://github.com/lcalisto"><img width="150" src="https://avatars.githubusercontent.com/u/4139084?v=4"/></a></td>
    </tr>
</table>

<h1 id="pt-sobre-este-tutorial">Sobre este tutorial</h1>
<p>Este tutorial é uma combinação de explicações passo a passo de vários aspetos da pygeoapi, bem como uma série de exercícios para se familiarizar com o projeto.</p>
<p>Os exercícios são indicados da seguinte forma:</p>
<div class="admonition question">
<p class="admonition-title">Exemplo de exercício</p>
<p>Uma secção marcada desta forma indica que pode experimentar o exercício.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Exemplo de exercício com separadores</p>
<p>Uma secção marcada desta forma indica que pode experimentar o exercício e escolher o seu ambiente (Linux/Mac ou Windows).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="pt-__tabbed_1_1" name="pt-__tabbed_1" type="radio" /><input id="pt-__tabbed_1_2" name="pt-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="pt-__tabbed_1_1">Linux/Mac</label><label for="pt-__tabbed_1_2">Windows</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/default.config.yml:/pygeoapi/local.config.yml<span class="w"> </span>geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/default.config.yml:/pygeoapi/local.config.yml<span class="w"> </span>geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<p>Também irá notar secções de dicas e notas no texto:</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>As dicas oferecem ajuda adicional sobre a melhor forma de realizar tarefas</p>
</div>
<p>Os exemplos são indicados da seguinte forma:</p>
<p>Código
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>This is an HTML sample<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div></p>
<p>Configuração
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">my-collection</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my cool collection title</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my cool collection description</span>
</code></pre></div></td></tr></table></div></p>
<p>Fragmentos de código (snippets) que precisam de ser digitados num terminal/consola são indicados como:</p>
<div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Hello world&#39;</span>
</code></pre></div>
</div>

<h1 id="pt-localizacao-e-materiais-da-workshop">Localização e materiais da workshop</h1>
<p>Esta workshop é sempre disponibilizada ao vivo em <a href="https://dive.pygeoapi.io">https://dive.pygeoapi.io</a>.</p>
<p>Os conteúdos da workshop, a wiki e o sistema de registo de problemas (issue tracker) são geridos no GitHub em <a href="https://github.com/geopython/diving-into-pygeoapi">https://github.com/geopython/diving-into-pygeoapi</a>.</p>
<h2 id="pt-imprimir-esta-workshop">Imprimir esta workshop</h2>
<p>Para imprimir esta workshop, navegue até à <a href="#pt-print_page">página de impressão</a> e selecione <em>Ficheiro &gt; Imprimir &gt; Guardar como PDF</em>.</p>
<h1 id="pt-suporte">Suporte</h1>
<p>Existe um canal no <a href="https://app.gitter.im/#/room/#geopython_diving-into-pygeoapi:gitter.im">Gitter</a> para discussão e suporte ao vivo por parte dos desenvolvedores da workshop e de outros participantes.</p>
<p>Para problemas/bugs/sugestões ou melhorias/contribuições, por favor, utilize o <a href="https://github.com/geopython/diving-into-pygeoapi/issues">issue tracker do GitHub</a>.</p>
<p>Todos os bugs, melhorias e problemas podem ser reportados no <a href="https://github.com/geopython/diving-into-pygeoapi/issues">GitHub</a>.</p>
<p>Como sempre, o suporte principal da pygeoapi e as informações da comunidade podem ser encontrados no <a href="https://pygeoapi.io/community">website</a> da pygeoapi.</p>
<p>As contribuições são sempre incentivadas e bem-vindas!</p>
<h2 id="pt-agora-vamos-a-workshop-bora-la">Agora, vamos à workshop. Bora lá!</h2></section><section class="print-page" id="pt-introduction" heading-number="2"><h1 id="pt-introduction-introducao-a-pygeoapi">Introdução à pygeoapi</h1>
<p>A equipa de desenvolvimento da pygeoapi (sim, em minúsculas) tem o prazer de lhe dar as boas-vindas a esta workshop!</p>
<p>Nesta workshop de meio dia<sup id="fnref:1"><a class="footnote-ref" href="#pt-introduction-fn:1">1</a></sup>, fazemos uma introdução à pygeoapi, e à publicação de dados geoespaciais, fornecendo 
também recursos e dicas para leitura e referência futuras (ou seja, para onde ir quando não souber!).</p>
<p>Embora a pygeoapi seja escrita em Python e seja personalizável e extensível (através de <em>plugins</em>) por 
programadores de Python, não são necessários conhecimentos de Python para instalar, configurar e publicar os seus 
dados geoespaciais como parte desta workshop. Tudo o que precisa para a workshop é o seu editor de texto favorito 
e o Docker (forneceremos mais informações na <a href="#pt-setup">secção de configuração</a>).</p>
<h2 id="pt-introduction-leitura-de-base">Leitura de base</h2>
<p>O <a href="https://pygeoapi.io">website</a> da pygeoapi é o ponto de entrada principal para utilizadores finais e programadores. 
Aí pode encontrar:</p>
<ul>
<li><a href="https://docs.pygeoapi.io">Documentação oficial</a></li>
<li>Várias <a href="https://pygeoapi.io/presentations">apresentações do projeto</a></li>
<li>P código-fonte no <a href="https://github.com/geopython/pygeoapi">GitHub</a></li>
<li>As imagens Docker <a href="https://hub.docker.com/r/geopython/pygeoapi">disponíveis no Docker Hub</a></li>
<li>As versões da pygeoapi no <a href="https://pypi.org/project/pygeoapi">Python Package Index (PyPI)</a></li>
<li>Dado que a pygeoapi implementa uma série de normas OGC API, também poderá querer ler sobre estas 
  em <a href="https://ogcapi.ogc.org">ogcapi.ogc.org</a>.</li>
</ul>
<h2 id="pt-introduction-instalacoes-de-referencia">Instalações de referência</h2>
<p>Várias organizações implementaram a pygeoapi nas suas operações. Para ter uma ideia de como a pygeoapi é usada na 
prática, consulte a nossa página atualizada de 
<a href="https://github.com/geopython/pygeoapi/wiki/LiveDeployments">implementações ativas</a>. </p>
<p>O projeto pygeoapi também mantém uma instalação de demonstração, disponível em:</p>
<p><a href="https://demo.pygeoapi.io">https://demo.pygeoapi.io</a></p>
<p>Esta instalação é operada pela equipa de desenvolvimento. Consulte a 
<a href="https://demo.pygeoapi.io/master">instância principal</a>, que executa sempre a versão mais recente do GitHub.</p>
<p>Interessado na configuração do próprio site de demonstração? O <a href="https://demo.pygeoapi.io">demo.pygeoapi.io</a> é 
desenvolvido num <a href="https://github.com/geopython/demo.pygeoapi.io">repositório GitHub</a> utilizando um fluxo de trabalho 
de disponibilização contínua (CD). Implementações GitOps ainda mais recentes foram desenvolvidas para 
a <a href="https://github.com/Geonovum/ogc-api-testbed">Geonovum</a> e para o <a href="https://github.com/justb4/ogc-api-jrc">Centro Comum de Investigação da Comissão Europeia</a>.</p>
<p>Os exemplos acima podem servir como ponto de partida para a sua própria configuração e implementação da pygeoapi, 
por isso, sinta-se à vontade para os estudar e utilizar!</p>
<h2 id="pt-introduction-historia">História</h2>
<p>Iniciada em 2018, a pygeoapi surgiu como parte dos esforços iniciais para o desenvolvimento das normas OGC API. 
As <em>code sprints</em> da OGC API foram fundamentais para o desenvolvimento ágil e para lançar as bases do projeto.</p>
<p>Os princípios centrais de design são os seguintes:</p>
<ul>
<li>Simplicidade / baixa barreira de entrada</li>
<li>Sustentabilidade a longo prazo</li>
<li>Modularidade</li>
<li>Extensibilidade</li>
<li>Construção sobre um vasto ecossistema de componentes de Código Aberto e da OSGeo, como GDAL, rasterio, Shapely, 
  Pandas, Elasticsearch, PostGIS e muitos outros</li>
</ul>
<p>O projeto foi iniciado por <a href="https://github.com/tomkralidis">Tom Kralidis</a>. Em poucas semanas, vários programadores 
talentosos juntaram-se ao projeto, o que levou à formação de uma equipa principal e de 
um <a href="https://pygeoapi.io/community/psc">Comité de Direção do Projeto (PSC)</a>. As contribuições continuaram também por 
parte de outros programadores e utilizadores que, de bom grado, forneceram novas funcionalidades, correções de erros 
e atualizações da documentação. Como resultado, rapidamente emergiu uma comunidade saudável com um interesse comum 
em código aberto, normas OGC API, baixa barreira de entrada, modularidade e extensibilidade. O resto, como se 
costuma dizer, é história.</p>
<p>Em Fevereiro de 2024 foi realizado o primeiro encontro de desenvolvedores da pygeoapi, em Évora</p>
<p>A pygeoapi é um <a href="https://www.osgeo.org/projects/pygeoapi">Projeto da OSGeo</a> e uma Implementação de Referência da OGC.</p>
<div class="footnote">
<hr />
<ol>
<li id="pt-introduction-fn:1">
<p>A sessão apresentada na <a href="https://festa2025.softwarelivre.eu/">FSL 2025</a> é uma sessão simplificada de 2h30m.&#160;<a class="footnote-backref" href="#pt-introduction-fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><section class="print-page" id="pt-setup" heading-number="3"><h1 id="pt-setup-configuracao-do-ambiente-da-workshop">Configuração do ambiente da workshop</h1>
<p>Nesta workshop, utilizamos os seguintes materiais:</p>
<ol>
<li><strong>Documentação</strong> - (como esta página): aceda à versão mais recente em <a href="https://dive.pygeoapi.io">dive.pygeoapi.io</a></li>
<li><strong>Exercícios</strong> - descarregue o <a href="https://github.com/geopython/diving-into-pygeoapi/archive/refs/heads/main.zip">ficheiro zip mais recente</a>, extraia o conteúdo e encontre os exercícios em <code>workshop/exercises</code> <sup id="fnref:1"><a class="footnote-ref" href="#pt-setup-fn:1">2</a></sup></li>
<li><strong>Docker</strong> - todos os exemplos/exercícios são executados num <code>contentor Docker</code> em <code>workshop/exercises</code></li>
</ol>
<h2 id="pt-setup-editor-de-texto">Editor de Texto</h2>
<p>O seu editor de texto deve ser capaz de editar ficheiros de configuração em <strong>texto simples</strong>. Abaixo estão algumas opções de editores de texto (pode haver outros), juntamente com o que alguns dos programadores da pygeoapi preferem usar:</p>
<ul>
<li>Notepad ou Notepad++ (Windows)</li>
<li>Sublime Text: Angelos</li>
<li>PyCharm: Just</li>
<li>Emacs: Just</li>
<li>Visual Studio Code: Francesco, Angelos, Joana</li>
<li><code>vi</code> / <code>vim</code>: Tom, Angelos</li>
</ul>
<p>Dito isto, sinta-se à vontade para usar o que funciona melhor para si :)</p>
<h2 id="pt-setup-yaml">YAML</h2>
<p>A maioria dos exercícios focar-se-á na edição da <a href="https://docs.pygeoapi.io/en/latest/configuration.html">configuração</a> da pygeoapi, que está no formato <a href="https://yaml.org">YAML</a>. Se não estiver familiarizado com YAML, vale a pena ler um <a href="https://www.cloudbees.com/blog/yaml-tutorial-everything-you-need-get-started">tutorial</a> para se familiarizar com a sintaxe e a indentação do YAML.</p>
<p>O requisito principal para a formação é instalar o Docker e/ou o Docker Compose no seu sistema.
Aconselhamos vivamente a instalação do Docker antes do início da workshop.</p>
<p>Embora sejam possíveis vários cenários de instalação personalizada (consulte a <a href="https://docs.pygeoapi.io/en/latest/installation.html">documentação</a> para mais informações), estes não são considerados nesta workshop, dada a capacidade de instalar um ambiente totalmente reprodutível através do Docker e do Docker Compose.</p>
<p>Os Exercícios da Workshop também serão baseados no Docker, pelo que uma instalação personalizada seria, no mínimo, 'desafiadora'.
A boa notícia é que apenas uma única instalação (Docker) é necessária! As imagens Docker utilizadas nesta workshop contêm a versão mais recente da pygeoapi e todas as suas dependências e serviços externos (ex: PostGIS).</p>
<h2 id="pt-setup-sobre-o-docker">Sobre o Docker</h2>
<p>O Docker está disponível desde 2013 e é fornecido como uma opção de implementação em inúmeros projetos de software FOSS e da OSGeo. Dada a era atual da computação, é provável que já tenha ouvido falar do Docker e de <em>contentorização</em>. Ou, talvez, já esteja familiarizado e, esperamos, já a utilizar o Docker.
Se não for o caso, existe uma abundância de materiais introdutórios que podem ser encontrados online, como este <a href="https://www.ibm.com/topics/docker">tutorial da IBM</a>.</p>
<p>O software FOSS4G beneficiou enormemente do Docker (padrões consistentes de empacotamento, isolamento, integração e atualização) em comparação com as instalações personalizadas. Embora hoje utilizemos principalmente o Docker, a visão geral é o uso de <strong>Contentores</strong> como o próximo passo na virtualização. A contentorização certamente merece uma workshop própria, portanto, para os fins desta workshop, abordaremos apenas os conceitos básicos do Docker e do Docker Compose.</p>
<p>O <a href="https://docs.docker.com/compose">Docker Compose</a> é um complemento do Docker para facilitar a orquestração (configuração) de um ou mais 'Contentores' Docker (um Contentor é uma instância em execução de uma imagem Docker) usando uma convenção de configuração (o ficheiro YAML do Docker Compose), geralmente chamado <code>docker-compose.yml</code>.</p>
<p>Num patamar superior, existem orquestradores Docker ainda mais sofisticados, como o <a href="https://rancher.com/products/rancher">Rancher</a> e o <a href="https://kubernetes.io">Kubernetes</a>, mas para esta workshop, o Docker e o Docker Compose são tudo o que precisamos.</p>
<h2 id="pt-setup-instalacao">Instalação</h2>
<p>A instalação do Docker progrediu muito ao longo dos anos. Esta é a única parte da workshop que depende do sistema/SO que está a utilizar (ex: Windows, Mac ou Linux). Para cada sistema, o site do Docker fornece instruções de instalação detalhadas. Por favor, siga-as de forma consistente.</p>
<p>Para muitas plataformas, está disponível um produto chamado <a href="https://docs.docker.com/desktop">Docker Desktop</a>, que inclui os principais componentes do Docker:</p>
<ul>
<li>Instalação para <a href="https://docs.Docker.com/desktop/install/windows-install">Windows</a></li>
<li>Instalação para <a href="https://docs.Docker.com/desktop/install/mac-install">Mac</a></li>
<li>Instalação para <a href="https://docs.Docker.com/desktop/install/linux-install">Linux</a></li>
</ul>
<p>Algumas notas:</p>
<ul>
<li>No Windows, recomendamos o uso do <a href="https://docs.microsoft.com/en-us/windows/wsl">Subsistema Windows para Linux</a> (WSL), pois também fornece uma linha de comandos poderosa (Bash) e tem uma integração ótima com o Docker. Antes de instalar o Docker Desktop, instale o WSL abrindo o Microsoft PowerShell (executar como administrador) e executando <code>wsl --install</code><ul>
<li><strong>a instalação do WSL requer privilégios de administrador no seu sistema</strong></li>
</ul>
</li>
<li>No Mac, se estiver a usar o <a href="https://brew.sh">Homebrew</a>, considere (como o autor fez) usar a <a href="https://formulae.brew.sh/formula/Docker">fórmula Docker do brew</a></li>
<li>No Mac OSX Monterey e posterior, pode haver um problema com a porta local 5000 já em uso, entrando em conflito com a porta padrão usada pelo contentor da pygeoapi. Se vir este erro <code>OSError: [Errno 48] Address already in use</code>, precisa de desativar o <em>Recetor Airplay</em>. Vá a <code>Definições do Sistema | Partilha</code> ou, como no Sonoma, escreva 'airplay' na caixa de pesquisa. Veja a imagem abaixo para o Mac OSX Sonoma. Há também uma descrição detalhada <a href="https://progressstory.com/tech/port-5000-already-in-use-macos-monterey-issue/">nesta publicação de blog</a>.
<img alt="Definições do MacBook" src="../assets/images/macosx-airplay-disable.png" /></li>
<li>No Linux, pode escolher o instalador relevante para a sua plataforma. Pode também usar o Virtualbox com uma Imagem Ubuntu ou usar uma VM na nuvem.</li>
<li>No Linux, ao encontrar problemas de permissão: o <em>daemon</em> do Docker normalmente é executado como "root". Isto requer que os comandos sejam prefixados com <code>sudo</code> como um utilizador não-root. Na maioria das distribuições, o Docker é acessível por utilizadores no grupo <code>docker</code>. Pode omitir o uso de <code>sudo</code> e prevenir outros possíveis problemas de permissão da seguinte forma:<ul>
<li>Teste se o grupo <code>docker</code> existe: <code>cat /etc/group | grep docker</code>.</li>
<li>Se não existir: <code>sudo groupadd docker</code>.</li>
<li>Adicione o seu utilizador a este grupo: <code>sudo usermod -aG docker $USER</code></li>
<li>Faça log-out e log-in.</li>
<li>Veja todos os detalhes e mais opções <a href="https://docs.docker.com/engine/install/linux-postinstall/#manage-docker-as-a-non-root-user">nesta instrução</a>.</li>
</ul>
</li>
<li>O Docker Desktop inclui uma interface gráfica com algumas opções interessantes. Pode ver logs e informações sobre os contentores em execução, abrir o serviço deles num navegador ou até mesmo abrir um terminal dentro do contentor.</li>
</ul>
<p>Se tudo correr bem, deverá conseguir executar o Docker a partir da linha de comandos da seguinte forma: <sup id="fnref:2"><a class="footnote-ref" href="#pt-setup-fn:2">1</a></sup></p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="pt-setup-__tabbed_1_1" name="pt-setup-__tabbed_1" type="radio" /><input id="pt-setup-__tabbed_1_2" name="pt-setup-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="pt-setup-__tabbed_1_1">Linux/Mac</label><label for="pt-setup-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>version
Docker<span class="w"> </span>version<span class="w"> </span><span class="m">20</span>.10.17,<span class="w"> </span>build<span class="w"> </span>100c701

docker<span class="w"> </span>compose<span class="w"> </span>version
Docker<span class="w"> </span>Compose<span class="w"> </span>version<span class="w"> </span>v2.6.1
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>version
Docker<span class="w"> </span>version<span class="w"> </span><span class="m">20</span>.10.17,<span class="w"> </span>build<span class="w"> </span>100c701

docker<span class="w"> </span>compose<span class="w"> </span>version
Docker<span class="w"> </span>Compose<span class="w"> </span>version<span class="w"> </span>v2.6.1
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>(Não é necessário que os números da sua versão correspondam exatamente).</p>
<h2 id="pt-setup-inicio-rapido">Início Rápido</h2>
<p>Assim que o Docker estiver disponível no seu sistema, executar o contentor da pygeoapi com a sua configuração e dados incorporados é uma única linha de comando.</p>
<p>Abra uma sessão de terminal e execute:</p>
<div class="admonition question">
<p class="admonition-title">Primeira execução via Docker</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="pt-setup-__tabbed_2_1" name="pt-setup-__tabbed_2" type="radio" /><input id="pt-setup-__tabbed_2_2" name="pt-setup-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="pt-setup-__tabbed_2_1">Linux/Mac</label><label for="pt-setup-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>geopython/pygeoapi:latest
Unable<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>image<span class="w"> </span><span class="s1">&#39;geopython/pygeoapi:latest&#39;</span><span class="w"> </span>locally
latest:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>geopython/pygeoapi
d7bfe07ed847:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
d5d0144a7164:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
afe0923a0fa0:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
75f8618c4e86:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
c603397fd6ad:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
6584a95328b3:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
fd93e44631d9:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
6a3201071a5d:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
4f4fb700ef54:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
Digest:<span class="w"> </span>sha256:27b2b219497a6ea382a946ee90ae96ad00b5c1d8e9b725fccf23211978fef124
Status:<span class="w"> </span>Downloaded<span class="w"> </span>newer<span class="w"> </span>image<span class="w"> </span><span class="k">for</span><span class="w"> </span>geopython/pygeoapi:latest
START<span class="w"> </span>/entrypoint.sh
Trying<span class="w"> </span>to<span class="w"> </span>generate<span class="w"> </span>openapi.yml
openapi.yml<span class="w"> </span>generated<span class="w"> </span><span class="k">continue</span><span class="w"> </span>to<span class="w"> </span>pygeoapi
make<span class="w"> </span>SCRIPT_NAME<span class="w"> </span>empty<span class="w"> </span>from<span class="w"> </span>/
Start<span class="w"> </span>gunicorn<span class="w"> </span><span class="nv">name</span><span class="o">=</span>pygeoapi<span class="w"> </span>on<span class="w"> </span><span class="m">0</span>.0.0.0:80<span class="w"> </span>with<span class="w"> </span><span class="m">4</span><span class="w"> </span>workers<span class="w"> </span>and<span class="w"> </span><span class="nv">SCRIPT_NAME</span><span class="o">=</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Starting<span class="w"> </span>gunicorn<span class="w"> </span><span class="m">20</span>.0.4
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Listening<span class="w"> </span>at:<span class="w"> </span>http://0.0.0.0:80<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="o">)</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Using<span class="w"> </span>worker:<span class="w"> </span>gevent
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">18</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">18</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">19</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">19</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">21</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">21</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">22</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">22</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>geopython/pygeoapi:latest
Unable<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>image<span class="w"> </span><span class="s1">&#39;geopython/pygeoapi:latest&#39;</span><span class="w"> </span>locally
latest:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>geopython/pygeoapi
d7bfe07ed847:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
d5d0144a7164:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
afe0923a0fa0:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
75f8618c4e86:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
c603397fd6ad:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
6584a95328b3:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
fd93e44631d9:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
6a3201071a5d:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
4f4fb700ef54:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
Digest:<span class="w"> </span>sha256:27b2b219497a6ea382a946ee90ae96ad00b5c1d8e9b725fccf23211978fef124
Status:<span class="w"> </span>Downloaded<span class="w"> </span>newer<span class="w"> </span>image<span class="w"> </span><span class="k">for</span><span class="w"> </span>geopython/pygeoapi:latest
START<span class="w"> </span>/entrypoint.sh
Trying<span class="w"> </span>to<span class="w"> </span>generate<span class="w"> </span>openapi.yml
openapi.yml<span class="w"> </span>generated<span class="w"> </span><span class="k">continue</span><span class="w"> </span>to<span class="w"> </span>pygeoapi
make<span class="w"> </span>SCRIPT_NAME<span class="w"> </span>empty<span class="w"> </span>from<span class="w"> </span>/
Start<span class="w"> </span>gunicorn<span class="w"> </span><span class="nv">name</span><span class="o">=</span>pygeoapi<span class="w"> </span>on<span class="w"> </span><span class="m">0</span>.0.0.0:80<span class="w"> </span>with<span class="w"> </span><span class="m">4</span><span class="w"> </span>workers<span class="w"> </span>and<span class="w"> </span><span class="nv">SCRIPT_NAME</span><span class="o">=</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Starting<span class="w"> </span>gunicorn<span class="w"> </span><span class="m">20</span>.0.4
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Listening<span class="w"> </span>at:<span class="w"> </span>http://0.0.0.0:80<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="o">)</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Using<span class="w"> </span>worker:<span class="w"> </span>gevent
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">18</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">18</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">19</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">19</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">21</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">21</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">22</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">22</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<p>É tudo! Abra o seu navegador e navegue para <code>http://localhost:5000</code>, a página da pygeoapi será exibida.
Como parte da execução inicial do <code>docker run</code>, o Docker descarregará a Imagem Docker da pygeoapi do <a href="https://hub.Docker.com/r/geopython/pygeoapi">Docker Hub</a>.
Isto pode levar algum tempo, pois a imagem Docker inclui todas as dependências (como GDAL, etc.). Seja paciente! Este é um download único para toda a workshop, ou pode querer fazê-lo antecipadamente.</p>
<p>Algumas notas:</p>
<ul>
<li>O Docker executa um contentor da pygeoapi no seu sistema local na porta 5000, que é mapeada para a porta 80 dentro do contentor.</li>
<li>o contentor Docker da pygeoapi é executado com a <a href="https://github.com/geopython/pygeoapi/blob/master/docker/default.config.yml">configuração padrão</a> e os dados do repositório GitHub.</li>
<li>tanto a configuração como os dados (do repositório GitHub) estão incorporados na Imagem Docker - iremos substituí-los mais tarde.</li>
<li>a opção <code>--rm</code> remove o Contentor Docker (mas não a imagem), após a execução.</li>
<li>pressione <code>CTRL-C</code> para parar o contentor e voltar ao terminal.</li>
</ul>
<p>De seguida, pode substituir a configuração padrão e adicionar os seus próprios dados usando <a href="https://docs.Docker.com/storage/volumes">volumes Docker</a>.</p>
<h2 id="pt-setup-personalizar-a-configuracao">Personalizar a configuração</h2>
<p>Nos próximos exercícios, vamos atualizar o ficheiro de configuração várias vezes.
Para facilitar o desenvolvimento, vamos substituir a configuração da pygeoapi que reside por padrão em <code>/pygeoapi/local.config.yml</code> dentro do contentor por um ficheiro local que pode editar no seu editor de texto favorito.</p>
<div class="admonition question">
<p class="admonition-title">Substituir o ficheiro de configuração da pygeoapi</p>
<p>Descarregue a configuração Docker padrão da pygeoapi de <a href="https://raw.githubusercontent.com/geopython/pygeoapi/master/docker/default.config.yml">default.config.yml</a> para a pasta atual (ou navegue para a pasta onde descarregou o ficheiro), por exemplo com:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="pt-setup-__tabbed_3_1" name="pt-setup-__tabbed_3" type="radio" /><input id="pt-setup-__tabbed_3_2" name="pt-setup-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="pt-setup-__tabbed_3_1">Linux/Mac</label><label for="pt-setup-__tabbed_3_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-O<span class="w"> </span>https://raw.githubusercontent.com/geopython/pygeoapi/master/docker/default.config.yml
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>https://raw.githubusercontent.com/geopython/pygeoapi/master/docker/default.config.yml
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Abra o ficheiro no seu editor de texto favorito e altere o título e a descrição da API:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code>metadata:
    identification:
        title: A minha primeira execução da pygeoapi
        description: a pygeoapi fornece uma API para dados geoespaciais
</code></pre></div></td></tr></table></div>
<p>Agora execute o contentor com o ficheiro de configuração substituído:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="pt-setup-__tabbed_4_1" name="pt-setup-__tabbed_4" type="radio" /><input id="pt-setup-__tabbed_4_2" name="pt-setup-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="pt-setup-__tabbed_4_1">Linux/Mac</label><label for="pt-setup-__tabbed_4_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span><span class="se">\</span>
-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/default.config.yml:/pygeoapi/local.config.yml<span class="w"> </span><span class="se">\</span>
geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/default.config.yml:/pygeoapi/local.config.yml<span class="w"> </span>geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Neste ponto, navegue para <code>http://localhost:5000</code> para verificar o novo título e descrição.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>No Windows, o ficheiro descarregado pode ser renomeado para <code>default.config.yml.txt</code>. Certifique-se de renomear o ficheiro para <code>default.config.yml</code>.</p>
</div>
<p>Ao usar uma montagem de volume Docker (opção <code>-v</code>), o Docker anexa ou 'monta' um diretório ou um único ficheiro do seu sistema anfitrião/local no Contentor Docker.</p>
<p>No trecho de código acima, <code>$(pwd)</code> indica a pasta de trabalho a partir da qual inicia o contentor Docker.</p>
<h2 id="pt-setup-adicionar-dados-e-definir-o-ficheiro-de-configuracao">Adicionar dados e definir o ficheiro de configuração</h2>
<p>Além de adaptar a configuração, geralmente adicionará os seus próprios dados como ficheiros ou serviços de dados remotos como PostGIS ou WFS.</p>
<p>Também pode montar um diretório local como <code>data/</code> para <code>/pygeoapi/mydata</code> dentro do Contentor.
Dentro do diretório de dados, pode armazenar dados vetoriais, ficheiros raster ou conjuntos de imagens de mosaicos vetoriais.</p>
<p>Abaixo está um exemplo onde a configuração é explicitamente definida para <code>pygeoapi-config.yml</code> através de uma variável de ambiente (<code>-e</code>) e usa uma montagem Docker para montar a pasta local <code>data</code> como <code>/pygeoapi/mydata</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="pt-setup-__tabbed_5_1" name="pt-setup-__tabbed_5" type="radio" /><input id="pt-setup-__tabbed_5_2" name="pt-setup-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="pt-setup-__tabbed_5_1">Linux/Mac</label><label for="pt-setup-__tabbed_5_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span><span class="se">\</span>
-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/data:/pygeoapi/mydata<span class="w"> </span><span class="se">\</span>
-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/default.config.yml:/pygeoapi/pygeoapi-config.yml<span class="w"> </span><span class="se">\</span>
-e<span class="w"> </span><span class="nv">PYGEOAPI_CONFIG</span><span class="o">=</span>/pygeoapi/pygeoapi-config.yml<span class="w"> </span><span class="se">\</span>
geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/data:/pygeoapi/mydata<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/default.config.yml:/pygeoapi/pygeoapi-config.yml<span class="w"> </span>-e<span class="w"> </span><span class="nv">PYGEOAPI_CONFIG</span><span class="o">=</span>/pygeoapi/pygeoapi-config.yml<span class="w"> </span>geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Nas próximas secções, analisaremos exemplos adicionais de montagens na pasta de dados. Mais exemplos de implementação do Docker podem ser encontrados no <a href="https://github.com/geopython/pygeoapi/tree/master/docker/examples">repositório GitHub da pygeoapi</a>.</p>
<h2 id="pt-setup-usar-o-docker-para-clientes-python">Usar o Docker para Clientes Python</h2>
<p>Em alguns exercícios, acedemos a <em>endpoints</em> remotos da <code>pygeoapi</code> usando a <a href="https://owslib.readthedocs.io">OWSLib</a>, uma biblioteca Python para interagir com os Serviços Web da OGC. A OWSLib pode ser instalada usando o comando padrão do Python <code>pip3 install OWSLib</code>, mas pode não ter o Python disponível, ou querer manter o seu sistema 'limpo'.</p>
<p>Como o Docker já está disponível no seu sistema, pode iniciar um Contentor com um ambiente Python completo e acedê-lo a partir de um <em>prompt</em> de shell <code>bash</code>. A linha mágica é:</p>
<p><code>docker run -it --rm --network=host --name owslib python:3.10-slim /bin/bash</code></p>
<p>Isto irá descarregar uma Imagem Docker oficial e pequena (125MB) do Python. Quando o Contentor é iniciado, é direcionado para uma sessão/<em>prompt</em> <code>bash</code>. O argumento <code>--network=host</code> permite que interaja diretamente com os serviços no seu sistema anfitrião, portanto com a <code>pygeoapi</code>, sem configurar uma rede Docker. A partir daí, pode iniciar o <code>python3</code>, instalar a OWSLib e talvez até outras ferramentas como <code>curl</code> e <code>wget</code>.</p>
<p>Abaixo está um exemplo completo, assumindo que a pygeoapi está a ser executada no seu <code>localhost</code> na porta 5000:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="pt-setup-__tabbed_6_1" name="pt-setup-__tabbed_6" type="radio" /><input id="pt-setup-__tabbed_6_2" name="pt-setup-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="pt-setup-__tabbed_6_1">Linux/Mac</label><label for="pt-setup-__tabbed_6_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>--network<span class="o">=</span>host<span class="w"> </span>--name<span class="w"> </span>owslib<span class="w"> </span>python:3.10-slim<span class="w"> </span>/bin/bash
Unable<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>image<span class="w"> </span><span class="s1">&#39;python:3.10-slim&#39;</span><span class="w"> </span>locally
<span class="m">3</span>.10-slim:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>library/python
5b5fe70539cd:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
f4b0e4004dc0:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
c5424f0ac885:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
9d21fe1624ec:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
de0194aa1c21:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
Digest:<span class="w"> </span>sha256:7dc5b4e948acd18c1633b0e593ad0224298646612ce7d0b5ac6d4e17616d7e4b
Status:<span class="w"> </span>Downloaded<span class="w"> </span>newer<span class="w"> </span>image<span class="w"> </span><span class="k">for</span><span class="w"> </span>python:3.10-slim

root@docker-desktop:/#<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>owslib
root@docker-desktop:/#<span class="w"> </span>python3
&gt;&gt;&gt;<span class="w"> </span>from<span class="w"> </span>owslib.ogcapi.features<span class="w"> </span>import<span class="w"> </span>Features
&gt;&gt;&gt;<span class="w"> </span><span class="nv">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Features<span class="o">(</span><span class="s1">&#39;http://localhost:5000&#39;</span><span class="o">)</span>
&gt;&gt;&gt;<span class="w"> </span>w
&lt;owslib.ogcapi.features.Features<span class="w"> </span>object<span class="w"> </span>at<span class="w"> </span>0x7ff493e6f850&gt;
&gt;&gt;&gt;<span class="w"> </span><span class="nv">conformance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>w.conformance<span class="o">()</span>
&gt;&gt;&gt;<span class="w"> </span>conformance
etc
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>--network<span class="o">=</span>host<span class="w"> </span>--name<span class="w"> </span>owslib<span class="w"> </span>python:3.10-slim<span class="w"> </span>/bin/bash
Unable<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>image<span class="w"> </span><span class="s1">&#39;python:3.10-slim&#39;</span><span class="w"> </span>locally
<span class="m">3</span>.10-slim:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>library/python
5b5fe70539cd:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
f4b0e4004dc0:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
c5424f0ac885:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
9d21fe1624ec:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
de0194aa1c21:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
Digest:<span class="w"> </span>sha256:7dc5b4e948acd18c1633b0e593ad0224298646612ce7d0b5ac6d4e17616d7e4b
Status:<span class="w"> </span>Downloaded<span class="w"> </span>newer<span class="w"> </span>image<span class="w"> </span><span class="k">for</span><span class="w"> </span>python:3.10-slim

root@docker-desktop:/#<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>owslib
root@docker-desktop:/#<span class="w"> </span>python3
&gt;&gt;&gt;<span class="w"> </span>from<span class="w"> </span>owslib.ogcapi.features<span class="w"> </span>import<span class="w"> </span>Features
&gt;&gt;&gt;<span class="w"> </span><span class="nv">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Features<span class="o">(</span><span class="s1">&#39;http://localhost:5000&#39;</span><span class="o">)</span>
&gt;&gt;&gt;<span class="w"> </span>w
&lt;owslib.ogcapi.features.Features<span class="w"> </span>object<span class="w"> </span>at<span class="w"> </span>0x7ff493e6f850&gt;
&gt;&gt;&gt;<span class="w"> </span><span class="nv">conformance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>w.conformance<span class="o">()</span>
&gt;&gt;&gt;<span class="w"> </span>conformance
etc
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Faremos referência a esta instalação em alguns dos Exercícios onde a OWSLib é utilizada.</p>
<div class="footnote">
<hr />
<ol>
<li id="pt-setup-fn:2">
<p>Para versões recentes do Docker, execute <code>docker compose version</code>&#160;<a class="footnote-backref" href="#pt-setup-fnref:2" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="pt-setup-fn:1">
<p>Em alternativa, pode fazer um <em>fork</em>/clonar o repositório GitHub desta workshop diretamente de <a href="https://github.com/geopython/diving-into-pygeoapi">https://github.com/geopython/diving-into-pygeoapi</a>.&#160;<a class="footnote-backref" href="#pt-setup-fnref:1" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><section class="print-page" id="pt-standards" heading-number="4"><h1 id="pt-standards-visao-geral">Visão Geral</h1>
<p>Esta secção fornece uma visão geral de alto nível do suporte a normas na pygeoapi.</p>
<h1 id="pt-standards-normas">Normas</h1>
<p>As normas abertas são o núcleo da pygeoapi e permitem uma ampla interoperabilidade e capacidade <em>plug and play</em>. A pygeoapi suporta uma série de normas abertas (tanto normas formais como de facto ou impulsionadas pela comunidade).</p>
<h2 id="pt-standards-normas-api">Normas API</h2>
<h3 id="pt-standards-ogc-api">OGC API</h3>
<p>A pygeoapi implementa o conjunto de normas <a href="https://ogcapi.ogc.org">OGC API</a> do <a href="https://www.ogc.org/">Open Geospatial Consortium</a> (OGC). Do website da OGC API:</p>
<div class="admonition citation">
<p class="admonition-title">Citation</p>
<p>A família de normas OGC API está a ser desenvolvida para facilitar a qualquer pessoa o fornecimento de dados geoespaciais para a web. Estas normas baseiam-se no legado das normas OGC Web Service (WMS, WFS, WCS, WPS, etc.), mas definem APIs centradas em recursos que tiram partido das práticas modernas de desenvolvimento web. Esta página web fornece informações sobre estas normas num local consolidado.</p>
<p>Estas normas estão a ser construídas como "blocos de construção" que podem ser usados para montar APIs inovadoras para acesso via web a conteúdo geoespacial. Os blocos de construção são definidos não só pelos requisitos das normas específicas, mas também através da prototipagem de interoperabilidade e testes no Programa de Inovação da OGC.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Pode aprender mais sobre as OGC APIs na <a href="https://ogcapi-workshop.ogc.org">workshop da OGC API</a></p>
</div>
<h4 id="pt-standards-ogc-api-common">OGC API - Common</h4>
<p>A <a href="https://ogcapi.ogc.org/common/">OGC API - Common</a> é uma estrutura comum utilizada em todas as OGC API.
A OGC API - Common fornece a seguinte funcionalidade:</p>
<ul>
<li>baseada na <a href="https://spec.openapis.org/oas/latest.html">OpenAPI 3.0</a></li>
<li>HTML e JSON como as codificações dominantes, sendo possíveis codificações alternativas</li>
<li><em>endpoints</em> partilhados, tais como:<ul>
<li><code>/</code> (página de entrada)</li>
<li><code>/conformance</code></li>
<li><code>/openapi</code></li>
<li><code>/collections</code></li>
<li><code>/collections/foo</code></li>
</ul>
</li>
<li>aspetos como paginação, ligações entre recursos, filtragem básica, parâmetros de consulta (<code>bbox</code>, <code>datetime</code>, etc.)</li>
<li>modelos partilhados (exceções, ligações, etc.)</li>
</ul>
<p>A OGC API - Common permite que os programadores de especificações se concentrem na funcionalidade principal de uma determinada API (ou seja, acesso a dados, etc.), utilizando construções comuns. Isto harmoniza as normas OGC API e permite uma integração mais profunda com menos código. Isto também permite que o software cliente da OGC API seja mais simplificado.</p>
<p>O <em>endpoint</em> <code>/conformance</code> indica quais as normas e extensões que são suportadas por uma implementação da OGC API.</p>
<h4 id="pt-standards-blocos-de-construcao-da-ogc-api">Blocos de construção da OGC API</h4>
<p>A abordagem da OGC API permite a modularidade e a "criação de perfis" de APIs, dependendo dos seus requisitos. Isto significa que pode misturar e combinar diferentes OGC APIs.</p>
<p><img alt="Blocos de construção da OGC API" src="../assets/images/ogc-api-building-blocks.png" /></p>
<p>Pode ler mais sobre este tópico no <a href="https://blocks.ogc.org/">website dos blocos de construção</a>.</p>
<h4 id="pt-standards-mais-ogc-apis">Mais OGC APIs</h4>
<p>O esforço da OGC API está a evoluir rapidamente. Várias normas OGC API estão em desenvolvimento e serão implementadas na pygeoapi ao longo do tempo:</p>
<ul>
<li><a href="https://ogcapi.ogc.org/routes">Routes</a> fornece acesso a dados de roteamento</li>
<li><a href="https://ogcapi.ogc.org/styles">Styles</a> define uma API Web que permite que servidores de mapas, clientes, bem como editores de estilo visual, giram e obtenham estilos</li>
<li><a href="https://ogcapi.ogc.org/geovolumes">3D GeoVolumes</a> facilita a descoberta e o acesso eficientes a conteúdo 3D em múltiplos formatos, com base numa perspetiva centrada no espaço</li>
<li><a href="https://ogcapi.ogc.org/movingfeatures">Moving Features</a> define uma API que fornece acesso a dados que representam elementos que se movem como corpos rígidos</li>
<li><a href="https://ogcapi.ogc.org/joins">Joins</a> suporta a junção de dados, de múltiplas fontes, com coleções de elementos ou diretamente com outros ficheiros de entrada</li>
<li><a href="https://ogcapi.ogc.org/dggs">Discrete Global Grid System</a> permite que as aplicações organizem e acedam a dados organizados de acordo com um Discrete Global Grid System (DGGS)</li>
</ul>
<p><img alt="Normas OGC API aprovadas e candidatas" src="../assets/images/ogcapis.png" /></p>
<h4 id="pt-standards-ogc-apis-suportadas-pela-pygeoapi">OGC APIs suportadas pela pygeoapi</h4>
<p>A pygeoapi implementa várias normas e rascunhos de normas da OGC API. Além disso, é certificada em conformidade e até mesmo uma Implementação de Referência (RI) para algumas delas. A certificação de conformidade é importante para remover os riscos de interoperabilidade. As RI são sempre certificadas em conformidade. Do OGC <a href="https://docs.ogc.org/pol/08-134r11.html#toc26">Compliance Testing Program Policies &amp; Procedures 08-134r11</a>:</p>
<div class="admonition citation">
<p class="admonition-title">Citation</p>
<p>Os Produtos Candidatos que passam em todos os testes de um Pacote de Testes de Conformidade, e que a OGC reviu e certificou como tendo passado nesses testes, são considerados conformes com essa versão da Norma de Implementação.</p>
</div>
<div class="admonition citation">
<p class="admonition-title">Citation</p>
<p>Uma Implementação de Referência é uma cópia totalmente funcional e licenciada de um software testado e de marca que passou no teste para uma classe de conformidade associada numa versão de uma Norma de Implementação e que está disponível gratuitamente e publicamente para teste através de um serviço web ou download.</p>
</div>
<table>
<thead>
<tr>
<th>Norma</th>
<th>Estado na pygeoapi</th>
<th>Incluída nesta workshop</th>
</tr>
</thead>
<tbody>
<tr>
<td>OGC API - Features</td>
<td>Referência</td>
<td>✅</td>
</tr>
<tr>
<td>OGC API - Coverages</td>
<td>Em implementação</td>
<td>✅</td>
</tr>
<tr>
<td>OGC API - Tiles</td>
<td>Referência</td>
<td>✅</td>
</tr>
<tr>
<td>OGC API - Maps</td>
<td>Em implementação</td>
<td>✅</td>
</tr>
<tr>
<td>OGC API - Processes</td>
<td>Certificada</td>
<td>✅</td>
</tr>
<tr>
<td>OGC API - Records</td>
<td>Em implementação</td>
<td>✅</td>
</tr>
<tr>
<td>OGC API - Environmental Data Retrieval</td>
<td>Referência</td>
<td>✅</td>
</tr>
<tr>
<td>SpatioTemporal Asset Catalog</td>
<td>Em implementação</td>
<td></td>
</tr>
<tr>
<td>OGC API - Routes</td>
<td>Planeada</td>
<td></td>
</tr>
<tr>
<td>OGC API - Styles</td>
<td>Planeada</td>
<td></td>
</tr>
<tr>
<td>OGC API - Moving Features</td>
<td>Planeada</td>
<td></td>
</tr>
<tr>
<td>OGC API - DGGS</td>
<td>Planeada</td>
<td></td>
</tr>
</tbody>
</table>
<p>Na próxima secção, vamos aprofundar as APIs dedicadas relacionadas com tipos específicos de informação. Irá notar que todas as APIs são combinadas e disponibilizadas através de um único <em>endpoint</em> da OGC API, graças à OGC API - Common.</p>
<h4 id="pt-standards-openapi">OpenAPI</h4>
<p>No centro da OGC API - Common está a <a href="https://www.openapis.org/about">iniciativa OpenAPI</a> para ajudar a descrever e documentar uma API. A OpenAPI define a sua estrutura num documento OpenAPI. A OGC API - Common sugere que este documento esteja localizado em <code>/openapi</code>. Com a pygeoapi num navegador, <a href="https://demo.pygeoapi.io/master/openapi">este URL</a> abre uma página HTML interativa que facilita a consulta à API. Acrescente <code>?f=json</code> para ver o documento em JSON. O documento OpenAPI indica que <em>endpoints</em> estão disponíveis no serviço, que parâmetros aceita e que tipos de respostas podem ser esperados. O documento OpenAPI é um conceito semelhante ao XML de Capacidades (<em>Capabilities</em>) como parte da primeira geração de normas OGC Web Service.</p>
<div class="admonition question">
<p class="admonition-title">Análise da Especificação OpenAPI num navegador</p>
<p>Uma abordagem comum para interagir com Open APIs usando JSON é usar um programa como o <a href="https://www.postman.com/">Postman</a>. Também existem <em>plugins</em> de navegador que permitem definir pedidos à API interativamente. Para o Firefox, descarregue o <em>plugin</em> <a href="https://pluginsaddonsextensions.com/mozilla-firefox/poster-mozilla-addon">poster</a>. Para o Chrome e Edge, use o <a href="https://microsoftedge.microsoft.com/addons/detail/boomerang-soap-rest-c/bhmdjpobkcdcompmlhiigoidknlgghfo?hl=en-US">Boomerang</a>. No Boomerang, pode criar pedidos web individuais, mas também carregar o documento de especificação da open api e interagir com qualquer um dos <em>endpoints</em> anunciados.</p>
</div>
<p>A comunidade OpenAPI fornece várias ferramentas, como um validador para documentos OAS ou para <a href="https://swagger.io/tools/swagger-codegen/">gerar código</a> como ponto de partida para o desenvolvimento de clientes.</p>
<h2 id="pt-standards-normas-de-conteudo-e-formato">Normas de conteúdo e formato</h2>
<p>O JSON é fundamental na pygeoapi, fornecendo um formato que é legível por máquina e fácil de analisar e manusear por software e ferramentas cliente. A OGC API - Common fornece formatos JSON uniformes para os vários <em>endpoints</em> que suporta. Normas específicas da OGC API podem especificar formatos de domínio específico (por exemplo, GeoJSON para a OGC API - Features, GeoTIFF para a OGC API - Coverages) dependendo do(s) tipo(s) de dados.</p>
<h1 id="pt-standards-convencoes-especificas-da-pygeoapi">Convenções específicas da pygeoapi</h1>
<p>A pygeoapi fornece algumas convenções que não são apresentadas pelas normas OGC API, no entanto, facilitam algumas funcionalidades e capacidades.</p>
<h2 id="pt-standards-o-parametro-f">o parâmetro <code>f</code></h2>
<p>O parâmetro <code>f</code> pode ser usado com qualquer <em>endpoint</em> da pygeoapi para especificar um formato de saída para um determinado pedido à API. Exemplos são <code>f=html</code>, <code>f=json</code>, etc.</p>
<div class="admonition question">
<p class="admonition-title">Usar um navegador web para aceder à OGC API</p>
<p>Use o seu navegador web para navegar para <a href="https://demo.pygeoapi.io/master">demo.pygeoapi.io</a>. Um navegador, por defeito, abre qualquer OGC API em HTML (como uma página web) devido ao cabeçalho <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept">HTTP Accept</a> enviado pelo navegador (<code>text/html</code>). No canto superior direito, irá notar uma ligação JSON. A ligação adiciona o parâmetro ao URL: <code>f=json</code>, que é um mecanismo da pygeoapi para sobrepor o cabeçalho HTTP Accept enviado pelo navegador web.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ao chamar uma OGC API a partir de javascript, e o objetivo é receber JSON, pode usar a convenção <code>?f=json</code> da pygeoapi, ou a negociação de conteúdo conforme previsto pela norma; inclua um cabeçalho HTTP <code>Accept: "application/json"</code> no seu pedido.</p>
<p>Em jQuery, por exemplo, isto é representado pela propriedade dataType:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
<span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://demo.pygeoapi.io/master&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">dataType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;json&quot;</span>
<span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Ou usando a API fetch nativa:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;GET&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s1">&#39;Accept&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">});</span>
</code></pre></div></td></tr></table></div>
</div>
<h2 id="pt-standards-o-parametro-skipgeometry">o parâmetro <code>skipGeometry</code></h2>
<p>O parâmetro <code>skipGeometry</code> (<code>true|false</code>, o padrão é <code>false</code>) pode ser usado com o acesso a dados de elementos (<em>features</em>) para facilitar o download de dados vetoriais sem geometria, se desejado.</p>
<h1 id="pt-standards-resumo">Resumo</h1>
<p>As normas são uma pedra angular da pygeoapi e permitir-lhe-ão publicar os seus dados de forma eficiente e com uma baixa barreira para os utilizadores. Agora, vamos à ação: <strong>Publicar dados</strong></p></section>
                    <section class='print-page md-section' id='section-5' heading-number='5'>
                        <h1>Publicação<a class='headerlink' href='#section-5' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="pt-publishing" heading-number="5.1"><h1 id="pt-publishing-publicacao-de-dados">Publicação de Dados</h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Certifique-se de que tem a pygeoapi configurada e que consegue executar o serviço com a configuração de defeito em <a href="http://localhost:5000">http://localhost:5000</a>.</p>
</div>
<p>Nesta secção, irá aprender a publicar diferentes tipos de dados geoespaciais e metadados através dos seguintes exercícios:</p>
<ul>
<li><a href="#pt-publishing-first">Exercício 1 - O meu primeiro conjunto de dados</a></li>
<li><a href="#pt-publishing-ogcapi-features">Exercício 2 - Dados vetoriais via OGC API - Features</a></li>
<li><a href="#pt-publishing-ogcapi-coverages">Exercício 3 - Dados raster via OGC API - Coverages</a></li>
<li><a href="#pt-publishing-ogcapi-maps">Exercício 4 - Mapas de dados geoespaciais via OGC API - Maps</a></li>
<li><a href="#pt-publishing-ogcapi-tiles">Exercício 5 - Mosaicos de dados geoespaciais via OGC API - Tiles</a></li>
<li><a href="#pt-publishing-ogcapi-records">Exercício 6 - Metadados via OGC API - Records</a></li>
<li><a href="#pt-publishing-ogcapi-edr">Exercício 7 - Dados ambientais via OGC API - Environmental Data Retrieval</a></li>
<li><a href="#pt-publishing-ogcapi-processes">Exercício 8 - Funções via OGC API - Processes</a></li>
<li><a href="#pt-advanced-bridges">Exercício 9 - pygeoapi como uma ponte para outros serviços</a></li>
</ul></section><section class="print-page" id="pt-publishing-first" heading-number="5.2"><h1 id="pt-publishing-first-exercicio-1-o-primeiro-conjunto-de-dados">Exercício 1 - O primeiro conjunto de dados</h1>
<p>Nesta secção, irá publicar um conjunto de dados vetoriais.</p>
<p>Para este exercício, iremos usar um conjunto de dados CSV de <a href="https://github.com/geopython/diving-into-pygeoapi/tree/main/workshop/exercises/data/tartu/bathingwater-estonia.csv">águas balneares na Estónia</a>, gentilmente cedido pela <a href="https://terviseamet.ee">Agência de Saúde da Estónia</a>.</p>
<p>Pode encontrar este conjunto de dados em <code>workshop/exercises/data/tartu/bathingwater-estonia.csv</code>.</p>
<p>Este exercício consiste em ajustar o <code>workshop/exercises/pygeoapi.config.yml</code> para definir este conjunto de dados como uma <em>coleção</em> da OGC API - Features.</p>
<h2 id="pt-publishing-first-verificar-a-configuracao-existente-do-docker-compose">Verificar a configuração existente do Docker Compose</h2>
<p>Antes de fazer quaisquer alterações, vamos garantir que a configuração inicial do Docker Compose que lhe foi fornecida está a funcionar.</p>
<p>Para testar:</p>
<div class="admonition question">
<p class="admonition-title">Testar a configuração do workshop</p>
<ol>
<li>Numa shell de terminal, navegue para a pasta do workshop e digite:</li>
</ol>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="pt-publishing-first-__tabbed_1_1" name="pt-publishing-first-__tabbed_1" type="radio" /><input id="pt-publishing-first-__tabbed_1_2" name="pt-publishing-first-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-first-__tabbed_1_1">Linux/Mac</label><label for="pt-publishing-first-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises
docker<span class="w"> </span>compose<span class="w"> </span>up
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises
docker<span class="w"> </span>compose<span class="w"> </span>up
</code></pre></div>
</div></p>
</div>
</div>
</div>
<ol>
<li>Abra <a href="http://localhost:5000">http://localhost:5000</a> no seu navegador, verifique algumas coleções</li>
<li>Feche digitando <code>CTRL-C</code></li>
</ol>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Também pode executar o contentor Docker em segundo plano (detached) da seguinte forma:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="pt-publishing-first-__tabbed_2_1" name="pt-publishing-first-__tabbed_2" type="radio" /><input id="pt-publishing-first-__tabbed_2_2" name="pt-publishing-first-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-first-__tabbed_2_1">Linux/Mac</label><label for="pt-publishing-first-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
docker<span class="w"> </span>ps<span class="w">  </span><span class="c1"># verifique que o container pygeoapi está em execução</span>
<span class="c1"># visite http://localhost:5000 no seu navegador, verifique algumas coleções</span>
docker<span class="w"> </span>logs<span class="w"> </span>--follow<span class="w"> </span>pygeoapi<span class="w">  </span><span class="c1"># ver registos</span>
docker<span class="w"> </span>compose<span class="w"> </span>down<span class="w"> </span>--remove-orphans
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
docker<span class="w"> </span>ps<span class="w">  </span><span class="c1"># verifique que o container pygeoapi está em execução</span>
<span class="c1"># visite http://localhost:5000 no seu navegador, verifique algumas coleções</span>
docker<span class="w"> </span>logs<span class="w"> </span>--follow<span class="w"> </span>pygeoapi<span class="w">  </span><span class="c1"># ver registos</span>
docker<span class="w"> </span>compose<span class="w"> </span>down<span class="w"> </span>--remove-orphans
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<h2 id="pt-publishing-first-publicar-o-primeiro-conjunto-de-dados">Publicar o primeiro conjunto de dados</h2>
<p>Chegou o momento de publicar o seu primeiro conjunto de dados.</p>
<div class="admonition question">
<p class="admonition-title">Configurar o ficheiro de configuração da pygeoapi</p>
<ol>
<li>Abra o ficheiro <code>workshop/exercises/pygeoapi/pygeoapi.config.yml</code> no seu editor de texto</li>
<li>Procure a secção de configuração comentada que começa com <code># START - EXERCISE 1 - Your First Collection</code></li>
<li>Descomente todas as linhas até <code># END - EXERCISE 1 - Your First Collection</code></li>
</ol>
</div>
<p>Certifique-se de que a indentação está alinhada (dica: diretamente abaixo de <code># START ...</code>)</p>
<p>A secção de configuração é a seguinte:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span></pre></div></td><td class="code"><div><pre><span></span><code>    Bathing_Water_Estonia:
        type: collection
        title: Bathing Water Estonia
        description: Locations where the Estonian Health Board monitors the bathing water quality
        keywords:
            - bathing water
            - estonia
        links:
            - type: text/csv
              rel: canonical
              title: data
              href: https://avaandmed.eesti.ee/datasets/supluskohad
              hreflang: EE
        extents:
            spatial:
                bbox: [20,57,29,60]
                crs: http://www.opengis.net/def/crs/EPSG/0/4326
        providers:
            - type: feature
              name: CSV
              data: /data/tartu/bathingwater-estonia.csv
              id_field: id
              title_field: Name
              geometry:
                x_field: x
                y_field: y
              storage_crs: http://www.opengis.net/def/crs/EPSG/0/3300
</code></pre></div></td></tr></table></div>
<p>A parte mais relevante é a secção <code>providers</code>. Aqui, definimos um <code>Provider CSV</code>, apontando o caminho do ficheiro para o diretório <code>/data</code> que iremos montar (ver a seguir) do diretório local para o container de Docker. Como um CSV não é um ficheiro espacial, configuramos explicitamente a pygeoapi para que a longitude e a latitude (x e y) sejam mapeadas a partir das colunas <code>lon</code> e <code>lat</code> no ficheiro CSV. Note o parâmetro <code>storage_crs</code>, que indica o sistema de coordenadas que é usado nos dados de origem.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Para saber mais sobre a sintaxe e as convenções de configuração da pygeoapi, consulte o <a href="https://docs.pygeoapi.io/en/latest/configuration.html">capítulo relevante na documentação</a>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A pygeoapi inclui <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-features.html#providers">inúmeros fornecedores de dados</a> que permitem o acesso a uma variedade de formatos de dados. Através do plugin OGR/GDAL, o número de formatos suportados é quase ilimitado. Consulte a <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-features.html#providers">página do fornecedor de dados</a> para saber como pode configurar uma ligação ao conjunto de dados da sua escolha. Pode sempre copiar um exemplo de configuração relevante e colocá-lo na secção de conjuntos de dados do ficheiro de configuração da pygeoapi para o seu projeto futuro.</p>
</div>
<h2 id="pt-publishing-first-testar">Testar</h2>
<div class="admonition question">
<p class="admonition-title">Iniciar com a configuração atualizada</p>
<ol>
<li>Comece por digitar <code>docker compose up</code></li>
<li>Observe o output do registo (logging)</li>
<li>Se não houver erros: abra <a href="http://localhost:5000">http://localhost:5000</a></li>
<li>Procure a coleção "Bathing Water Estonia"</li>
<li>Navegue pelos itens da coleção</li>
<li>Verifique a representação json adicionando <code>?f=json</code> ao URL (ou clicando em 'json' no canto superior direito)</li>
</ol>
</div>
<h2 id="pt-publishing-first-depuracao-de-erros-de-configuracao">Depuração de erros de configuração</h2>
<p>Ocasionalmente, pode encontrar erros, brevemente discutidos aqui:</p>
<ul>
<li>Não é possível encontrar um ficheiro, um erro de digitação na configuração</li>
<li>O formato ou a estrutura do ficheiro espacial não é totalmente suportado</li>
<li>A porta (5000) já está a ser utilizada. Existe uma pygeoapi anterior ainda em execução? Se alterar a porta, considere que também tem de atualizar o ficheiro de configuração da pygeoapi</li>
</ul>
<p>Existem dois parâmetros no ficheiro de configuração que ajudam a resolver estes problemas.
Defina o nível de registo (logging) para <code>DEBUG</code> e indique um caminho para um ficheiro de registo.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>No Docker, defina o caminho do ficheiro de registo para a pasta montada, para que possa acedê-lo facilmente a partir do seu sistema anfitrião. Também pode ver os registos da consola do seu contentor Docker da seguinte forma:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="pt-publishing-first-__tabbed_3_1" name="pt-publishing-first-__tabbed_3" type="radio" /><input id="pt-publishing-first-__tabbed_3_2" name="pt-publishing-first-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-first-__tabbed_3_1">Linux/Mac</label><label for="pt-publishing-first-__tabbed_3_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>logs<span class="w"> </span>--follow<span class="w"> </span>pygeoapi
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>logs<span class="w"> </span>--follow<span class="w"> </span>pygeoapi
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Erros relacionados com caminhos de ficheiros ocorrem normalmente na configuração inicial. No entanto, também podem acontecer em momentos inesperados, resultando num serviço interrompido. Produtos como o <a href="https://geohealthcheck.org">GeoHealthCheck</a> têm como objetivo monitorizar, detetar e notificar sobre o estado e a disponibilidade do serviço. Os testes da OGC API - Features no GeoHealthCheck verificam a disponibilidade do serviço em intervalos. Consulte a <a href="https://docs.geohealthcheck.org">documentação do GeoHealthCheck</a> para mais informações.</p>
</div></section><section class="print-page" id="pt-publishing-ogcapi-features" heading-number="5.3"><h1 id="pt-publishing-ogcapi-features-exercicio-2-dados-vetoriais-via-ogc-api-features">Exercício 2 - Dados vetoriais via OGC API - Features</h1>
<p>A <a href="https://ogcapi.ogc.org/features">OGC API - Features</a> fornece uma API Web para aceder a dados 
vetoriais (geometrias e os seus atributos). A especificação principal abrange o acesso e consulta básicos 
de dados, partes adicionais estão em desenvolvimento com as seguintes capacidades:</p>
<ul>
<li><a href="https://docs.ogc.org/is/17-069r4/17-069r4.html">OGC API - Features - Parte 1: Core</a> fornece capacidades básicas de acesso e consulta</li>
<li><a href="https://docs.ogc.org/is/18-058r1/18-058r1.html">OGC API - Features - Parte 2: Coordinate Reference Systems by Reference</a> 
  permite a importação e exportação de dados de diferentes sistemas de coordenadas</li>
<li><a href="https://docs.ogc.org/is/19-079r2/19-079r2.html">OGC API - Features - Parte 3: Filtering</a> adiciona a capacidade de 
  pesquisas complexas usando a <a href="https://docs.ogc.org/is/21-065r2/21-065r2.html">Common Query Language (CQL2)</a></li>
<li><a href="https://docs.ogc.org/DRAFTS/20-002r1.html">OGC API - Features - Parte 4: Create, Replace, Update and Delete</a> (<strong>rascunho</strong>) adiciona capacidades transacionais</li>
</ul>
<h2 id="pt-publishing-ogcapi-features-suporte-da-pygeoapi">Suporte da pygeoapi</h2>
<p>A pygeoapi suporta todas as partes da especificação OGC API - Features acima (a Parte 3 depende do suporte do backend, 
por examplo, Elasticsearch).</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Consulte <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-features.html">a documentação oficial</a> 
para mais informações sobre os backends vetoriais suportados.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Consulte <a href="https://docs.pygeoapi.io/en/latest/cql.html">a documentação oficial</a> para mais informações sobre o 
suporte a CQL.</p>
</div>
<p>A seguir, vamos explorar como publicar dados vetoriais usando um <code>GeoPackage</code>.</p>
<h2 id="pt-publishing-ogcapi-features-publicar-um-geopackage">Publicar um GeoPackage</h2>
<p>Na secção anterior, demonstrámos os passos envolvidos para adicionar um conjunto de dados à pygeoapi e atualizar a 
sua configuração. Neste exercício, vamos publicar outro ficheiro vetorial, desta vez de uma fonte de dados 
vetoriais <a href="https://www.geopackage.org">GeoPackage</a> (SQLite3).</p>
<div class="admonition tip">
<p class="admonition-title">Dica</p>
<p>Pode ser útil abrir o conjunto de dados no <a href="https://qgis.org">QGIS</a> enquanto adiciona e atualiza o seu servidor 
da pygeoapi para avaliar facilmente os atributos da tabela, nomes, propriedades espaciais e SRC.</p>
</div>
<p>Vamos adicionar o ficheiro <code>workshop/exercises/data/brazil/guama_river.gpkg.zip</code>:</p>
<div class="admonition question">
<p class="admonition-title">Atualizar a configuração da pygeoapi</p>
<p>Primeiro, vamos descompactar o ficheiro 
<a href="https://github.com/geopython/diving-into-pygeoapi/tree/main/workshop/exercises/data/brazil/guama_river.gpkg.zip">guama_river.gpkg.zip</a> 
para <code>guama_river.gpkg</code>.</p>
<p>Depois, abra o ficheiro de configuração da pygeoapi num editor de texto.
Encontre a linha <code># START - EXERCISE 2 - flowlines Guama River</code>.</p>
<p>Adicione uma nova secção de conjunto de dados. descomentando as linhas até <code># END - EXERCISE 2 - 
flowlines Guama River</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">guama-river</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Guama River</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Guama River Basin mainstem flowlines</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Guama River</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Merit Hydro</span>
<span class="w">    </span><span class="nt">links</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">          </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">          </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data</span>
<span class="w">          </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://www.sciencebase.gov/catalog/item/614a8864d34e0df5fb97572d</span>
<span class="w">          </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EE</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-49.16</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">-5.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">-46.8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">-1.2</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SQLiteGPKG</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/brazil/guama_river.gpkg</span><span class="w"> </span><span class="c1"># coloque o caminho correto aqui</span>
<span class="w">          </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fid</span>
<span class="w">          </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">guama_river</span><span class="w"> </span><span class="c1"># nome da tabela dentro do gpkg</span>
</code></pre></div></td></tr></table></div>
</div>
<p>Guarde o ficheiro e reinicie o Docker Compose. Navegue para <a href="http://localhost:5000/collections">http://localhost:5000/collections</a> para avaliar se o 
novo conjunto de dados com o título <em>"Guama River"</em> foi publicado.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>O driver SQLite incidentalmente tem desafios para abrir a extensão GeoPackage no MacOS.
Consulte a <a href="https://docs.pygeoapi.io/en/latest/development.html#working-with-spatialite-on-osx">documentação oficial</a>
ou tente com um formato de dados alternativo. Se usar Docker, isto não é um problema.</p>
</div>
<h2 id="pt-publishing-ogcapi-features-opcional-publicar-um-ficheiro-geojson-usando-elasticsearch">OPCIONAL: Publicar um ficheiro GeoJSON usando Elasticsearch</h2>
<p>Este exercício é opcional, se o tempo permitir, ou pode realizá-lo após o workshop.</p>
<p>Aqui exploramos a publicação de dados em OGC API - Features usando a pygeoapi com um fornecedor de backend 
Elasticsearch. Para isso, precisamos do repositório GitHub <a href="https://github.com/geopython/pygeoapi-examples">pygeoapi-examples</a>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_1_1" name="pt-publishing-ogcapi-features-__tabbed_1" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_1_2" name="pt-publishing-ogcapi-features-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_1_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/geopython/pygeoapi-examples.git
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/geopython/pygeoapi-examples.git
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Em alternativa, pode <a href="https://github.com/geopython/pygeoapi-examples/archive/refs/heads/main.zip">descarregar o repositório como um ficheiro .zip</a> e descompactá-lo.</p>
<p>Mude para a pasta <code>docker/elastic</code> e execute o ficheiro <code>docker-compose.yml</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_2_1" name="pt-publishing-ogcapi-features-__tabbed_2" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_2_2" name="pt-publishing-ogcapi-features-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_2_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>docker/elastic
docker<span class="w"> </span>compose<span class="w"> </span>up
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>docker/elastic
docker<span class="w"> </span>compose<span class="w"> </span>up
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Se tiver problemas a iniciar os serviços, consulte o 
<a href="https://github.com/geopython/pygeoapi-examples/blob/main/docker/elastic/README.md">ficheiro README</a>. Pode precisar de 
adaptar a configuração de memória virtual do seu sistema.</p>
<p>Primeiro, vamos carregar o ficheiro <code>greater_hyderabad_municipal_corporation_ward_Boundaries.geojson</code> para o 
servidor Elasticsearch.</p>
<p>Edite o script <code>add-data.sh</code> dentro da pasta <code>ES</code>, adicionando estas duas linhas antes do final:</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>curl<span class="w"> </span>-o<span class="w"> </span>/tmp/hyderabad.geojson<span class="w"> </span>https://raw.githubusercontent.com/geopython/diving-into-pygeoapi/refs/heads/main/workshop/exercises/data/hyderabad/greater_hyderabad_municipal_corporation_ward_Boundaries.geojson
python3<span class="w"> </span>/load_es_data.py<span class="w"> </span>/tmp/hyderabad.geojson<span class="w"> </span>objectid
</code></pre></div></td></tr></table></div>
Através destas alterações, o ficheiro <code>greater_hyderabad_municipal_corporation_ward_Boundaries.geojson</code> é descarregado 
para dentro do container Docker do Elasticsearch e depois carregado para o Elasticsearch.</p>
<p>Depois disto, precisamos de reconstruir a imagem Docker:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_3_1" name="pt-publishing-ogcapi-features-__tabbed_3" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_3_2" name="pt-publishing-ogcapi-features-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_3_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_3_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>build
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>build
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>A seguir, precisamos de configurar a pygeoapi inserindo o excerto abaixo no ficheiro de configuração da 
pygeoapi <code>pygeoapi/docker.config.yml</code>. Esta modificação resulta na publicação do 
ficheiro <code>greater_hyderabad_municipal_corporation_ward_boundaries.geojson</code> como OGC API - Features usando o 
fornecedor de backend Elasticsearch.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nt">hyderabad</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Greater Hyderabad Municipal Corporation ward boundaries</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">The city ward boundaries represent the administrative and electoral boundary areas of the city. It plays a great role in planning of the city, for each council of the municipal corporation.</span>
<span class="w">        </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Boundaries</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Administrative</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ward</span>
<span class="w">        </span><span class="nt">links</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">              </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">              </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">information</span>
<span class="w">              </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://livingatlas-dcdev.opendata.arcgis.com/datasets/a090c89d52f1498f96a82e97b8bfb83e_0/about</span>
<span class="w">              </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en-US</span>
<span class="w">        </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">            </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">                </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">78.2379194985166180</span><span class="p p-Indicator">,</span><span class="nv">17.2908061510471995</span><span class="p p-Indicator">,</span><span class="nv">78.6217049083810764</span><span class="p p-Indicator">,</span><span class="nv">17.5618443356918768</span><span class="p p-Indicator">]</span>
<span class="w">                </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">            </span><span class="nt">temporal</span><span class="p">:</span>
<span class="w">                </span><span class="nt">begin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2011-11-11</span>
<span class="w">                </span><span class="nt">end</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span><span class="w">  </span><span class="c1"># or empty</span>
<span class="w">        </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Elasticsearch</span>
<span class="w">              </span><span class="c1">#Note elastic_search is the docker container of ES the name is defined in the docker-compose.yml</span>
<span class="w">              </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://elastic_search:9200/hyderabad</span>
<span class="w">              </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">objectid</span>
</code></pre></div></td></tr></table></div>
<p>No arranque (ex: docker compose up -d), o contentor da pygeoapi irá esperar até que os dados tenham sido ingeridos e 
o índice do Elasticsearch tenha sido construído. Pode verificar os registos usando:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_4_1" name="pt-publishing-ogcapi-features-__tabbed_4" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_4_2" name="pt-publishing-ogcapi-features-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_4_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_4_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>logs<span class="w"> </span>--follow
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>logs<span class="w"> </span>--follow
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Depois do servidor ter arrancado, pode aceder à página da coleção aqui:</p>
<p><a href="http://localhost:5000/collections/hyderabad">http://localhost:5000/collections/hyderabad</a></p>
<p>E aos itens (features) aqui:</p>
<p><a href="http://localhost:5000/collections/hyderabad/items">http://localhost:5000/collections/hyderabad/items</a></p>
<p><img alt="" src="../assets/images/features-hyderabad.png" width="100%" /></p>
<h2 id="pt-publishing-ogcapi-features-opcional-pygeoapi-como-um-proxy-wfs">OPCIONAL: pygeoapi como um proxy WFS</h2>
<p>A pygeoapi também pode funcionar como um serviço de frontend da OGC API - Features para um WFS OGC existente através 
do fornecedor GDAL/OGR. Esta função de ponte permite-lhe efetivamente publicar um WFS como OGC API - Features.</p>
<p>Isto é expandido numa secção avançada deste workshop: <a href="#pt-advanced-bridges-publishing-wfs-as-ogc-api-features">A pygeoapi como uma Ponte para outros Serviços - secção WFS</a>.</p>
<h2 id="pt-publishing-ogcapi-features-acesso-de-lado-do-cliente">Acesso de lado do cliente</h2>
<h3 id="pt-publishing-ogcapi-features-qgis">QGIS</h3>
<p>O QGIS Foi um dos primeiros clientes SIG de Desktop que adicionou suporte para a OGC API - Features. O suporte foi 
integrado no fornecedor WFS existente.</p>
<div class="admonition question">
<p class="admonition-title">Abrir uma coleção da OGC API - Features no QGIS</p>
<p>Siga os passos para adicionar algumas coleções de um endpoint da OGC API - Features:</p>
<ul>
<li>Abra o QGIS (se não tiver o QGIS, pode usar o OSGeoLive)</li>
<li>No menu Layer, selecione <code>Adicionar Layer</code> &gt; <code>Adicionar layer WFS / layer OGC API Features</code></li>
<li>No painel <code>Gestor de fontes de dados</code>, escolha 'Nova ligação'</li>
</ul>
<p><img alt="New connection" src="../assets/images/new-connection.png" width="50%" /></p>
<ul>
<li>Adicione o URL https://demo.pygeoapi.io/master (ou o endereço de um servidor local)</li>
<li>Pode agora clicar no botão <code>detetar</code> e o QGIS irá notar que está a configurar um endpoint da OGC API - Features</li>
<li>O QGIS facilita a definição do tamanho da página (o pedido é dividido em vários pedidos)<ul>
<li>para pontos, pode facilmente defini-lo para 2500</li>
<li>para alguns polígonos com alta densidade, 100 já pode ser lento</li>
</ul>
</li>
<li>Pressione <code>OK</code> para guardar a ligação e voltar ao ecrã anterior</li>
<li>Agora clique no botão <code>Ligar</code> para obter as coleções do serviço</li>
</ul>
<p><img alt="Collection list" src="../assets/images/collection-list.png" width="50%" /></p>
<ul>
<li>Pode agora adicionar coleções ao seu projeto QGIS</li>
<li>Também pode construir uma pesquisa para adicionar um subconjunto da coleção</li>
<li>Feche o <code>Gestor de fontes de dados</code>. Note que o QGIS aplicou um estilo padrão, tal como faria se adicionasse 
  um layer baseado em ficheiro. Pode trabalhar com a coleção de forma semelhante; identificar, aplicar estilo, 
  filtrar, exportar, etc.</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Dica</p>
<p>Ative o <code>Painel de Ferramentas de Debug/Desenvolvimento</code> (clique com o botão direito do rato em qualquer 
parte dos ícones da barra de ferramentas e selecione). Ele exibirá o tráfego HTTP dentro do QGIS e é uma 
ferramenta valiosa no debug de ligações falhadas.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Um número crescente de clientes GIS de Desktop adiciona suporte para as OGC APIs em lançamentos subsequentes. 
Por exemplo, o ArcGIS Pro 
<a href="https://pro.arcgis.com/en/pro-app/2.8/help/data/services/use-ogc-api-services.htm">suporta a OGC API - Features</a> 
desde a versão 2.8.</p>
</div>
<h3 id="pt-publishing-ogcapi-features-gdalogr-avancado">GDAL/OGR - Avançado</h3>
<p>O <a href="https://gdal.org">GDAL/OGR</a> fornece suporte para a <a href="https://gdal.org/drivers/vector/oapif.html">OGC API - Features</a>. 
Isto significa que pode usar o <code>ogrinfo</code> e o <code>ogr2ogr</code> para consultar e converter dados de endpoints da OGC API - 
Features, tal como qualquer outra fonte de dados vetoriais. Significa também que pode estabelecer ligações a endpoints 
da OGC API - Features a partir de qualquer software que tenha uma interface para o GDAL, como MapServer, GeoServer, 
Manifold, FME, ArcGIS, etc.</p>
<div class="admonition question">
<p class="admonition-title">Usar o OGR para interagir com a OGC API - Features</p>
<ul>
<li>Verifique se tem uma versão recente do GDAL instalada, caso contrário, use o GDAL do OSGeoLive</li>
<li>Execute o <code>ogrinfo</code> na linha de comandos para verificar uma ligação à OGC API - Features</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_5_1" name="pt-publishing-ogcapi-features-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_5_1">Linux/Mac</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><div class="termy">
    <div class="highlight"><pre><span></span><code>ogrinfo<span class="w"> </span>OAPIF:https://demo.pygeoapi.io/master/collections/obs
</code></pre></div>
    </div></p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_6_1" name="pt-publishing-ogcapi-features-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_6_1">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>ogrinfo<span class="w"> </span>OAPIF:https://demo.pygeoapi.io/master/collections/obs
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Verifique as informações de resumo sobre o layer com:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_7_1" name="pt-publishing-ogcapi-features-__tabbed_7" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_7_2" name="pt-publishing-ogcapi-features-__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_7_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_7_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>ogrinfo<span class="w"> </span>OAPIF:https://demo.pygeoapi.io/master/collections/obs<span class="w"> </span>obs<span class="w"> </span>-so
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>ogrinfo<span class="w"> </span>OAPIF:https://demo.pygeoapi.io/master/collections/obs<span class="w"> </span>obs<span class="w"> </span>-so
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Agora, vamos converter as observações para uma shapefile</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_8_1" name="pt-publishing-ogcapi-features-__tabbed_8" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_8_2" name="pt-publishing-ogcapi-features-__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_8_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_8_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>ogr2ogr<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;ESRI Shapefile&quot;</span><span class="w"> </span>obs.shp<span class="w"> </span>OAPIF:https://demo.pygeoapi.io/master/collections/obs
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>ogr2ogr<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;ESRI Shapefile&quot;</span><span class="w"> </span>obs.shp<span class="w"> </span>OAPIF:https://demo.pygeoapi.io/master/collections/obs
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pode até usar o OGR para acrescentar novas features a uma coleção da OGC API - Features que suporte transações. 
Leia mais <a href="https://docs.pygeoapi.io/en/latest/transactions.html">aqui</a> sobre o suporte a transações na pygeoapi.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Usar a biblioteca GDAL a partir da linha de comandos com Docker</p>
<p>Se não tiver a GDAL instalada, ou quiser usar/experimentar outra versão, pode sempre executar a imagem de Docker 
da GDAL diretamente a partir da linha de comandos. A OSGeo fornece 
<a href="https://github.com/OSGeo/gdal/pkgs/container/gdal">Imagens de Docker da GDAL</a>. O principal a ter em conta é o 
mapeamento correto de volumes Docker para que as ferramentas de linha de comandos da GDAL possam aceder a 
ficheiros locais. Isto pode ser muito útil para conversões rápidas de dados. A maioria das imagens também vem 
com bindings Python da GDAL.</p>
<p>Primeiro, pode descarregar uma Imagem Docker muito pequena:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_9_1" name="pt-publishing-ogcapi-features-__tabbed_9" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_9_2" name="pt-publishing-ogcapi-features-__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_9_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_9_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>ghcr.io/osgeo/gdal:alpine-small-latest
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>ghcr.io/osgeo/gdal:alpine-small-latest
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Depois pode executar, por exemplo, as ferramentas de linha de comandos do OGR. O comando base é <code>docker 
run -it --rm ghcr.io/osgeo/gdal:alpine-small-latest</code>. Isto executa um contentor Docker interativamente (<code>-it</code>) e 
remove-o ao sair (<code>--rm</code>). Abaixo estão exemplos.</p>
<p>Liste os formatos Vetoriais disponíveis no GDAL/OGR :</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_10_1" name="pt-publishing-ogcapi-features-__tabbed_10" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_10_2" name="pt-publishing-ogcapi-features-__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_10_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_10_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>ghcr.io/osgeo/gdal:alpine-small-latest<span class="w"> </span><span class="se">\</span>
<span class="w">                    </span>ogrinfo<span class="w"> </span>--formats
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>ghcr.io/osgeo/gdal:alpine-small-latest<span class="w"> </span>ogrinfo<span class="w"> </span>--formats
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Obter informação sobre um ficheiro geoespacial. Note o mapeamento de volumes: <code>-v $(pwd)/data:/work</code> para aceder 
a ficheiros locais dentro do container de Docker (os comandos estão numa única linha, quebrados para facilitar 
a leitura).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_11_1" name="pt-publishing-ogcapi-features-__tabbed_11" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_11_2" name="pt-publishing-ogcapi-features-__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_11_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_11_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>git/workshop/exercises
docker<span class="w"> </span>run<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/data:/work<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>ghcr.io/osgeo/gdal:alpine-small-latest<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>ogrinfo<span class="w"> </span>/work/tartu/bathingwater-estonia.geojson

INFO:<span class="w"> </span>Open<span class="w"> </span>of<span class="w"> </span><span class="sb">`</span>/work/tartu/bathingwater-estonia.geojson<span class="s1">&#39;</span>
<span class="s1">      using driver `GeoJSON&#39;</span><span class="w"> </span>successful.
<span class="m">1</span>:<span class="w"> </span>bathingwater-estonia<span class="w"> </span><span class="o">(</span>Point<span class="o">)</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>git/workshop/exercises
docker<span class="w"> </span>run<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/data:/work<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>ghcr.io/osgeo/gdal:alpine-small-latest<span class="w"> </span>ogrinfo<span class="w"> </span>/work/tartu/bathingwater-estonia.geojson

INFO:<span class="w"> </span>Open<span class="w"> </span>of<span class="w"> </span><span class="sb">`</span>/work/tartu/bathingwater-estonia.geojson<span class="s1">&#39;</span>
<span class="s1">      using driver `GeoJSON&#39;</span><span class="w"> </span>successful.
<span class="m">1</span>:<span class="w"> </span>bathingwater-estonia<span class="w"> </span><span class="o">(</span>Point<span class="o">)</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Converter o ficheiro GeoJSON para um GeoPackage (GPKG) com <code>ogr2ogr</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_12_1" name="pt-publishing-ogcapi-features-__tabbed_12" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_12_2" name="pt-publishing-ogcapi-features-__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_12_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_12_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/data:/work<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>ghcr.io/osgeo/gdal:alpine-small-latest<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>ogr2ogr<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;GPKG&quot;</span><span class="w"> </span>/work/tartu/bathingwater-estonia.gpkg<span class="w"> </span><span class="se">\</span>
<span class="w">                     </span>/work/tartu/bathingwater-estonia.geojson
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<code>bash
docker run -v ${pwd}/data:/work -it --rm ghcr.io/osgeo/gdal:alpine-small-latest ogr2ogr -f "GPKG" /work/tartu/bathingwater-estonia.gpkg /work/tartu/bathingwater-estonia.geojson</code>
</div></p>
</div>
</div>
</div>
<p>Também pode usar o <code>ogrinfo</code> para obter informações sobre uma coleção da OGC API - Features. Caso esteja a aceder 
a uma coleção local, terá de se certificar de que o contentor é executado na rede do anfitrião (host):</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_13_1" name="pt-publishing-ogcapi-features-__tabbed_13" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_13_2" name="pt-publishing-ogcapi-features-__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_13_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_13_2">Windows</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span><span class="se">\</span>
--network<span class="o">=</span>host<span class="w"> </span><span class="se">\</span>
ghcr.io/osgeo/gdal:alpine-small-latest<span class="w"> </span><span class="se">\</span>
ogrinfo<span class="w"> </span>OAPIF:http://localhost:5000/collections/obs<span class="w"> </span>obs<span class="w"> </span>-so
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>--network<span class="o">=</span>host<span class="w"> </span>ghcr.io/osgeo/gdal:alpine-small-latest<span class="w"> </span>ogrinfo<span class="w"> </span>OAPIF:http://localhost:5000/collections/obs<span class="w"> </span>obs<span class="w"> </span>-so
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<h3 id="pt-publishing-ogcapi-features-owslib-avancado">OWSLib - Avançado</h3>
<p>A <a href="https://owslib.readthedocs.io">OWSLib</a> é uma biblioteca de Python para interagir com Serviços Web OGC e suporta 
várias OGC APIs, incluindo a OGC API - Features.</p>
<p>Este exercício será feito usando um jupyter notebook. Se preferir, pode fazê-lo usando Python a partir da linha de 
comandos (ver abaixo).</p>
<p>Antes de continuar, certifique-se de que está na pasta <code>workshop/exercises</code>. Precisará disso para poder usar o 
jupyter notebook.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_14_1" name="pt-publishing-ogcapi-features-__tabbed_14" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_14_2" name="pt-publishing-ogcapi-features-__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_14_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_14_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">pwd</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Depois use o docker para iniciar um contentor com o jupyter notebook, montando também a pasta local como um volume:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_15_1" name="pt-publishing-ogcapi-features-__tabbed_15" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_15_2" name="pt-publishing-ogcapi-features-__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_15_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_15_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">8888</span>:8888<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/home/jovyan/work<span class="w"> </span>jupyter/base-notebook
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">8888</span>:8888<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>:/home/jovyan/work<span class="w"> </span>jupyter/base-notebook
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Introduza o url indicado na linha de comandos, <code>http://127.0.0.1:8888/lab</code> seguido de um token. Entre na pasta <code>work</code> 
e abra o <code>features-owslib.ipynb</code>.</p>
<p><img alt="jupyter notebook" src="../assets/images/jupyter1.png" /></p>
<p>Execute o notebook para explorar um servidor OGC API - Features, usando a owslib.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Pode executar as mesmas instruções usando o seu servidor pygeoapi local, em vez da instância 
de demonstração da pygeoapi.</p>
</div>
<h4 id="pt-publishing-ogcapi-features-usar-python-a-partir-da-linha-de-comandos">Usar Python a partir da linha de comandos</h4>
<div class="admonition question">
<p class="admonition-title">Interagir com a OGC API - Features via OWSLib</p>
<p>Se não tiver o Python instalado, considere executar este exercício num contentor Docker. Veja o 
<a href="#pt-setup-using-docker-for-python-clients">Capítulo de Configuração</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_16_1" name="pt-publishing-ogcapi-features-__tabbed_16" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_16_2" name="pt-publishing-ogcapi-features-__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_16_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_16_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Depois, inicie uma sessão de consola Python com <code>python3</code> (pare a sessão escrevendo <code>exit()</code>).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:2"><input checked="checked" id="pt-publishing-ogcapi-features-__tabbed_17_1" name="pt-publishing-ogcapi-features-__tabbed_17" type="radio" /><input id="pt-publishing-ogcapi-features-__tabbed_17_2" name="pt-publishing-ogcapi-features-__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-features-__tabbed_17_1">Linux/Mac</label><label for="pt-publishing-ogcapi-features-__tabbed_17_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">Features</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Features</span><span class="p">(</span><span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">conformance</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">conformance</span><span class="p">()</span>
<span class="p">{</span><span class="sa">u</span><span class="s1">&#39;conformsTo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/core&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/oas30&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/html&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson&#39;</span><span class="p">]}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">api</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">api</span><span class="p">()</span>  <span class="c1"># OpenAPI document</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">collections</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collections</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">collections</span><span class="p">[</span><span class="s1">&#39;collections&#39;</span><span class="p">])</span>
<span class="mi">13</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">feature_collections</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">feature_collections</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_collections</span><span class="p">)</span>
<span class="mi">13</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;lakes&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="s1">&#39;lakes&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Large Lakes&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
<span class="s1">&#39;lakes of the world, public domain&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes_queryables</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_queryables</span><span class="p">(</span><span class="s1">&#39;lakes&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lakes_queryables</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">])</span>
<span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes_query</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_items</span><span class="p">(</span><span class="s1">&#39;lakes&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes_query</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;properties&#39;</span><span class="p">]</span>
<span class="p">{</span><span class="sa">u</span><span class="s1">&#39;scalerank&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;name_alt&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;admin&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;featureclass&#39;</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;Lake&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;Lake Baikal&#39;</span><span class="p">}</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">Features</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Features</span><span class="p">(</span><span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">conformance</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">conformance</span><span class="p">()</span>
<span class="p">{</span><span class="sa">u</span><span class="s1">&#39;conformsTo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/core&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/oas30&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/html&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson&#39;</span><span class="p">]}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">api</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">api</span><span class="p">()</span>  <span class="c1"># OpenAPI document</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">collections</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collections</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">collections</span><span class="p">[</span><span class="s1">&#39;collections&#39;</span><span class="p">])</span>
<span class="mi">13</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">feature_collections</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">feature_collections</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_collections</span><span class="p">)</span>
<span class="mi">13</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;lakes&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="s1">&#39;lakes&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Large Lakes&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
<span class="s1">&#39;lakes of the world, public domain&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes_queryables</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_queryables</span><span class="p">(</span><span class="s1">&#39;lakes&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lakes_queryables</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">])</span>
<span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes_query</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_items</span><span class="p">(</span><span class="s1">&#39;lakes&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes_query</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;properties&#39;</span><span class="p">]</span>
<span class="p">{</span><span class="sa">u</span><span class="s1">&#39;scalerank&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;name_alt&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;admin&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;featureclass&#39;</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;Lake&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;Lake Baikal&#39;</span><span class="p">}</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Consulte a <a href="https://owslib.readthedocs.io/en/latest/usage.html#ogc-api">documentação oficial da OWSLib</a> para mais exemplos.</p>
</div>
<h1 id="pt-publishing-ogcapi-features-resumo">Resumo</h1>
<p>Parabéns! Agora é capaz de publicar dados vetoriais com a pygeoapi.</p></section><section class="print-page" id="pt-publishing-ogcapi-coverages" heading-number="5.4"><h1 id="pt-publishing-ogcapi-coverages-exercicio-3-dados-raster-via-ogc-api-coverages">Exercício 3 - Dados raster via OGC API - Coverages</h1>
<p>A <a href="https://ogcapi.ogc.org/coverages">OGC API - Coverages</a> fornece uma API Web para aceder a dados raster (grelhas, dados de deteção remota, cubos de dados multidimensionais):</p>
<ul>
<li><a href="https://docs.ogc.org/DRAFTS/19-087.html">OGC API - Coverages</a> (<strong>rascunho</strong>)</li>
</ul>
<h2 id="pt-publishing-ogcapi-coverages-suporte-da-pygeoapi">Suporte da pygeoapi</h2>
<p>A pygeoapi suporta a especificação de rascunho da OGC API - Coverages, com o <a href="https://rasterio.readthedocs.io">rasterio</a> e o <a href="https://docs.xarray.dev">xarray</a> como backends principais, bem como <a href="https://covjson.org">CoverageJSON</a> e output nativo.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consulte <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-coverages.html">a documentação oficial</a> para mais informações sobre os backends raster suportados.</p>
</div>
<h2 id="pt-publishing-ogcapi-coverages-publicar-um-conjunto-de-dados-raster">Publicar um conjunto de dados raster</h2>
<p>Nos exercícios anteriores, demonstrámos os passos envolvidos na publicação de dados vetoriais e na atualização da configuração da pygeoapi. Nesta secção, vamos publicar um ficheiro raster no formato GeoTIFF, a partir de um fornecedor <a href="https://rasterio.readthedocs.io">rasterio</a>.</p>
<div class="admonition question">
<p class="admonition-title">Atualizar a configuração da pygeoapi</p>
<p>Abra o ficheiro de configuração da pygeoapi num editor de texto. Adicione uma nova secção de conjunto de dados da seguinte forma:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">tartu-ntl</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Amostra de dados de luzes noturnas da NASA Blue Marble sobre a Estónia</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Amostra de dados de luzes noturnas da NASA Blue Marble sobre a Estónia</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Blue Marble</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Luzes Noturnas</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NTL</span>
<span class="w">    </span><span class="nt">links</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">          </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">about</span>
<span class="w">          </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Dados de Luzes Noturnas da NASA Blue Marble</span>
<span class="w">          </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://appliedsciences.nasa.gov/get-involved/training/english/arset-introduction-nasas-black-marble-night-lights-data</span>
<span class="w">          </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">          </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">26.6264</span><span class="p p-Indicator">,</span><span class="nv">58.32569</span><span class="p p-Indicator">,</span><span class="nv">26.82632</span><span class="p p-Indicator">,</span><span class="nv">58.433989</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">coverage</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rasterio</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/tartu/estonia_light.tif</span><span class="w"> </span><span class="c1"># coloque o caminho correto aqui</span>
<span class="w">          </span><span class="nt">format</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GTiff</span>
<span class="w">              </span><span class="nt">mimetype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/tiff</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A diretiva <code>format.name</code> do fornecedor rasterio <strong>requer</strong> um <a href="https://gdal.org/drivers/raster/index.html">nome de driver raster GDAL</a> válido.</p>
</div>
<p>Guarde a configuração e reinicie o Docker Compose. Navegue para <a href="http://localhost:5000/collections">http://localhost:5000/collections</a> para avaliar se o novo conjunto de dados foi publicado.</p>
<h2 id="pt-publishing-ogcapi-coverages-acesso-do-lado-do-cliente">Acesso do lado do cliente</h2>
<h3 id="pt-publishing-ogcapi-coverages-gdalogr">GDAL/OGR</h3>
<p>O <a href="https://gdal.org">GDAL/OGR</a> fornece suporte para a <a href="https://gdal.org/drivers/raster/ogcapi.html">OGC API - Coverages</a>. Isto significa que pode usar o <code>gdalinfo</code> para consultar e converter dados de endpoints da OGC API - Coverages, tal como qualquer outra fonte de dados raster. Isto também significa que pode estabelecer ligações a endpoints da OGC API - Coverages a partir de qualquer software que tenha uma interface para o GDAL, como MapServer, GeoServer, Manifold, FME, ArcGIS, etc.</p>
<div class="admonition question">
<p class="admonition-title">Usar o GDAL para interagir com a OGC API - Coverages</p>
<ul>
<li>Verifique se tem uma versão recente do GDAL instalada, caso contrário, use o GDAL do OSGeoLive</li>
<li>Execute <code>gdalinfo</code> na linha de comandos para verificar uma ligação à OGC API - Coverages:</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="pt-publishing-ogcapi-coverages-__tabbed_1_1" name="pt-publishing-ogcapi-coverages-__tabbed_1" type="radio" /><input id="pt-publishing-ogcapi-coverages-__tabbed_1_2" name="pt-publishing-ogcapi-coverages-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-coverages-__tabbed_1_1">Linux/Mac</label><label for="pt-publishing-ogcapi-coverages-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>gdalinfo OGCAPI:https://maps.ecere.com/ogcapi/collections/SRTM_ViewFinderPanorama
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>gdalinfo OGCAPI:https://maps.ecere.com/ogcapi/collections/SRTM_ViewFinderPanorama
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<h3 id="pt-publishing-ogcapi-coverages-owslib">OWSLib</h3>
<p>A <a href="https://owslib.readthedocs.io">OWSLib</a> é uma biblioteca Python para interagir com os Serviços Web da OGC e suporta várias OGC API, incluindo a OGC API - Coverages.</p>
<div class="admonition question">
<p class="admonition-title">Interagir com a OGC API - Coverages via OWSLib</p>
<p>Se não tiver o Python instalado, considere executar este exercício num container de Docker. Consulte o <a href="#pt-setup-using-docker-for-python-clients">Capítulo de Configuração</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="pt-publishing-ogcapi-coverages-__tabbed_2_1" name="pt-publishing-ogcapi-coverages-__tabbed_2" type="radio" /><input id="pt-publishing-ogcapi-coverages-__tabbed_2_2" name="pt-publishing-ogcapi-coverages-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-coverages-__tabbed_2_1">Linux/Mac</label><label for="pt-publishing-ogcapi-coverages-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<code>bash
pip3 install owslib</code>        </div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Em seguida, inicie uma sessão de consola Python com: <code>python3</code> (pare a sessão escrevendo <code>exit()</code>).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="pt-publishing-ogcapi-coverages-__tabbed_3_1" name="pt-publishing-ogcapi-coverages-__tabbed_3" type="radio" /><input id="pt-publishing-ogcapi-coverages-__tabbed_3_2" name="pt-publishing-ogcapi-coverages-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-coverages-__tabbed_3_1">Linux/Mac</label><label for="pt-publishing-ogcapi-coverages-__tabbed_3_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.coverages</span><span class="w"> </span><span class="kn">import</span> <span class="n">Coverages</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">SERVICE_URL</span> <span class="o">=</span> <span class="s1">&#39;https://demo.pygeoapi.io/master/&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Coverages</span><span class="p">(</span><span class="n">SERVICE_URL</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master/&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;gdps-temperature&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="s1">&#39;gdps-temperature&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Amostra do Sistema de Previsão Determinística Global&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
<span class="s1">&#39;Amostra do Sistema de Previsão Determinística Global&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_schema</span><span class="p">(</span><span class="s1">&#39;gdps-temperature&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">])</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Temperatura [C]&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;x-ogc-unit&#39;</span><span class="p">]</span>
<span class="s1">&#39;[C]&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
<span class="s1">&#39;number&#39;</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.coverages</span><span class="w"> </span><span class="kn">import</span> <span class="n">Coverages</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">SERVICE_URL</span> <span class="o">=</span> <span class="s1">&#39;https://demo.pygeoapi.io/master/&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Coverages</span><span class="p">(</span><span class="n">SERVICE_URL</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master/&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;gdps-temperature&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="s1">&#39;gdps-temperature&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Amostra do Sistema de Previsão Determinística Global&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
<span class="s1">&#39;Amostra do Sistema de Previsão Determinística Global&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_schema</span><span class="p">(</span><span class="s1">&#39;gdps-temperature&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">])</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Temperatura [C]&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;x-ogc-unit&#39;</span><span class="p">]</span>
<span class="s1">&#39;[C]&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
<span class="s1">&#39;number&#39;</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consulte a <a href="https://owslib.readthedocs.io/en/latest/usage.html#ogc-api">documentação oficial da OWSLib</a> para mais exemplos.</p>
</div>
<h1 id="pt-publishing-ogcapi-coverages-resumo">Resumo</h1>
<p>Parabéns! Agora é capaz de publicar dados raster na pygeoapi.</p></section><section class="print-page" id="pt-publishing-ogcapi-maps" heading-number="5.5"><p>s---
title: Exercício 4 - Mapas de dados geoespaciais via OGC API - Maps</p>
<hr />
<h1 id="pt-publishing-ogcapi-maps-exercicio-4-mapas-de-dados-geoespaciais-via-ogc-api-maps">Exercício 4 - Mapas de dados geoespaciais via OGC API - Maps</h1>
<p>A <a href="https://ogcapi.ogc.org/maps">OGC API - Maps</a> fornece uma API Web para aceder a quaisquer dados geoespaciais como uma imagem de mapa georreferenciada.</p>
<ul>
<li><a href="https://docs.ogc.org/DRAFTS/20-058.html">OGC API - Maps</a></li>
</ul>
<h2 id="pt-publishing-ogcapi-maps-suporte-da-pygeoapi">Suporte da pygeoapi</h2>
<p>A pygeoapi suporta a especificação da OGC API - Maps, utilizando o <a href="https://www.mapserver.org/mapscript">MapServer MapScript</a> e uma fachada WMS como backends principais.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consulte <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-maps.html">a documentação oficial</a> para mais informações sobre os backends de mapa suportados.</p>
</div>
<h2 id="pt-publishing-ogcapi-maps-publicar-um-conjunto-de-dados-raster">Publicar um conjunto de dados raster</h2>
<p>Nesta secção, iremos expor um ficheiro Geopackage disponível na localização <code>workshop/exercises/data/airport.gpkg</code> utilizando o <a href="https://www.mapserver.org/mapscript">MapServer MapScript</a>. Estes dados podem ser consumidos por vários clientes que são compatíveis com a OGC API - Maps. Uma lista de alguns desses clientes pode ser encontrada <a href="https://github.com/opengeospatial/ogcapi-maps/blob/master/implementations.adoc#clients">aqui</a>. Aqui também podemos passar o estilo no formato <em>.sld</em>, que pode ser gerado no <a href="https://docs.geoserver.org/stable/en/user/styling/index.html">Geoserver</a>, <a href="https://www.qgistutorials.com/en/docs/3/basic_vector_styling.html">QGIS</a>, etc.</p>
<div class="admonition question">
<p class="admonition-title">Interagir com a OGC API - Maps via MapScript</p>
<p>Abra o ficheiro de configuração da pygeoapi num editor de texto. Encontre a linha <code># START - EXERCISE 4 - Maps</code>.</p>
<p>Descomente a secção relacionada com #airports.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">airports</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">airports of the world</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Point data representing airports around the world with various metadata such as name, Code, etc.</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">airports</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">natural earth</span>
<span class="w">    </span><span class="nt">links</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">          </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">          </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">information</span>
<span class="w">          </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://www.naturalearthdata.com/downloads/10m-cultural-vectors/airports/</span>
<span class="w">          </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en-US</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-180</span><span class="p p-Indicator">,</span><span class="nv">-90</span><span class="p p-Indicator">,</span><span class="nv">180</span><span class="p p-Indicator">,</span><span class="nv">90</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">        </span><span class="nt">temporal</span><span class="p">:</span>
<span class="w">            </span><span class="nt">begin</span><span class="p">:</span>
<span class="w">            </span><span class="nt">end</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span><span class="w">  </span><span class="c1"># or empty</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">map</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MapScript</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/airport.gpkg</span>
<span class="w">          </span><span class="nt">options</span><span class="p">:</span>
<span class="w">              </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MS_LAYER_POINT</span>
<span class="w">              </span><span class="nt">layer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">airport</span>
<span class="w">              </span><span class="nt">style</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/airport.sld</span>
<span class="w">          </span><span class="nt">format</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">png</span>
<span class="w">              </span><span class="nt">mimetype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image/png</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consulte <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-maps.html">a documentação oficial</a> para mais informações sobre os backends de mapa suportados.</p>
</div>
<h2 id="pt-publishing-ogcapi-maps-a-pygeoapi-como-um-proxy-wms">A pygeoapi como um proxy WMS</h2>
<p>Pode consultar a secção "A pygeoapi como uma Ponte para Outros Serviços" para aprender a <a href="#pt-advanced-bridges-publishing-wms-as-ogc-api-maps">publicar WMS como OGC API - Maps</a>.</p>
<h2 id="pt-publishing-ogcapi-maps-acesso-do-lado-do-cliente">Acesso do lado do cliente</h2>
<h3 id="pt-publishing-ogcapi-maps-qgis">QGIS</h3>
<p>O QGIS adicionou suporte para APIs que fornecem layers de imagem renderizadas através do seu suporte raster.</p>
<div class="admonition question">
<p class="admonition-title">Adicionar camada da OGC API - Maps ao QGIS</p>
<ul>
<li>Instale uma versão recente do QGIS (&gt;3.28).</li>
<li>Abra o painel <code>Adicionar camada raster</code>.</li>
<li>Selecione <code>OGCAPI</code> para o tipo de Fonte.</li>
<li>Adicione o ponto de extremidade local como fonte <code>http://localhost:5000/collections/airports</code>.</li>
<li>Selecione <code>PNG</code> como formato de imagem.</li>
<li>Finalmente, adicione a camada ao mapa.</li>
</ul>
</div>
<h3 id="pt-publishing-ogcapi-maps-owslib">OWSLib</h3>
<p>A <a href="https://owslib.readthedocs.io">OWSLib</a> é uma biblioteca Python para interagir com os Serviços Web da OGC e suporta várias OGC APIs, incluindo a OGC API - Maps.</p>
<div class="admonition question">
<p class="admonition-title">Interagir com a OGC API - Maps via OWSLib</p>
<p>Se não tiver Python instalado, considere executar este exercício num contentor Docker. Consulte o <a href="#pt-setup-using-docker-for-python-clients">Capítulo de Configuração</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="pt-publishing-ogcapi-maps-__tabbed_1_1" name="pt-publishing-ogcapi-maps-__tabbed_1" type="radio" /><input id="pt-publishing-ogcapi-maps-__tabbed_1_2" name="pt-publishing-ogcapi-maps-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-maps-__tabbed_1_1">Linux/Mac</label><label for="pt-publishing-ogcapi-maps-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Para executar em Python:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="pt-publishing-ogcapi-maps-__tabbed_2_1" name="pt-publishing-ogcapi-maps-__tabbed_2" type="radio" /><input id="pt-publishing-ogcapi-maps-__tabbed_2_2" name="pt-publishing-ogcapi-maps-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-maps-__tabbed_2_1">Linux/Mac</label><label for="pt-publishing-ogcapi-maps-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.maps</span><span class="w"> </span><span class="kn">import</span> <span class="n">Maps</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">Maps</span><span class="p">(</span><span class="s1">&#39;http://localhost:5000&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s1">&#39;airports&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;output.png&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getbuffer</span><span class="p">())</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.maps</span><span class="w"> </span><span class="kn">import</span> <span class="n">Maps</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">Maps</span><span class="p">(</span><span class="s1">&#39;http://localhost:5000&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s1">&#39;airports&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;output.png&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getbuffer</span><span class="p">())</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consulte a <a href="https://owslib.readthedocs.io/en/latest/usage.html#ogc-api">documentação oficial da OWSLib</a> para mais exemplos.</p>
</div>
<h1 id="pt-publishing-ogcapi-maps-resumo">Resumo</h1>
<p>Parabéns! Agora é capaz de servir um OGC WMS através da pygeoapi e da OGC API - Maps.</p></section><section class="print-page" id="pt-publishing-ogcapi-tiles" heading-number="5.6"><h1 id="pt-publishing-ogcapi-tiles-exercicio-5-tiles-de-dados-geoespaciais-via-ogc-api-tiles">Exercício 5 - Tiles de dados geoespaciais via OGC API - Tiles</h1>
<p>A <a href="https://ogcapi.ogc.org/tiles">OGC API - Tiles</a> fornece uma API Web para disponibilizar tiles (ou mosaicos) de informação geoespacial. São suportadas diferentes formas de informação geoespacial, como tiles de elementos vetoriais ("vector tiles"), coverages, mapas (ou imagens) e, potencialmente, outros tipos de tiles de informação geoespacial. O standard está disponível neste documento:</p>
<ul>
<li><a href="https://docs.ogc.org/is/20-057/20-057.html">OGC API - Tiles: Parte 1: Core</a></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A OGC API - Tiles estende a estrutura de URL <code>collections/*</code> (os conjuntos de tiles são listados em <code>/collections/example/tiles</code>:</p>
<div class="highlight"><pre><span></span><code>https://demo.pygeoapi.io/collections/lakes/tiles/WebMercatorQuad/{tileMatrix}/{tileRow}/{tileCol}?f=mvt
</code></pre></div>
</div>
<h2 id="pt-publishing-ogcapi-tiles-suporte-da-pygeoapi">Suporte da pygeoapi</h2>
<p>A pygeoapi suporta a especificação core da OGC API - Tiles e é capaz de anunciar um conjunto de tiles existente. Note que a própria pygeoapi não renderiza tiles a partir de dados de origem, mas suporta a publicação de tiles de diferentes <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-tiles.html#providers">fornecedores de backend</a>. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A estrutura de URL da OGC API - Tiles é compatível com camadas XYZ em bibliotecas comuns como OpenLayers, Leaflet e MapML.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consulte <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-tiles.html">a documentação oficial</a> para mais informações sobre os backends de tiles suportados.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A pygeoapi atualmente suporta dois Tile Matrix Sets muito conhecidos: <code>WorldCRS84Quad</code> e <code>WebMercatorQuad</code>. A sua definição é publicada no ponto de extremidade <a href="https://demo.pygeoapi.io/master/TileMatrixSets">/TileMatrixSets</a>.</p>
</div>
<h2 id="pt-publishing-ogcapi-tiles-publicar-tiles-vetoriais-pre-renderizadas">Publicar tiles vetoriais pré-renderizadas</h2>
<p>Neste cenário, as tiles devem ser pré-renderizadas antes de serem servidas. O fornecedor <code>MVT-tippecanoe</code> permite servir tiles pré-renderizadas pelo <a href="https://github.com/mapbox/tippecanoe">tippecanoe</a>, seja a partir de uma directoria no disco ou de um servidor estático (ex.: bucket S3 ou MinIO).</p>
<p>Para este exercício, irá publicar um conjunto de dados vetoriais dos <a href="https://en.wikipedia.org/wiki/Administrative_divisions_of_Hyderabad">limites dos bairros da corporação municipal da grande Hyderabad</a>, a partir da localização abaixo:</p>
<ul>
<li>data: <code>workshop/exercises/data/hyderabad/greater_hyderabad_municipal_corporation_ward_Boundaries.geojson</code></li>
</ul>
<p>Como primeiro passo vamos gerar as tiles, usando o tippecanoe:</p>
<div class="admonition example">
<p class="admonition-title">Usar o tippecanoe para gerar tiles vetoriais</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="pt-publishing-ogcapi-tiles-__tabbed_1_1" name="pt-publishing-ogcapi-tiles-__tabbed_1" type="radio" /><input id="pt-publishing-ogcapi-tiles-__tabbed_1_2" name="pt-publishing-ogcapi-tiles-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-tiles-__tabbed_1_1">Linux/Mac</label><label for="pt-publishing-ogcapi-tiles-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/data:/data<span class="w"> </span>emotionalcities/tippecanoe<span class="w"> </span><span class="se">\</span>
tippecanoe<span class="w"> </span>-r1<span class="w"> </span>-pk<span class="w"> </span>-pf<span class="w"> </span>--output-to-directory<span class="o">=</span>/data/tiles/<span class="w"> </span>--force<span class="w"> </span>--maximum-zoom<span class="o">=</span><span class="m">16</span><span class="w"> </span><span class="se">\</span>
--extend-zooms-if-still-dropping<span class="w"> </span>--no-tile-compression<span class="w"> </span>/data/hyderabad/greater_hyderabad_municipal_corporation_ward_Boundaries.geojson
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/data:/data<span class="w"> </span>emotionalcities/tippecanoe<span class="w"> </span>tippecanoe<span class="w"> </span>-r1<span class="w"> </span>-pk<span class="w"> </span>-pf<span class="w"> </span>--output-to-directory<span class="o">=</span>/data/tiles/<span class="w"> </span>--force<span class="w"> </span>--maximum-zoom<span class="o">=</span><span class="m">16</span><span class="w"> </span>--extend-zooms-if-still-dropping<span class="w"> </span>--no-tile-compression<span class="w"> </span>/data/hyderabad/greater_hyderabad_municipal_corporation_ward_Boundaries.geojson
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Por favor, note que a ferramenta tippecanoe requer que o ficheiro de entrada esteja em WGS84, e produz sempre tiles em WebMercator.</p>
</div>
<div class="admonition question">
<p class="admonition-title">Atualizar a configuração da pygeoapi</p>
<p>Abra a configuração da pygeoapi num editor de texto. Adicione uma nova secção de conjunto de dados da seguinte forma:</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nt">hyderabad</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Greater Hyderabad Municipal Corporation ward boundaries</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">The city ward boundaries represent the administrative and electoral boundary areas of the city. It plays a great role in planning of the city, for each council of the municipal corporation.</span>
<span class="w">        </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Boundaries</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Administrative</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ward</span>
<span class="w">        </span><span class="nt">links</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">              </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">              </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">information</span>
<span class="w">              </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://livingatlas-dcdev.opendata.arcgis.com/datasets/a090c89d52f1498f96a82e97b8bfb83e_0/about</span>
<span class="w">              </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en-US</span>
<span class="w">        </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">            </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">                </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">78.2379194985166180</span><span class="p p-Indicator">,</span><span class="nv">17.2908061510471995</span><span class="p p-Indicator">,</span><span class="nv">78.6217049083810764</span><span class="p p-Indicator">,</span><span class="nv">17.5618443356918768</span><span class="p p-Indicator">]</span>
<span class="w">                </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">            </span><span class="nt">temporal</span><span class="p">:</span>
<span class="w">                </span><span class="nt">begin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2011-11-11</span>
<span class="w">                </span><span class="nt">end</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span><span class="w">  </span><span class="c1"># or empty</span>
<span class="w">        </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GeoJSON</span>
<span class="w">              </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/hyderabad/greater_hyderabad_municipal_corporation_ward_Boundaries.geojson</span>
<span class="w">              </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">objectid</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tile</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MVT-tippecanoe</span>
<span class="w">              </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/tiles/</span><span class="w">  </span><span class="c1"># local directory tree</span>
<span class="w">              </span><span class="nt">options</span><span class="p">:</span>
<span class="w">                </span><span class="nt">zoom</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">                    </span><span class="nt">max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16</span>
<span class="w">              </span><span class="nt">format</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pbf</span>
<span class="w">                    </span><span class="nt">mimetype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/vnd.mapbox-vector-tile</span>
</code></pre></div></td></tr></table></div>
<p>Guarde o ficheiro e reinicie o Docker Compose. Navegue para <a href="http://localhost:5000/collections">http://localhost:5000/collections</a> para avaliar se o novo conjunto de dados foi publicado.</p>
<p>Verificação adicional para os seguintes endpoints específicos de tiles na coleção <code>hyderabad</code>:</p>
<ul>
<li>links de tiles em <a href="http://localhost:5000/collections/hyderabad/tiles">http://localhost:5000/collections/hyderabad/tiles</a></li>
<li>metadados de tiles em <a href="http://localhost:5000/collections/hyderabad/tiles/WebMercatorQuad/metadata">http://localhost:5000/collections/hyderabad/tiles/WebMercatorQuad/metadata</a></li>
</ul>
<p><img alt="TileSet" src="../assets/images/vtiles-hyderabad.png" /></p>
<h2 id="pt-publishing-ogcapi-tiles-publicar-tiles-vetoriais-a-partir-do-elasticsearch">Publicar tiles vetoriais a partir do Elasticsearch</h2>
<p>O Elasticsearch fornece um middleware que <a href="https://www.elastic.co/blog/introducing-elasticsearch-vector-tile-search-api-for-geospatial">renderiza um índice dinamicamente, como tiles vetoriais</a>. Este middleware também é suportado pelo backend mvt da pygeoapi.</p>
<p>Se quiser explorar a publicação de tiles vetoriais usando o Elasticsearch, clone o repositório <a href="https://github.com/geopython/pygeoapi-examples/">pygeoapi-examples</a>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="pt-publishing-ogcapi-tiles-__tabbed_2_1" name="pt-publishing-ogcapi-tiles-__tabbed_2" type="radio" /><input id="pt-publishing-ogcapi-tiles-__tabbed_2_2" name="pt-publishing-ogcapi-tiles-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-tiles-__tabbed_2_1">Linux/Mac</label><label for="pt-publishing-ogcapi-tiles-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/geopython/pygeoapi-examples.git
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/geopython/pygeoapi-examples.git
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Depois, mude para a pasta <code>docker/mvt-elastic</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="pt-publishing-ogcapi-tiles-__tabbed_3_1" name="pt-publishing-ogcapi-tiles-__tabbed_3" type="radio" /><input id="pt-publishing-ogcapi-tiles-__tabbed_3_2" name="pt-publishing-ogcapi-tiles-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-tiles-__tabbed_3_1">Linux/Mac</label><label for="pt-publishing-ogcapi-tiles-__tabbed_3_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>docker/mvt-elastic
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>docker/mvt-elastic
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Edite o script <code>add-data.sh</code> na pasta <code>ES</code>, adicionando estas duas linhas antes do fim:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">curl -o /tmp/hyderabad.geojson https://raw.githubusercontent.com/geopython/diving-into-pygeoapi/refs/heads/main/workshop/exercises/data/hyderabad/greater_hyderabad_municipal_corporation_ward_Boundaries.geojson</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">python3 /load_es_data.py /tmp/hyderabad.geojson objectid</span>
</code></pre></div></td></tr></table></div>
<p>Acima, estamos a descarregar o <code>greater_hyderabad_municipal_corporation_ward_Boundaries.geojson</code> para dentro do container e a ingeri-lo num índice do Elasticsearch. Depois disto, precisamos de construir a imagem docker:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="pt-publishing-ogcapi-tiles-__tabbed_4_1" name="pt-publishing-ogcapi-tiles-__tabbed_4" type="radio" /><input id="pt-publishing-ogcapi-tiles-__tabbed_4_2" name="pt-publishing-ogcapi-tiles-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-tiles-__tabbed_4_1">Linux/Mac</label><label for="pt-publishing-ogcapi-tiles-__tabbed_4_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>build
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>build
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Edite a configuração <code>docker.config.yml</code> na pasta <code>pygeoapi</code>, adicionando este bloco de código antes do fim:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nt">hyderabad</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Limites dos bairros da Corporação Municipal da Grande Hyderabad</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Os limites dos bairros da cidade representam as áreas de fronteira administrativa e eleitoral da cidade. Desempenha um grande papel no planeamento da cidade, para cada conselho da corporação municipal.</span>
<span class="w">        </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Limites</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Administrativo</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bairro</span>
<span class="w">        </span><span class="nt">links</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">              </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">              </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">informação</span>
<span class="w">              </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://livingatlas-dcdev.opendata.arcgis.com/datasets/a090c89d52f1498f96a82e97b8bfb83e_0/about</span>
<span class="w">              </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en-US</span>
<span class="w">        </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">            </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">                </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">78.2379194985166180</span><span class="p p-Indicator">,</span><span class="nv">17.2908061510471995</span><span class="p p-Indicator">,</span><span class="nv">78.6217049083810764</span><span class="p p-Indicator">,</span><span class="nv">17.5618443356918768</span><span class="p p-Indicator">]</span>
<span class="w">                </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">            </span><span class="nt">temporal</span><span class="p">:</span>
<span class="w">                </span><span class="nt">begin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2011-11-11</span>
<span class="w">                </span><span class="nt">end</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span><span class="w">  </span><span class="c1"># ou vazio</span>
<span class="w">        </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Elasticsearch</span>
<span class="w">              </span><span class="c1">#Nota: elastic_search é o container de docker do ES, o nome é definido no docker-compose.yml</span>
<span class="w">              </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://elastic_search:9200/hyderabad</span>
<span class="w">              </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">objectid</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tile</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MVT-elastic</span>
<span class="w">              </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://elastic_search:9200/hyderabad/_mvt/geometry/{z}/{x}/{y}?grid_precision=0</span>
<span class="w">              </span><span class="c1"># o índice deve ter um geo_point</span>
<span class="w">              </span><span class="nt">options</span><span class="p">:</span>
<span class="w">                </span><span class="nt">zoom</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">                    </span><span class="nt">max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">29</span>
<span class="w">              </span><span class="nt">format</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pbf</span>
<span class="w">                    </span><span class="nt">mimetype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/vnd.mapbox-vector-tile</span>
</code></pre></div></td></tr></table></div>
<p>Esta configuração permite a publicação do <code>greater_hyderabad_municipal_corporation_ward_Boundaries.geojson</code> como OGC API - Features e OGC API - Tiles.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A API de pesquisa de tiles vetoriais do Elastic suporta níveis de zoom de 0 a 29.</p>
</div>
<p>Finalmente, inicie a composição docker, que irá descarregar e ingerir o conjunto de dados e publicá-lo na pygeoapi:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="pt-publishing-ogcapi-tiles-__tabbed_5_1" name="pt-publishing-ogcapi-tiles-__tabbed_5" type="radio" /><input id="pt-publishing-ogcapi-tiles-__tabbed_5_2" name="pt-publishing-ogcapi-tiles-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-tiles-__tabbed_5_1">Linux/Mac</label><label for="pt-publishing-ogcapi-tiles-__tabbed_5_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up
</code></pre></div>
</div></p>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pode verificar o seu índice elastic em:
<a href="http://localhost:9200/_cat/indices">http://localhost:9200/_cat/indices</a></p>
<p>Se estiver em produção, poderá querer fechar as portas do elastic no docker-compose.</p>
</div>
<h2 id="pt-publishing-ogcapi-tiles-acesso-do-lado-do-cliente">Acesso do lado do cliente</h2>
<h3 id="pt-publishing-ogcapi-tiles-qgis">QGIS</h3>
<p>O QGIS suporta tiles Vetoriais da OGC API através da <a href="https://docs.qgis.org/3.40/en/docs/user_manual/working_with_vector_tiles/vector_tiles_properties.html">Camada de tiles Vetoriais</a>. Embora a OGC API - Tiles não seja suportada nativamente, pode personalizar a <code>ligação genérica</code> para aceder a eles no QGIS.</p>
<div class="admonition question">
<p class="admonition-title">Aceder a tiles Vetoriais da OGC API a partir do QGIS</p>
<p>Antes de entrar no QGIS, aceda à página de instalação da sua pygeoapi no navegador e siga estes passos.</p>
<ul>
<li>aceda à página da coleção do conjunto de dados de tiles: <a href="http://localhost:5000/collections/hyderabad">http://localhost:5000/collections/hyderabad</a></li>
<li>navegue para a página de tiles clicando em <code>tiles</code>: <a href="http://localhost:5000/collections/hyderabad/tiles">http://localhost:5000/collections/hyderabad/tiles</a></li>
<li>clique em <code>Tileset Metadata</code>: <a href="http://localhost:5000/collections/hyderabad/tiles/WebMercatorQuad/metadata">http://localhost:5000/collections/hyderabad/tiles/WebMercatorQuad/metadata</a></li>
<li>Tome nota do URL template: <code>http://localhost:5000/collections/hyderabad/tiles/WebMercatorQuad/{tileMatrix}/{tileRow}/{tileCol}?f=mvt</code> e os valores de minZoom e maxZoom</li>
</ul>
<p>Siga estes passos para se ligar a um serviço e aceder a tiles vetoriais:</p>
<ul>
<li>
<p>localize o serviço de tiles vetoriais no painel do navegador do lado esquerdo. Note que também pode usar o menu superior e navegar para <code>Layer &gt; Adicionar Layer &gt; Adicionar Layer de Tiles Vetoriaiss</code></p>
</li>
<li>
<p>clique com o botão direito para abrir o menu de contexto e escolha <code>Nova Ligação Genérica</code></p>
</li>
<li>preencha os valores necessários. Para URL, use o URL que anotou no passo anterior, substituindo <code>{tileMatrix}/{tileRow}/{tileCol}</code> por <code>{z}/{y}/{x}</code>.</li>
</ul>
<p><img alt="" src="../assets/images/qgis-vtiles-hyderabad1.png" width="100%" /></p>
<ul>
<li>pressione <code>OK</code> para adicionar o serviço. Neste ponto, deverá ver a ligação aparecer. Clique em <code>Adicionar</code> para a adicionar ao mapa</li>
<li>Faça zoom para Hyderabad para visualizar o seu conjunto de dados</li>
</ul>
<p><img alt="" src="../assets/images/qgis-vtiles-hyderabad2.png" width="100%" /></p>
<p><img alt="" src="../assets/images/qgis-vtiles-hyderabad3.png" width="100%" /></p>
</div>
<h3 id="pt-publishing-ogcapi-tiles-leafletjs">LeafletJS</h3>
<p>O <a href="https://leafletjs.com">LeafletJS</a> é uma biblioteca JavaScript popular para adicionar mapas interativos a websites. O LeafletJS não suporta explicitamente as OGC APIs, no entanto, pode interagir com a OGC API usando diretamente os resultados da API.</p>
<div class="admonition question">
<p class="admonition-title">Adicionar OGC API - Tiles a um website com LeafletJS</p>
<ul>
<li>copie o HTML abaixo para um ficheiro chamado <code>vector-tiles.html</code>, ou localize este ficheiro em <code>workshop/exercises/html</code></li>
<li>abra o ficheiro num navegador web</li>
</ul>
<p>O código usa a biblioteca LeafletJS com o plugin <a href="https://github.com/Leaflet/Leaflet.VectorGrid">leaflet.vectorgrid</a> para exibir o serviço OGC API - Tiles de Hyderabad sobre um layer de base.</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Exercício OGC API - Tiles<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width:100vw;height:100vh;&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/leaflet@1.0.3/dist/leaflet.css&quot;</span> <span class="p">/&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/leaflet@1.3.1/dist/leaflet.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/leaflet.vectorgrid@1.3.0/dist/Leaflet.VectorGrid.bundled.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="w">    </span>
<span class="nx">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">L</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="s1">&#39;map&#39;</span><span class="p">).</span><span class="nx">setView</span><span class="p">({</span><span class="w"> </span><span class="nx">lat</span><span class="o">:</span><span class="w"> </span><span class="mf">17.425181</span><span class="p">,</span><span class="w"> </span><span class="nx">lng</span><span class="o">:</span><span class="w"> </span><span class="mf">78.5493906</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="mf">11</span><span class="p">);</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="s1">&#39;https://server.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">attribution</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Tiles &amp;copy; Esri &amp;mdash; National Geographic, Esri, DeLorme, NAVTEQ, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, iPC&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">minZoom</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">    </span><span class="nx">maxZoom</span><span class="o">:</span><span class="w"> </span><span class="mf">16</span><span class="p">,</span>
<span class="w">    </span><span class="p">}));</span>
<span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">getColor</span><span class="p">(</span><span class="nx">val</span><span class="p">){</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">40</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;#f2e6c7&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">80</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;#8fa37e&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;#f0d17d&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">120</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w">  </span><span class="s2">&quot;#d7ded1&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;#c2d0d9&quot;</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">vectorTileStyling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">greater_hyderabad_municipal_corporation_ward_Boundaries</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">properties</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">({</span>
<span class="w">            </span><span class="nx">fill</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="nx">fillColor</span><span class="o">:</span><span class="w"> </span><span class="nx">getColor</span><span class="p">(</span><span class="nx">properties</span><span class="p">.</span><span class="nx">objectid</span><span class="p">),</span>
<span class="w">            </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">fillOpacity</span><span class="o">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span>
<span class="w">            </span><span class="nx">weight</span><span class="o">:</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span>
<span class="w">            </span><span class="c1">//color: &quot;#ffffff&quot;,</span>
<span class="w">            </span><span class="nx">opacity</span><span class="o">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">mapVectorTileOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">rendererFactory</span><span class="o">:</span><span class="w"> </span><span class="nx">L</span><span class="p">.</span><span class="nx">canvas</span><span class="p">.</span><span class="nx">tile</span><span class="p">,</span>
<span class="w">        </span><span class="nx">interactive</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">vectorTileLayerStyles</span><span class="o">:</span><span class="w"> </span><span class="nx">vectorTileStyling</span><span class="p">,</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">pbfURL</span><span class="o">=</span><span class="s1">&#39;http://localhost:5000/collections/hyderabad/tiles/WorldCRS84Quad/{z}/{y}/{x}?f=mvt&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">pbfLayer</span><span class="o">=</span><span class="nx">L</span><span class="p">.</span><span class="nx">vectorGrid</span><span class="p">.</span><span class="nx">protobuf</span><span class="p">(</span><span class="nx">pbfURL</span><span class="p">,</span><span class="nx">mapVectorTileOptions</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">layer</span><span class="p">);</span>
<span class="w">    </span><span class="nx">L</span><span class="p">.</span><span class="nx">DomEvent</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
<span class="w">    </span><span class="p">}).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span><span class="w"> </span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<p>Neste exemplo, as cores dos símbolos refletem o valor do atributo <code>objectid</code>.</p>
<p><img alt="" src="../assets/images/leaflet-hyderabad.png" width="100%" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pode verificar os atributos do layer, abrindo a consola nas ferramentas de developer.
<img alt="" src="../assets/images/vtiles-attributes.png" width="100%" /></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Tente adicionar um <a href="https://demo.pygeoapi.io/master/collections/lakes/tiles/WorldCRS84Quad/metadata">layer de tiles vetoriais da pygeoapi diferente</a> atualizando o código em <code>workshop/exercises/html/vector-tiles.html</code>.</p>
<p>Se quiser renderizar as tiles do <a href="#pt-publishing-ogcapi-tiles-publish-vector-tiles-from-elasticsearch">exemplo do Elasticsearch</a>, pode consultar o código deste repositório <a href="https://github.com/doublebyte1/vtiles-example/blob/ogcapi-ws/demo-oat.htm">aqui</a>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="pt-publishing-ogcapi-tiles-__tabbed_6_1" name="pt-publishing-ogcapi-tiles-__tabbed_6" type="radio" /><input id="pt-publishing-ogcapi-tiles-__tabbed_6_2" name="pt-publishing-ogcapi-tiles-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-tiles-__tabbed_6_1">Linux/Mac</label><label for="pt-publishing-ogcapi-tiles-__tabbed_6_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>ogcapi-ws<span class="w"> </span>https://github.com/emotional-cities/vtiles-example.git
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>ogcapi-ws<span class="w"> </span>https://github.com/emotional-cities/vtiles-example.git
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p><img alt="" src="../assets/images/leaflet-hyderabad2.png" width="100%" /></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Consulte a <a href="https://leafletjs.com/reference.html">documentação oficial da LeafletJS</a></p>
</div>
<h3 id="pt-publishing-ogcapi-tiles-openlayers">OpenLayers</h3>
<p>O <a href="https://openlayers.org">OpenLayers</a> é uma biblioteca JavaScript popular para adicionar mapas interativos a websites. O OpenLayers suporta nativamente a OGC API - Tiles (mapa e vetor). Pode verificar o código para o exemplo abaixo em: <a href="https://ogcincubator.github.io/ogcapi-tiles-demo/">https://ogcincubator.github.io/ogcapi-tiles-demo/</a></p>
<p><iframe
  src="https://ogcincubator.github.io/ogcapi-tiles-demo/"
  style="width:100%; height:800px;"
></iframe>
</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Consulte a <a href="https://openlayers.org/en/latest/examples/ogc-vector-tiles.html">documentação oficial do OpenLayers</a></p>
</div>
<h1 id="pt-publishing-ogcapi-tiles-resumo">Resumo</h1>
<p>Parabéns! Agora é capaz de publicar tiles na pygeoapi. Pode aprender mais sobre este Standard em: <a href="https://tiles.developer.ogc.org/">https://tiles.developer.ogc.org/</a></p></section><section class="print-page" id="pt-publishing-ogcapi-records" heading-number="5.7"><h1 id="pt-publishing-ogcapi-records-exercicio-6-metadados-via-ogc-api-records">Exercício 6 - Metadados via OGC API - Records</h1>
<p>A <a href="https://ogcapi.ogc.org/records">OGC API - Records</a> fornece uma API de Web com a capacidade de criar, modificar,
e consultar metadados na Web:</p>
<ul>
<li>Leia a especificação <a href="https://docs.ogc.org/is/20-004r1/20-004r1.html">OGC API - Records: Part 1: Core</a> no website da OGC.</li>
</ul>
<p>A OGC API - Records utiliza a OGC API - Features como bloco de construção, permitindo assim implementação
e integração simplificadas para clientes e utilizadores.</p>
<h2 id="pt-publishing-ogcapi-records-suporte-na-pygeoapi">Suporte na pygeoapi</h2>
<p>A pygeoapi suporta a especificação OGC API - Records, usando Elasticsearch e TinyDB <a href="https://rasterio.readthedocs.io">rasterio</a> como backends principais.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consulte <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-records.html">a documentação oficial</a> para mais informações sobre backends de catálogo/metadados suportados</p>
</div>
<h2 id="pt-publishing-ogcapi-records-publicar-registos-de-metadados-na-pygeoapi">Publicar registos de metadados na pygeoapi</h2>
<p>Com a pygeoapi vamos configurar OGC API - Records usando qualquer fornecedor de dados suportado. Neste exercício vamos usar o backend
de catálogo <a href="https://tinydb.readthedocs.io/en/latest/index.html">TinyDB</a>. Vamos utilizar o catálogo de exemplo em <code>workshop/exercises/data/tartu/metadata/catalogue.tinydb</code>.</p>
<div class="admonition question">
<p class="admonition-title">Atualizar a configuração da pygeoapi</p>
<p>Abra o ficheiro de configuração da pygeoapi num editor de texto. Adicione uma nova secção de conjunto de dados da seguinte forma:</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nt">example_catalogue</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FOSS4G Europe Estonia national catalogue</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FOSS4G Europe Estonia national catalogue</span>
<span class="w">        </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">estonia</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">catalogue</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FOSS4G Europe</span>
<span class="w">        </span><span class="nt">links</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">              </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">              </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">information</span>
<span class="w">              </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://metadata.geoportaal.ee</span>
<span class="w">              </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en-US</span>
<span class="w">        </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">            </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">                </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">23.3397953631</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">57.4745283067</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">28.1316992531</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">59.6110903998</span><span class="p p-Indicator">]</span>
<span class="w">                </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">        </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">record</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TinyDBCatalogue</span>
<span class="w">              </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/tartu/metadata/catalogue.tinydb</span>
<span class="w">              </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">externalId</span>
<span class="w">              </span><span class="nt">time_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">recordCreated</span>
<span class="w">              </span><span class="nt">title_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">title</span>
</code></pre></div></td></tr></table></div>
<p>Guarde a configuração e reinicie o Docker Compose. Navegue para <a href="http://localhost:5000/collections">http://localhost:5000/collections</a> para avaliar se o novo conjunto de dados foi publicado.</p>
<h2 id="pt-publishing-ogcapi-records-formatos-de-metadados">Formatos de metadados</h2>
<p>Por defeito, a pygeoapi suporta e espera o modelo de records e os "queryables" da OGC API - Records. Para formatos de metadados adicionais, pode desenvolver o seu próprio plugin personalizado para a pygeoapi, ou converter os seus metadados para o modelo de records da OGC API - Records antes de os adicionar à pygeoapi.</p>
<div class="admonition question">
<p class="admonition-title">Instalar a OWSLib</p>
<p>Se não tiver o Python instalado, considere executar este exercício num container Docker. Consulte o <a href="#pt-setup-using-docker-for-python-clients">Capítulo de Configuração</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="pt-publishing-ogcapi-records-__tabbed_1_1" name="pt-publishing-ogcapi-records-__tabbed_1" type="radio" /><input id="pt-publishing-ogcapi-records-__tabbed_1_2" name="pt-publishing-ogcapi-records-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-records-__tabbed_1_1">Linux/Mac</label><label for="pt-publishing-ogcapi-records-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<h3 id="pt-publishing-ogcapi-records-exemplo-de-loader-de-iso-19139-para-tinydbcatalogue">Exemplo de loader de ISO 19139 para TinyDBCatalogue</h3>
<p>É possível carregar mais metadados de exemplo ISO19139 numa base de dados TinyDB com <a href="https://github.com/geopython/pygeoapi/blob/master/tests/load_tinydb_records.py">o seguinte script</a> (<a href="https://raw.githubusercontent.com/geopython/pygeoapi/master/tests/load_tinydb_records.py">raw</a>):</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="pt-publishing-ogcapi-records-__tabbed_2_1" name="pt-publishing-ogcapi-records-__tabbed_2" type="radio" /><input id="pt-publishing-ogcapi-records-__tabbed_2_2" name="pt-publishing-ogcapi-records-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-records-__tabbed_2_1">Linux/Mac</label><label for="pt-publishing-ogcapi-records-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises/data/tartu/metadata
curl<span class="w"> </span>-O<span class="w"> </span>https://raw.githubusercontent.com/geopython/pygeoapi/master/tests/load_tinydb_records.py
python3<span class="w"> </span>load_tinydb_records.py<span class="w"> </span>xml<span class="w"> </span>catalogue.tinydb
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises/data/tartu/metadata
curl<span class="w"> </span>https://raw.githubusercontent.com/geopython/pygeoapi/master/tests/load_tinydb_records.py
python3<span class="w"> </span>load_tinydb_records.py<span class="w"> </span>xml<span class="w"> </span>catalogue.tinydb
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Se não tiver o curl instalado, copie o URL acima para o seu navegador web e guarde localmente.</p>
<p>Se não tiver o Python instalado, pode usar o loader utilizando o container Docker da OWSLib. Consulte o <a href="#pt-setup-using-docker-for-python-clients">Capítulo de Configuração</a>.</p>
<div class="admonition example">
<p class="admonition-title">Usar o container Docker da OWSLib para carregar metadados</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="pt-publishing-ogcapi-records-__tabbed_3_1" name="pt-publishing-ogcapi-records-__tabbed_3" type="radio" /><input id="pt-publishing-ogcapi-records-__tabbed_3_2" name="pt-publishing-ogcapi-records-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-records-__tabbed_3_1">Linux/Mac</label><label for="pt-publishing-ogcapi-records-__tabbed_3_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>--network<span class="o">=</span>host<span class="w"> </span>--name<span class="w"> </span>owslib<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/data:/data<span class="w"> </span>python:3.10-slim<span class="w"> </span>/bin/bash
pip3<span class="w"> </span>install<span class="w"> </span>owslib
apt-get<span class="w"> </span>update<span class="w"> </span>-y<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>curl<span class="w"> </span>-y
curl<span class="w"> </span>-O<span class="w"> </span>https://raw.githubusercontent.com/geopython/pygeoapi/master/tests/load_tinydb_records.py
python3<span class="w"> </span>load_tinydb_records.py<span class="w"> </span>/data/tartu/metadata/xml<span class="w"> </span>/data/tartu/metadata/catalogue.tinydb
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>--network<span class="o">=</span>host<span class="w"> </span>--name<span class="w"> </span>owslib<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/data:/data<span class="w"> </span>python:3.10-slim<span class="w"> </span>/bin/bash
pip3<span class="w"> </span>install<span class="w"> </span>owslib
apt-get<span class="w"> </span>update<span class="w"> </span>-y<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>curl<span class="w"> </span>-y
curl<span class="w"> </span>-O<span class="w"> </span>https://raw.githubusercontent.com/geopython/pygeoapi/master/tests/load_tinydb_records.py
python3<span class="w"> </span>load_tinydb_records.py<span class="w"> </span>/data/tartu/metadata/xml<span class="w"> </span>/data/tartu/metadata/catalogue.tinydb
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<p>Navegue para <a href="http://localhost:5000/collections/example_catalogue">http://localhost:5000/collections/example_catalogue</a> para avaliar se os novos metadados foram publicados
na coleção.</p>
<div class="admonition tip pygeometa">
<p class="admonition-title">Tip</p>
<p>O <a href="https://geopython.github.io/pygeometa">pygeometa</a> é um pacote Python para gerar metadados para conjuntos de dados geoespaciais.
AOpygeometa permite gerir metadados em ficheiros YAML simples "metadata control files (MCF)", e suporta
importação, exportação, bem como transformações para muitos formatos de metadados geoespaciais. Metadados
da OGC API - Records podem ser produzidos usando o pygeometa, quer a partir de ficheiros MCF ou por transformação de outros formatos.</p>
<p>Instale e execute o pygeometa como abaixo para ter uma ideia dos vários comandos e funcionalidades (além disso,
consulte o <a href="https://geopython.github.io/pygeometa/tutorial">tutorial</a>).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="pt-publishing-ogcapi-records-__tabbed_4_1" name="pt-publishing-ogcapi-records-__tabbed_4" type="radio" /><input id="pt-publishing-ogcapi-records-__tabbed_4_2" name="pt-publishing-ogcapi-records-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-records-__tabbed_4_1">Linux/Mac</label><label for="pt-publishing-ogcapi-records-__tabbed_4_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>pygeometa
pygeometa<span class="w"> </span>--help
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>pygeometa
pygeometa<span class="w"> </span>--help
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<h2 id="pt-publishing-ogcapi-records-a-pygeoapi-como-um-proxy-de-csw">A pygeoapi como um proxy de CSW</h2>
<p>Pode verificar a secção "pygeoapi como uma Ponte para Outros serviços" para aprender como <a href="#pt-advanced-bridges-publishing-csw-as-ogc-api-records">publicar CSW como OGC API - Records</a>.</p>
<h2 id="pt-publishing-ogcapi-records-acesso-de-cliente">Acesso de cliente</h2>
<h3 id="pt-publishing-ogcapi-records-qgis">QGIS</h3>
<p>O QGIS suporta a OGC API - Records através do <a href="https://docs.qgis.org/latest/en/docs/user_manual/plugins/core_plugins/plugins_metasearch.html">plugin MetaSearch</a>. O MetaSearch focava-se originalmente apenas em Catalogue Service for the Web (OGC:CSW), mas foi estendido para a OGC API - Records. O MetaSearch é um plugin padrão no QGIS e não requer instalação adicional.</p>
<div class="admonition question">
<p class="admonition-title">Consultar a OGC API - Records a partir do QGIS</p>
<p>Siga estes passos para se conectar a um serviço e consultar conjuntos de dados:</p>
<ul>
<li>Localize o plugin MetaSearch no menu Web ou na Barra de Ferramentas <img alt="Ícone do MetaSearch" src="https://docs.qgis.org/latest/en/_images/MetaSearch.png" title="Ícone do MetaSearch" />. O painel de pesquisa principal aparecerá com a lista de catálogos padrão do MetaSearch já preenchida.</li>
</ul>
<p><img alt="Catálogos pré-preenchidos" src="../assets/images/prepopulated-catalogues.png" width="50%" /></p>
<ul>
<li>abra o separador <code>Services</code>, para encontrar o botão <code>New</code> para criar uma nova ligação</li>
<li>adicione uma ligação a <code>https://demo.pygeoapi.io/master</code></li>
<li>clique em <code>Service Info</code> para obter informações sobre o serviço</li>
<li>volte ao separador Search</li>
<li>selecione a ligação que acabou de criar</li>
<li>escreva um termo de pesquisa e clique em <code>search</code></li>
<li>repare que quando seleciona um resultado da pesquisa, uma pegada vermelha é desenhada no mapa, destacando a localização do conjunto de dados</li>
</ul>
<p><img alt="Resultados da pesquisa" src="../assets/images/search-results.png" width="50%" /></p>
</div>
<h3 id="pt-publishing-ogcapi-records-owslib">OWSLib</h3>
<p>A <a href="https://owslib.readthedocs.io">OWSLib</a> é uma biblioteca Python para interagir com OGC Web Services e suporta várias OGC APIs, incluindo a OGC API - Records.</p>
<div class="admonition question">
<p class="admonition-title">Interagir com a OGC API - Records via OWSLib</p>
<p>Se não tiver o Python instalado, considere executar este exercício num contentor Docker. Consulte o <a href="#pt-setup-using-docker-for-python-clients">Capítulo de Configuração</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="pt-publishing-ogcapi-records-__tabbed_5_1" name="pt-publishing-ogcapi-records-__tabbed_5" type="radio" /><input id="pt-publishing-ogcapi-records-__tabbed_5_2" name="pt-publishing-ogcapi-records-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-records-__tabbed_5_1">Linux/Mac</label><label for="pt-publishing-ogcapi-records-__tabbed_5_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Depois, inicie uma sessão de consola Python com <code>python3</code> (pare a sessão escrevendo <code>exit()</code>).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="pt-publishing-ogcapi-records-__tabbed_6_1" name="pt-publishing-ogcapi-records-__tabbed_6" type="radio" /><input id="pt-publishing-ogcapi-records-__tabbed_6_2" name="pt-publishing-ogcapi-records-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-records-__tabbed_6_1">Linux/Mac</label><label for="pt-publishing-ogcapi-records-__tabbed_6_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.records</span><span class="w"> </span><span class="kn">import</span> <span class="n">Records</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">SERVICE_URL</span> <span class="o">=</span> <span class="s1">&#39;https://demo.pygeoapi.io/master/&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Records</span><span class="p">(</span><span class="n">SERVICE_URL</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;dutch-metadata&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="s1">&#39;dutch-metadata&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Sample metadata records from Dutch Nationaal georegister&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
<span class="s1">&#39;Sample metadata records from Dutch Nationaal georegister&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_items</span><span class="p">(</span><span class="s1">&#39;dutch-metadata&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span><span class="p">[</span><span class="s1">&#39;numberMatched&#39;</span><span class="p">]</span>
<span class="mi">198</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span><span class="p">[</span><span class="s1">&#39;numberReturned&#39;</span><span class="p">]</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_items</span><span class="p">(</span><span class="s1">&#39;dutch-metadata&#39;</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="s1">&#39;Wegpanorama&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span><span class="p">[</span><span class="s1">&#39;numberMatched&#39;</span><span class="p">]</span>
<span class="mi">2</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.records</span><span class="w"> </span><span class="kn">import</span> <span class="n">Records</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">SERVICE_URL</span> <span class="o">=</span> <span class="s1">&#39;https://demo.pygeoapi.io/master/&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Records</span><span class="p">(</span><span class="n">SERVICE_URL</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;dutch-metadata&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="s1">&#39;dutch-metadata&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Sample metadata records from Dutch Nationaal georegister&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
<span class="s1">&#39;Sample metadata records from Dutch Nationaal georegister&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_items</span><span class="p">(</span><span class="s1">&#39;dutch-metadata&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span><span class="p">[</span><span class="s1">&#39;numberMatched&#39;</span><span class="p">]</span>
<span class="mi">198</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span><span class="p">[</span><span class="s1">&#39;numberReturned&#39;</span><span class="p">]</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_items</span><span class="p">(</span><span class="s1">&#39;dutch-metadata&#39;</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="s1">&#39;Wegpanorama&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span><span class="p">[</span><span class="s1">&#39;numberMatched&#39;</span><span class="p">]</span>
<span class="mi">2</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consulte a <a href="https://owslib.readthedocs.io/en/latest/usage.html#ogc-api">documentação oficial da OWSLib</a> para mais exemplos.</p>
</div>
<h1 id="pt-publishing-ogcapi-records-resumo">Resumo</h1>
<p>Parabéns! Agora é capaz de publicar metadados na pygeoapi.</p></section><section class="print-page" id="pt-publishing-ogcapi-edr" heading-number="5.8"><h1 id="pt-publishing-ogcapi-edr-exercicio-7-dados-ambientais-via-ogc-api-environmental-data-retrieval">Exercício 7 - Dados ambientais via OGC API - Environmental Data Retrieval</h1>
<p><a href="https://ogcapi.ogc.org/edr">OGC API - Environmental Data Retrieval</a> fornece uma Web API para aceder
a dados ambientais usando padrões de consulta bem definidos:</p>
<ul>
<li><a href="https://docs.ogc.org/is/19-086r4/19-086r4.html">Norma OGC API - Environmental Data Retrieval</a></li>
</ul>
<p>A OGC API - Environmental Data Retrieval utiliza a OGC API - Features como bloco de construção, permitindo assim
integração simplificada para clientes e utilizadores. A EDR pode ser considerada uma API de conveniência que não
requer conhecimento aprofundado sobre o armazenamento/modelo de dados subjacente.</p>
<h2 id="pt-publishing-ogcapi-edr-suporte-na-pygeoapi">Suporte na pygeoapi</h2>
<p>A pygeoapi suporta a especificação OGC API - Environmental Data Retrieval aproveitando tanto plugins de fornecedor
de funcionalidades como de cobertura.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consulte <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-edr.html">a documentação oficial</a> para mais informações sobre backends EDR suportados</p>
</div>
<h2 id="pt-publishing-ogcapi-edr-publicar-dados-ambientais-na-pygeoapi">Publicar dados ambientais na pygeoapi</h2>
<p>Vamos publicar alguns dados ICOADS através do plugin EDR xarray. Os dados ICOADS do exemplo podem ser encontrados em <code>workshop/exercises/data/coads_sst.nc</code>:</p>
<div class="admonition question">
<p class="admonition-title">Atualizar a configuração da pygeoapi</p>
<p>Abra o ficheiro de configuração da pygeoapi num editor de texto. Adicione uma nova secção de conjunto de dados da seguinte forma:</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nt">icoads-sst</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">International Comprehensive Ocean-Atmosphere Data Set (ICOADS)</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">International Comprehensive Ocean-Atmosphere Data Set (ICOADS)</span>
<span class="w">        </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">icoads</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sst</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">air temperature</span>
<span class="w">        </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">            </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">                </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-180</span><span class="p p-Indicator">,</span><span class="nv">-90</span><span class="p p-Indicator">,</span><span class="nv">180</span><span class="p p-Indicator">,</span><span class="nv">90</span><span class="p p-Indicator">]</span>
<span class="w">                </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">            </span><span class="nt">temporal</span><span class="p">:</span>
<span class="w">                </span><span class="nt">begin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2000-01-16T06:00:00Z</span>
<span class="w">                </span><span class="nt">end</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2000-12-16T06:00:00Z</span>
<span class="w">        </span><span class="nt">links</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">              </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">              </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">information</span>
<span class="w">              </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://psl.noaa.gov/data/gridded/data.coads.1deg.html</span>
<span class="w">              </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en-US</span>
<span class="w">        </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">edr</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xarray-edr</span>
<span class="w">              </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/coads_sst.nc</span>
<span class="w">              </span><span class="nt">format</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetCDF</span>
<span class="w">                  </span><span class="nt">mimetype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/x-netcdf</span>
</code></pre></div></td></tr></table></div>
<p>Guarde a configuração e reinicie o Docker Compose. Navegue para <a href="http://localhost:5000/collections">http://localhost:5000/collections</a> para avaliar se o novo conjunto de dados foi publicado.</p>
<p>À primeira vista, a coleção <code>icoads-sst</code> aparece como uma coleção normal OGC API - Coverages. Olhe um pouco mais de perto para a descrição da coleção, e note
que há uma chave 'parameter_names' que descreve os nomes dos parâmetros EDR para as consultas da coleção.</p>
<h3 id="pt-publishing-ogcapi-edr-owslib-avancado">OWSLib - Avançado</h3>
<p><a href="https://owslib.readthedocs.io">OWSLib</a> é uma biblioteca Python para interagir com Serviços Web OGC e suporta várias OGC APIs incluindo OGC API - Environmental Data Retrieval.</p>
<div class="admonition question">
<p class="admonition-title">Interagir com OGC API - Environmental Data Retrieval via OWSLib</p>
<p>Se não tem Python instalado, considere executar este exercício num contentor Docker. Consulte o <a href="#pt-setup-using-docker-for-python-clients">Capítulo de Configuração</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="pt-publishing-ogcapi-edr-__tabbed_1_1" name="pt-publishing-ogcapi-edr-__tabbed_1" type="radio" /><input id="pt-publishing-ogcapi-edr-__tabbed_1_2" name="pt-publishing-ogcapi-edr-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-edr-__tabbed_1_1">Linux/Mac</label><label for="pt-publishing-ogcapi-edr-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Depois, inicie uma sessão de consola Python com <code>python3</code> (pare a sessão escrevendo <code>exit()</code>).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="pt-publishing-ogcapi-edr-__tabbed_2_1" name="pt-publishing-ogcapi-edr-__tabbed_2" type="radio" /><input id="pt-publishing-ogcapi-edr-__tabbed_2_2" name="pt-publishing-ogcapi-edr-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="pt-publishing-ogcapi-edr-__tabbed_2_1">Linux/Mac</label><label for="pt-publishing-ogcapi-edr-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.edr</span><span class="w"> </span><span class="kn">import</span>  <span class="n">EnvironmentalDataRetrieval</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">EnvironmentalDataRetrieval</span><span class="p">(</span><span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">api</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">api</span><span class="p">()</span>  <span class="c1"># documento OpenAPI</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">collections</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collections</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">collections</span><span class="p">[</span><span class="s1">&#39;collections&#39;</span><span class="p">])</span>
<span class="mi">13</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">icoads_sst</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;icoads-sst&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">icoads_sst</span><span class="p">[</span><span class="s1">&#39;parameter-names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="n">dict_keys</span><span class="p">([</span><span class="s1">&#39;SST&#39;</span><span class="p">,</span> <span class="s1">&#39;AIRT&#39;</span><span class="p">,</span> <span class="s1">&#39;UWND&#39;</span><span class="p">,</span> <span class="s1">&#39;VWND&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">query_data</span><span class="p">(</span><span class="s1">&#39;icoads_sst&#39;</span><span class="p">,</span> <span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="s1">&#39;POINT(-75 45)&#39;</span><span class="p">,</span> <span class="n">parameter_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SST&#39;</span><span class="p">,</span> <span class="s1">&#39;AIRT&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span>  <span class="c1"># dados CoverageJSON</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.edr</span><span class="w"> </span><span class="kn">import</span>  <span class="n">EnvironmentalDataRetrieval</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">EnvironmentalDataRetrieval</span><span class="p">(</span><span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">api</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">api</span><span class="p">()</span>  <span class="c1"># documento OpenAPI</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">collections</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collections</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">collections</span><span class="p">[</span><span class="s1">&#39;collections&#39;</span><span class="p">])</span>
<span class="mi">13</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">icoads_sst</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;icoads-sst&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">icoads_sst</span><span class="p">[</span><span class="s1">&#39;parameter-names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="n">dict_keys</span><span class="p">([</span><span class="s1">&#39;SST&#39;</span><span class="p">,</span> <span class="s1">&#39;AIRT&#39;</span><span class="p">,</span> <span class="s1">&#39;UWND&#39;</span><span class="p">,</span> <span class="s1">&#39;VWND&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">query_data</span><span class="p">(</span><span class="s1">&#39;icoads_sst&#39;</span><span class="p">,</span> <span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="s1">&#39;POINT(-75 45)&#39;</span><span class="p">,</span> <span class="n">parameter_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SST&#39;</span><span class="p">,</span> <span class="s1">&#39;AIRT&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span>  <span class="c1"># dados CoverageJSON</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consulte a <a href="https://owslib.readthedocs.io/en/latest/usage.html#ogc-api">documentação oficial da OWSLib</a> para mais exemplos.</p>
</div>
<h1 id="pt-publishing-ogcapi-edr-resumo">Resumo</h1>
<p>Parabéns! Agora é capaz de publicar dados ambientais na pygeoapi.</p></section><section class="print-page" id="pt-publishing-ogcapi-processes" heading-number="5.9"><h1 id="pt-publishing-ogcapi-processes-exercicio-8-funcoes-via-ogc-api-processes">Exercício 8 - Funções via OGC API - Processes</h1>
<p><a href="https://ogcapi.ogc.org/processes">OGC API - Processes</a> suporta o encapsulamento de tarefas computacionais em
processos executáveis que podem ser oferecidos por um servidor através de uma Web API e ser invocados por uma aplicação cliente.</p>
<ul>
<li><a href="https://docs.ogc.org/is/18-062r2/18-062r2.html">OGC API - Processes: Part 1: Core</a></li>
</ul>
<p>A OGC API - Processes utiliza a OGC API - Common como bloco de construção, permitindo assim implementação
e integração simplificadas para clientes e utilizadores.</p>
<h2 id="pt-publishing-ogcapi-processes-suporte-na-pygeoapi">Suporte na pygeoapi</h2>
<p>A pygeoapi suporta a especificação OGC API - Processes, com a capacidade de publicar código Python (independentemente de quão
simples ou complexo) como uma definição de Processo OGC API. A pygeoapi também suporta processamento síncrono ou assíncrono,
com a capacidade de armazenar e recuperar o estado/resultados de 'tarefas'.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consulte <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-processes.html">a documentação oficial</a> para mais informações sobre publicação de processos na pygeoapi</p>
</div>
<h2 id="pt-publishing-ogcapi-processes-publicar-codigo-python-como-um-processo-na-pygeoapi">Publicar código Python como um processo na pygeoapi</h2>
<p>Com a pygeoapi vamos configurar OGC API - Processes usando código Python que implementa o <code>BaseProcessor</code> da pygeoapi, que é uma classe
abstrata base fundamental da pygeoapi. Neste exercício vamos implementar uma função "squared" como um processo usando o código Python de exemplo em
<code>workshop/exercises/plugins/process/squared.py</code>. O processo já está definido para fazer parte do ambiente e configuração da pygeoapi.</p>
<div class="admonition question">
<p class="admonition-title">Atualizar a configuração da pygeoapi</p>
<p>Abra o ficheiro de configuração da pygeoapi num editor de texto. Adicione uma nova secção de processo da seguinte forma:</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nt">squared</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">process</span>
<span class="w">        </span><span class="nt">processor</span><span class="p">:</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pygeoapi.process.squared.SquaredProcessor</span>
</code></pre></div></td></tr></table></div>
<div class="admonition question">
<p class="admonition-title">Atualizar o código Python</p>
<p>Abra o código Python em <code>workshop/exercises/plugins/process/squared.py</code>. Encontre a função <code>execute</code> e atualize o código Python
para calcular o valor de entrada ao quadrado.</p>
</div>
<p>Guarde a configuração e reinicie o Docker Compose. Navegue para <a href="http://localhost:5000/processes">http://localhost:5000/processes</a> para avaliar se o novo processo foi
publicado. Inspecione os metadados detalhados do processo navegando para <a href="http://localhost:5000/processes/squared">http://localhost:5000/processes/squared</a> para inspecionar como os metadados do processo
definidos no código/ficheiro Python são disponibilizados em JSON.</p>
<h2 id="pt-publishing-ogcapi-processes-acesso-cliente">Acesso cliente</h2>
<h3 id="pt-publishing-ogcapi-processes-swagger">Swagger</h3>
<p>A forma mais fácil de testar o novo processo é usando a interface Swagger incorporada da pygeoapi. Navegue para <a href="http://localhost:5000/openapi">http://localhost:5000/openapi</a> e experimente
o processo na interface Swagger.</p>
<p><img alt="Execução do processo função squared" src="../assets/images/oaproc-squared-1.png" width="120%" /></p>
<p><img alt="Execução do processo função squared" src="../assets/images/oaproc-squared-2.png" width="120%" /></p>
<p><img alt="Execução do processo função squared" src="../assets/images/oaproc-squared-3.png" width="120%" /></p>
<h1 id="pt-publishing-ogcapi-processes-resumo">Resumo</h1>
<p>Parabéns! Agora é capaz de publicar código Python como um processo na pygeoapi.</p></section></section>
                    <section class='print-page md-section' id='section-6' heading-number='6'>
                        <h1>Tópicos avançados<a class='headerlink' href='#section-6' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="pt-advanced" heading-number="6.1"><h1 id="pt-advanced-topicos-avancados">Tópicos avançados</h1>
<p>Nesta secção, discutiremos tópicos mais avançados da pygeoapi focados principalmente
em estender a pygeoapi através de desenvolvimento personalizado e implementação.</p>
<ul>
<li><a href="#pt-advanced-i18n">Suporte multilíngue</a></li>
<li><a href="#pt-advanced-crs">Suporte CRS</a></li>
<li><a href="#pt-advanced-ui-custom-templates">Personalização de UI e templating</a></li>
<li><a href="#pt-advanced-downstream-applications">Usar pygeoapi em aplicações downstream</a></li>
<li><a href="#pt-advanced-seo">Otimização para motores de busca (SEO)</a></li>
<li><a href="#pt-advanced-security-access-control">Segurança e controlo de acessos</a></li>
<li><a href="#pt-advanced-semantic-web-linked-data">Web Semântica e Linked Data</a></li>
<li><a href="#pt-advanced-cloud">Implementação na cloud</a></li>
<li><a href="#pt-advanced-inspire">Suporte INSPIRE</a></li>
<li><a href="#pt-advanced-bridges">pygeoapi como Ponte para Outros Serviços</a></li>
</ul></section><section class="print-page" id="pt-advanced-i18n" heading-number="6.2"><h1 id="pt-advanced-i18n-suporte-multilingue">Suporte multilíngue</h1>
<p>A pygeoapi suporta multilingualismo a três níveis:</p>
<ul>
<li>Na configuração da pygeoapi pode fornecer títulos e resumos do serviço e coleções em múltiplas linguagens.</li>
<li>Um conjunto de strings de texto traduzíveis que são traduzidas e introduzidas como parte dos formatos de saída JSON e HTML. As traduções são geridas pela <a href="https://babel.pocoo.org">framework Babel</a></li>
<li>Nomes/valores de colunas em conjuntos de dados baseados em funcionalidades. Se um conjunto de dados contém colunas em múltiplas línguas, a pygeoapi tentará devolver respostas de dados na língua solicitada</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As mensagens de erro não são traduzidas, para facilitar copy-paste do erro para o 
<a href="https://stackoverflow.com/search?q=pygeoapi">stackoverflow</a> e 
<a href="https://github.com/geopython/pygeoapi/issues">GitHub issues</a>.</p>
</div>
<p>A negociação de língua é acionada pelo cabeçalho HTTP <code>Accept-Language</code> enviado pelo cliente, e pode sempre ser substituída com o parâmetro URL <code>?lang=fr</code>.</p>
<h2 id="pt-advanced-i18n-configuracao-multilingue">Configuração multilíngue</h2>
<p>Na configuração da pygeoapi podemos indicar as línguas suportadas pela instância. A primeira língua é a língua padrão. Para a maioria das propriedades de configuração textuais podemos fornecer uma tradução em línguas alternativas.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">lakes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">  </span><span class="nt">title</span><span class="p">:</span>
<span class="w">      </span><span class="nt">en</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Large Lakes</span>
<span class="w">      </span><span class="nt">pt</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Grandes Lagos</span>
<span class="w">  </span><span class="nt">description</span><span class="p">:</span>
<span class="w">      </span><span class="nt">en</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lakes of the world, public domain</span>
<span class="w">      </span><span class="nt">pt</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lagos do mundo, domínio público</span>
<span class="w">  </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">      </span><span class="nt">en</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lakes</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">water bodies</span>
<span class="w">      </span><span class="nt">pt</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lagos</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">corpos de água</span>
</code></pre></div></td></tr></table></div>
<h2 id="pt-advanced-i18n-strings-de-texto-dentro-de-templates-html-jinja2">Strings de texto dentro de templates HTML Jinja2</h2>
<p>A maioria das strings de texto traduzíveis existe dentro dos templates HTML Jinja2. As strings de texto a serem traduzidas são colocadas numa tag <code>trans</code>, da seguinte forma:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{% trans %}Page title{% endtrans %}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<p>O Babel fornece um utilitário que extrai todas as chaves a serem traduzidas dos templates para um único ficheiro <code>.pot</code>. </p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="pt-advanced-i18n-__tabbed_1_1" name="pt-advanced-i18n-__tabbed_1" type="radio" /><input id="pt-advanced-i18n-__tabbed_1_2" name="pt-advanced-i18n-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="pt-advanced-i18n-__tabbed_1_1">Linux/Mac</label><label for="pt-advanced-i18n-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pybabel<span class="w"> </span>extract<span class="w"> </span>-F<span class="w"> </span>babel-mapping.ini<span class="w"> </span>-o<span class="w"> </span>locale/messages.pot<span class="w"> </span>./
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pybabel<span class="w"> </span>extract<span class="w"> </span>-F<span class="w"> </span>babel-mapping.ini<span class="w"> </span>-o<span class="w"> </span>locale/messages.pot<span class="w"> </span>./
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>O ficheiro <code>.pot</code> resultante é usado para criar ou atualizar ficheiros <code>.po</code> existentes, que existem para cada língua, contendo as traduções atuais.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="pt-advanced-i18n-__tabbed_2_1" name="pt-advanced-i18n-__tabbed_2" type="radio" /><input id="pt-advanced-i18n-__tabbed_2_2" name="pt-advanced-i18n-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="pt-advanced-i18n-__tabbed_2_1">Linux/Mac</label><label for="pt-advanced-i18n-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pybabel<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span>locale<span class="w"> </span>-l<span class="w"> </span>it<span class="w"> </span>-i<span class="w"> </span>locale/messages.pot
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pybabel<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span>locale<span class="w"> </span>-l<span class="w"> </span>it<span class="w"> </span>-i<span class="w"> </span>locale/messages.pot
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Os ficheiros <code>.po</code> são armazenados no repositório de código fonte da pygeoapi no GitHub. Pode criar um Pull Request para adicionar ou atualizar as suas linguagens favoritas. Os ficheiros <code>.po</code> também podem ser adicionados a software de tradução como <a href="https://transifex.com">transifex.com</a>. </p>
<div class="admonition question">
<p class="admonition-title">Editar um ficheiro <code>.po</code></p>
<p>Abra um ficheiro <code>.po</code> da pasta <a href="https://github.com/geopython/pygeoapi/tree/master/locale">locale</a> num editor de texto. Edite alguns valores. Guarde o ficheiro e reinicie o serviço. Verifique se o conteúdo atualizado está disponível. Também pode tentar adicionar uma nova chave a um template e traduzi-la através do mecanismo <code>.po</code>.</p>
</div>
<h2 id="pt-advanced-i18n-anotar-a-lingua-das-colunas-de-dados">Anotar a língua das colunas de dados</h2>
<p>A pygeoapi inclui um mecanismo para influenciar as respostas da API baseado na língua solicitada. Se o nosso serviço opera com requisitos multilíngues, pode fazer sentido adicionar colunas textuais em múltiplas línguas. Por exemplo, na configuração da pygeoapi podemos então indicar qual coluna deve ser usada como o campo título, para qual língua. </p>
<div class="admonition question">
<p class="admonition-title">Publicar um conjunto de dados multilíngue</p>
<p>Para este workshop, preparámos um conjunto de dados multilíngue de <code>hotspots de wifi gratuitos em Florença</code> (<code>workshop/exercises/data/free-wifi-florence.csv</code>). Vamos adicionar o conjunto de dados à configuração da pygeoapi usando o provedor CSV. Vamos adicionar uma configuração title-field com para cada coluna traduzida a língua relevante.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/free-wifi-florence.csv</span>
<span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">id</span>
<span class="nt">title_field</span><span class="p">:</span><span class="w"> </span>
<span class="w">  </span><span class="nt">en</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name-en</span>
<span class="w">  </span><span class="nt">it</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name-it</span>
<span class="w">  </span><span class="nt">de</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name-de</span>
</code></pre></div></td></tr></table></div>
<p>Vamos testar a configuração navegando para a página de itens da coleção e mudando a língua anexando <code>?lang=it</code>, <code>?lang=de</code> ao URL.</p>
</div>
<h1 id="pt-advanced-i18n-resumo">Resumo</h1>
<p>Parabéns! Personalizámos a pygeoapi para suportar múltiplas línguas.</p></section><section class="print-page" id="pt-advanced-crs" heading-number="6.3"><h1 id="pt-advanced-crs-suporte-crs">Suporte CRS</h1>
<p>A partir da versão 0.15.0, a pygeoapi suporta totalmente <a href="https://docs.opengeospatial.org/is/18-058r1/18-058r1.html">OGC API - Features - Part 2: Coordinate Reference Systems by Reference</a>.
Isto permite a importação e exportação de quaisquer dados de acordo com projeções dedicadas.
Uma "projeção" é especificada com um identificador de Sistema de Referência de Coordenadas (CRS). Estes estão em formatos URI
como <code>http://www.opengis.net/def/crs/OGC/1.3/CRS84</code> (basicamente WGS84 em ordem de eixo longitude, latitude)
ou o formato "OpenGIS" como <code>http://www.opengis.net/def/crs/EPSG/0/4258</code>. Note que o formato "EPSG:" como <code>EPSG:4326</code>
está fora do âmbito da norma OGC.</p>
<p>Em particular, o suporte CRS permite o seguinte:</p>
<ul>
<li>especificar o CRS no qual os dados são armazenados, na pygeoapi a opção de configuração <code>storageCRS</code> </li>
<li>especificar a lista de CRSs nos quais os dados de Funcionalidades podem ser recuperados, na pygeoapi a opção de configuração <code>crs</code></li>
<li>publicar estes CRSs nos metadados da coleção</li>
<li>o parâmetro de consulta <code>crs=</code> para uma coleção ou item de coleção</li>
<li>o parâmetro de consulta <code>bbox-crs=</code> para indicar que o parâmetro <code>bbox=</code> está codificado nesse CRS</li>
<li>o cabeçalho de resposta HTTP <code>Content-Crs</code> denota o CRS da(s) Funcionalidade(s) nos dados devolvidos</li>
</ul>
<p>Então, embora o GeoJSON exija WGS84 em ordem longitude, latitude, o cliente e servidor podem ainda assim concordar
com outros CRSs.</p>
<p>Por baixo, a pygeoapi usa o bem conhecido wrapper Python <a href="https://pyproj4.github.io/pyproj/stable">pyproj</a> para a biblioteca <a href="https://proj.org">PROJ</a>.</p>
<p>Leia mais na documentação da pygeoapi no <a href="https://docs.pygeoapi.io/en/latest/crs.html">Capítulo CRS</a>.</p>
<h1 id="pt-advanced-crs-exercicio">Exercício</h1>
<p>Adicionar suporte CRS às coleções pygeoapi para o tipo <code>provider</code> <code>feature</code> é tão simples como
por exemplo estender a configuração do <a href="#pt-publishing-ogcapi-features">Exercício 2</a> com este fragmento:</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nt">crs</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/4258</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/3857</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/4326</span>
<span class="w">  </span><span class="nt">storage_crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
</code></pre></div>
<div class="admonition ordem dos eixos">
<p class="admonition-title">Ordem</p>
<p>A ordem dos eixos (são coordenadas em ordem longitude, latitude ou latitude, longitude?) nas projeções é frequentemente uma fonte de confusão. 
No entanto, o formato URI é bastante claro sobre isto, pelo menos mais do que o formato <code>EPSG:</code>.
Então http://www.opengis.net/def/crs/OGC/1.3/CRS84 é ordem longitude, latitude, enquanto
http://www.opengis.net/def/crs/EPSG/0/4326 é ordem latitude, longitude.</p>
</div>
<p>Na configuração abaixo, indicamos basicamente que os dados são armazenados em WGS84 (ordem de eixo longitude, latitude) e podem ser recuperados
em CRSs como <code>http://www.opengis.net/def/crs/EPSG/0/4258</code> (ETRS89 ordem de eixo latitude, longitude) etc.</p>
<div class="admonition question">
<p class="admonition-title">Adicionar CRS a uma configuração pygeoapi</p>
<p>Abra o ficheiro de configuração da pygeoapi num editor de texto.
Encontre a linha <code># START - EXERCISE 2 - firenze-terrain</code></p>
<p>Atualize a secção do conjunto de dados com suporte CRS substituindo-a pelo fragmento abaixo:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">firenze-terrains-vec</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Limites administrativos antes de 2014</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Parcelas cadastrais (terrenos) do cadastro. Agência do Território; SIT e Redes de Informação;</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Parcelas cadastrais</span>
<span class="w">    </span><span class="nt">links</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">          </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">          </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Limites administrativos antes de 2014</span>
<span class="w">          </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://dati.cittametropolitana.fi.it/geonetwork/srv/metadata/cmfi:c539d359-4387-4f83-a6f4-cd546b3d8443</span>
<span class="w">          </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">it</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">11.23</span><span class="p p-Indicator">,</span><span class="nv">43.75</span><span class="p p-Indicator">,</span><span class="nv">11.28</span><span class="p p-Indicator">,</span><span class="nv">43.78</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SQLiteGPKG</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/firenze_terrains.gpkg</span><span class="w"> </span><span class="c1"># colocar caminho correto aqui</span>
<span class="w">          </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fid</span>
<span class="w">          </span><span class="nt">crs</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/4258</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/3857</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/4326</span>
<span class="w">          </span><span class="nt">storage_crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">          </span><span class="nt">title_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">codbo</span>
<span class="w">          </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">firenze_terrains</span>
</code></pre></div></td></tr></table></div>
</div>
<p>Agora vamos inspecionar os metadados da coleção e recuperar Funcionalidades em vários CRSs.
Podemos até fazer isto na interface Swagger, mas usar o navegador é bastante rápido e claro.</p>
<h2 id="pt-advanced-crs-metadados">Metadados</h2>
<div class="admonition question">
<p class="admonition-title">Metadados da Coleção</p>
<p>Abra o URL: 
<a href="http://localhost:5000/collections/firenze-terrains-vec">http://localhost:5000/collections/firenze-terrains-vec</a>
Os seus CRSs configurados são exibidos na parte inferior da página: "Reference Systems" e "Storage CRS".</p>
<p>Veja estes em formato JSON, também na parte inferior: 
<a href="http://localhost:5000/collections/firenze-terrains-vec?f=json">http://localhost:5000/collections/firenze-terrains-vec?f=json</a>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">&quot;crs&quot;:[</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;http://www.opengis.net/def/crs/OGC/1.3/CRS84&quot;,</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;http://www.opengis.net/def/crs/EPSG/0/4258&quot;,</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;http://www.opengis.net/def/crs/EPSG/0/3857&quot;,</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;http://www.opengis.net/def/crs/EPSG/0/4326&quot;</span>
<span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">],</span>
<span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">&quot;storageCRS&quot;:&quot;http://www.opengis.net/def/crs/OGC/1.3/CRS84&quot;</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">}</span>
</code></pre></div></p>
</div>
<h2 id="pt-advanced-crs-reprojetar-funcionalidades">Reprojetar Funcionalidades</h2>
<div class="admonition question">
<p class="admonition-title">Usar o parâmetro de consulta CRS</p>
<p>Abra o URL: 
<a href="http://localhost:5000/collections/firenze-terrains-vec/items?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/4258">http://localhost:5000/collections/firenze-terrains-vec/items?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/4258</a></p>
<p>Este é ETRS89, semelhante a WGS84, mas para o Continente Europeu (Datum) e em ordem lat,lon. Este é por exemplo usado no INSPIRE.</p>
<p>Veja estes em formato JSON, também na parte inferior:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;features&quot;</span><span class="p">:[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;geometry&quot;</span><span class="p">:{</span>
<span class="w">              </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;MultiPolygon&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;coordinates&quot;</span><span class="p">:[</span>
<span class="w">                  </span><span class="p">[</span>
<span class="w">                      </span><span class="p">[</span>
<span class="w">                          </span><span class="p">[</span>
<span class="w">                              </span><span class="mf">43.77805936835436</span><span class="p">,</span>
<span class="w">                              </span><span class="mf">11.23486287997071</span>
<span class="w">                          </span><span class="p">],</span>
<span class="w">                          </span><span class="p">[</span>
<span class="w">                              </span><span class="mf">43.77809089595012</span><span class="p">,</span>
<span class="w">                              </span><span class="mf">11.2348943159564</span>
<span class="w">                          </span><span class="p">],</span>
<span class="w">                          </span><span class="p">[</span>
<span class="w">                              </span><span class="mf">43.77810038978989</span><span class="p">,</span>
<span class="w">                              </span><span class="mf">11.23491359066035</span>
<span class="w">                          </span><span class="p">],</span>
<span class="w">                          </span><span class="p">[</span>
<span class="w">                              </span><span class="mf">43.77705757917591</span><span class="p">,</span>
<span class="w">                              </span><span class="mf">11.2368990806804</span>
<span class="w">                          </span><span class="p">],</span>
<span class="w">   </span><span class="err">.</span>
<span class="w">   </span><span class="err">.</span>
<span class="w">   </span><span class="nt">&quot;crs&quot;</span><span class="p">:[</span>
<span class="w">    </span><span class="s2">&quot;http://www.opengis.net/def/crs/OGC/1.3/CRS84&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;http://www.opengis.net/def/crs/EPSG/0/4258&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;http://www.opengis.net/def/crs/EPSG/0/3857&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;http://www.opengis.net/def/crs/EPSG/0/4326&quot;</span>
<span class="w">   </span><span class="p">],</span>
<span class="w">   </span><span class="nt">&quot;storageCRS&quot;</span><span class="p">:</span><span class="s2">&quot;http://www.opengis.net/def/crs/OGC/1.3/CRS84&quot;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>Se abrir a consola de desenvolvimento do navegador, pode observar o cabeçalho de resposta HTTP:</p>
<p><code>Content-Crs: &lt;http://www.opengis.net/def/crs/EPSG/0/4258&gt;</code></p>
<p>(O URI CRS está sempre entre <code>&lt;</code> <code>&gt;</code>)</p>
</div></section><section class="print-page" id="pt-advanced-ui-custom-templates" heading-number="6.4"><h1 id="pt-advanced-ui-custom-templates-personalizacao-de-ui-e-templating">Personalização de UI e templating</h1>
<p>A pygeoapi adotou o mecanismo de templating Jinja2 para estilizar a saída HTML. Cada elemento visualizado na saída HTML é
personalizável substituindo o template relevante. Os templates estão localizados na pasta <a href="https://github.com/geopython/pygeoapi/tree/master/pygeoapi/templates"><code>pygeoapi/templates</code></a>.
É possível substituir qualquer template copiando-o para uma pasta separada e ajustá-lo às suas necessidades. Na configuração da pygeoapi
pode então indicar o caminho para a pasta de substituição. Note que para ficheiros que não são colocados
na pasta de substituição, o ficheiro original é usado.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Para qualquer personalização, tenha em mente que com uma nova versão da pygeoapi as alterações nos templates padrão não estão automaticamente
disponíveis nos ficheiros substituídos. As atualizações precisam de ser cuidadosamente testadas e validadas.</p>
</div>
<h2 id="pt-advanced-ui-custom-templates-jinja2">Jinja2</h2>
<p><a href="https://jinja.palletsprojects.com">Jinja2</a> é um conceito de templating comum na comunidade Python. Com um conhecimento mínimo
de HTML será capaz de fazer personalizações menores mas significativas. No núcleo da configuração de template da pygeoapi está o
template <a href="https://github.com/geopython/pygeoapi/blob/master/pygeoapi/templates/_base.html"><code>_base.html</code></a>, que define o
cabeçalho e rodapé da página. O fragmento abaixo define o rodapé da página, note os parâmetros em chavetas,
que são substituídos por conteúdo dinâmico. </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code> <span class="p">&lt;</span><span class="nt">footer</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;sticky&quot;</span><span class="p">&gt;</span>
    {% trans %}Powered by {% endtrans %} 
    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">title</span><span class="o">=</span><span class="s">&quot;pygeoapi&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://pygeoapi.io&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;{{ config[&#39;server&#39;][&#39;url&#39;] }}/assets/images/pygeoapi.png&quot;</span> <span class="na">title</span><span class="o">=</span><span class="s">&quot;pygeoapi logo&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;height:24px;vertical-align: middle;&quot;</span><span class="p">/&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> 
    {{ version }}
<span class="p">&lt;/</span><span class="nt">footer</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<div class="admonition help">
<p class="admonition-title">Personalizar uma página HTML</p>
<p>Copie <code>_base.html</code> para uma pasta separada. Ajuste alguns elementos nessa página (por exemplo, imagem do logótipo). Depois, inclua uma referência à nova pasta na
configuração da pygeoapi. Reinicie o serviço. Verifique o resultado.</p>
</div>
<h2 id="pt-advanced-ui-custom-templates-personalizacoes-css">Personalizações CSS</h2>
<p>A partir do template HTML personalizado pode referenciar um novo ficheiro de folha de estilo com personalizações ou adicionar diretamente as suas personalizações ao <a href="https://github.com/geopython/pygeoapi/blob/master/pygeoapi/static/css/default.css">/static/css/default.css</a>.</p>
<h1 id="pt-advanced-ui-custom-templates-resumo">Resumo</h1>
<p>Parabéns! Adicionou um aspeto e comportamento personalizados à sua implementação pygeoapi.</p></section><section class="print-page" id="pt-advanced-downstream-applications" heading-number="6.5"><h1 id="pt-advanced-downstream-applications-usar-a-pygeoapi-em-aplicacoes-downstream">Usar a pygeoapi em aplicações downstream</h1>
<p>Embora a pygeoapi seja tipicamente executada como uma aplicação autónoma, também foi projetada
para permitir uso direto através de aplicações Python externas em vários padrões
de design diferentes a múltiplos níveis. Da <a href="https://docs.pygeoapi.io/en/latest/how-pygeoapi-works.html">documentação oficial</a>, o diagrama abaixo
fornece uma visão geral de como a pygeoapi é projetada e arquitetada:</p>
<p><a href="https://docs.pygeoapi.io/en/latest/how-pygeoapi-works.html"><img alt="como a pygeoapi funciona" src="https://docs.pygeoapi.io/en/latest/_images/how-pygeoapi-works.png" /></a></p>
<p>Há duas formas principais de criar uma aplicação downstream:</p>
<ul>
<li>Usar a API principal</li>
<li>Estender através da interface web das frameworks suportadas out-of-the box</li>
</ul>
<h2 id="pt-advanced-downstream-applications-usar-a-api-principal-diretamente">Usar a API principal diretamente</h2>
<p>O ponto de entrada da API Python principal da pygeoapi é <code>pygeoapi.api.API</code>, que é inicializada com a configuração da pygeoapi
como um <code>dict</code> Python.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A API principal da pygeoapi permite ao programador gerir a configuração da pygeoapi de várias formas
(ficheiro em disco, armazenamento de objetos, baseado em base de dados, etc.)</p>
</div>
<p>A partir daqui, os objetos API fornecem várias funções, a maioria das quais requer um objeto <a href="https://docs.pygeoapi.io/en/latest/api-documentation.html#pygeoapi.api.APIRequest"><code>pygeoapi.api.APIRequest</code></a>
de acordo com a framework web. Exemplos incluem:</p>
<ul>
<li><a href="https://flask.palletsprojects.com/en/latest/api/#incoming-request-data">Flask</a></li>
<li><a href="https://www.starlette.io/requests">Starlette</a></li>
<li><a href="https://fastapi.tiangolo.com/advanced/using-request-directly">FastAPI</a></li>
<li><a href="https://docs.djangoproject.com/en/4.1/ref/request-response/#django.http.HttpRequest">Django</a></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consulte a <a href="https://docs.pygeoapi.io/en/latest/api-documentation.html#pygeoapi.api.APIRequest">documentação oficial</a>
para mais informações sobre <code>pygeoapi.api.APIRequest</code> (pode até usar o seu próprio objeto de pedido personalizado desde que
satisfaça os requisitos de interface de <code>pygeoapi.api.APIRequest</code>.</p>
</div>
<p>Vamos ver como seria uma integração API básica, usando Flask como exemplo:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">make_response</span><span class="p">,</span> <span class="n">request</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pygeoapi.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">API</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pygeoapi.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">yaml_load</span>

<span class="n">my_flask_app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;my-pygeoapi-config.yml&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
    <span class="n">my_pygeoapi_config</span> <span class="o">=</span> <span class="n">yaml_load</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>

<span class="n">my_pygeoapi_api</span> <span class="o">=</span> <span class="n">API</span><span class="p">(</span><span class="n">my_pygeoapi_config</span><span class="p">)</span>

<span class="nd">@my_flask_app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/my-landing-page-route&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_def</span><span class="p">():</span>

    <span class="n">headers</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">content</span> <span class="o">=</span> <span class="n">my_pygeoapi_api</span><span class="o">.</span><span class="n">landing_page</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">headers</span><span class="p">:</span> 
        <span class="n">response</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span>

    <span class="k">return</span> <span class="n">response</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consulte a <a href="https://docs.pygeoapi.io/en/latest/api-documentation.html#module-pygeoapi.api">documentação oficial</a>
para mais informações sobre a API Python principal</p>
</div>
<h2 id="pt-advanced-downstream-applications-estender-atraves-de-uma-framework-web">Estender através de uma framework web</h2>
<p>A pygeoapi pode ser instalada e usada ao nível do roteamento web como uma dependência no seu projeto. Esta é praticamente a forma mais fácil de aproveitar a flexibilidade e a modularidade da sua arquitetura.
Uma vez que as interfaces estejam disponíveis, então o programador pode usar a framework preferida para servir a aplicação frontend. Na prática
os seguintes módulos:</p>
<ul>
<li><code>pygeoapi.flask_app.py</code> para blueprints Flask</li>
<li><code>pygeoapi.starlette_app.py</code> para Starlette/FastAPI</li>
<li><code>pygeoapi.django_app.py</code> para Django (PR em curso <a href="https://github.com/geopython/pygeoapi/pull/630">PR</a>)</li>
</ul>
<p>Alguns exemplos estão disponíveis abaixo para programadores.</p>
<h3 id="pt-advanced-downstream-applications-exemplos">Exemplos</h3>
<h4 id="pt-advanced-downstream-applications-blueprints-flask">Blueprints Flask</h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pygeoapi.flask_app</span><span class="w"> </span><span class="kn">import</span> <span class="n">BLUEPRINT</span> <span class="k">as</span> <span class="n">pygeoapi_blueprint</span>

<span class="n">my_flask_app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">static_url_path</span><span class="o">=</span><span class="s1">&#39;/static&#39;</span><span class="p">)</span>
<span class="n">my_flask_app</span><span class="o">.</span><span class="n">url_map</span><span class="o">.</span><span class="n">strict_slashes</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># montar todos os endpoints da pygeoapi em /oapi</span>
<span class="n">my_flask_app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">pygeoapi_blueprint</span><span class="p">,</span> <span class="n">url_prefix</span><span class="o">=</span><span class="s1">&#39;/oapi&#39;</span><span class="p">)</span>


<span class="nd">@my_flask_app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">home</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;p&gt;home page&lt;/p&gt;&#39;</span>
</code></pre></div>
<h4 id="pt-advanced-downstream-applications-starlette-e-fastapi">Starlette e FastAPI</h4>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">uvicorn</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fastapi</span><span class="w"> </span><span class="kn">import</span> <span class="n">FastAPI</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fastapi.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">RequestValidationError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">starlette.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTTPException</span> <span class="k">as</span> <span class="n">StarletteHTTPException</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">starlette.middleware.cors</span><span class="w"> </span><span class="kn">import</span> <span class="n">CORSMiddleware</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pygeoapi.starlette_app</span><span class="w"> </span><span class="kn">import</span> <span class="n">app</span> <span class="k">as</span> <span class="n">pygeoapi_app</span>


<span class="k">def</span><span class="w"> </span><span class="nf">create_app</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">FastAPI</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gerir criação da aplicação.&quot;&quot;&quot;</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;my_pygeoapi&quot;</span><span class="p">,</span> <span class="n">root_path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Definir todas as origens CORS habilitadas</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_middleware</span><span class="p">(</span>
        <span class="n">CORSMiddleware</span><span class="p">,</span>
        <span class="n">allow_origins</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
        <span class="n">allow_credentials</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">allow_methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
        <span class="n">allow_headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="nd">@app</span><span class="o">.</span><span class="n">exception_handler</span><span class="p">(</span><span class="n">StarletteHTTPException</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">custom_http_exception_handler</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">http_exception_handler</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

    <span class="nd">@app</span><span class="o">.</span><span class="n">exception_handler</span><span class="p">(</span><span class="n">RequestValidationError</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">custom_validation_exception_handler</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">request_validation_exception_handler</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

    <span class="c1"># montar todos os endpoints da pygeoapi em /oapi</span>
    <span class="n">app</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/oapi&quot;</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="n">pygeoapi_app</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">app</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">uvicorn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</code></pre></div></section><section class="print-page" id="pt-advanced-seo" heading-number="6.6"><h1 id="pt-advanced-seo-otimizacao-para-motores-de-busca-seo">Otimização para Motores de Busca (SEO)</h1>
<p>A OGC API - Features adotou a <a href="https://www.w3.org/TR/sdw-bp/#indexable-by-search-engines">Boa Prática 2 de Dados Espaciais na Web: Tornar os seus dados espaciais indexáveis por motores de busca</a> com a recomendação de <a href="http://docs.ogc.org/is/17-069r3/17-069r3.html#_requirements_class_html">incluir HTML como formato de saída de qualquer OGC API</a>. Isto significa que os utilizadores podem navegar numa OGC API a partir do seu navegador e os Motores de Busca conseguem rastrear o conteúdo.</p>
<p>Um aspeto a considerar é que, uma vez que a API se torna uma página web, as práticas comuns para arquitetura web e desenvolvimento tornam-se relevantes:</p>
<ul>
<li>o website tem uma navegação clara?</li>
<li>está incluído um logótipo da empresa, marca, declaração de privacidade, aviso de cookies?</li>
<li>a página web é <a href="https://www.w3.org/TR/WCAG21">WCAG</a> acessível?</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Note que a configuração da pygeoapi também tem uma opção para desativar a saída HTML. Nesse cenário, apenas a saída JSON está disponível.</p>
</div>
<p>Na Web, os websites são tipicamente visitados por <a href="https://en.wikipedia.org/wiki/Web_crawler">web crawlers</a> de motores de busca populares. Os crawlers
são processos automatizados que ajudam a construir o índice do motor de busca. Os crawlers seguem ligações na Web para identificar conteúdo novo ou atualizado
. A ligação cruzada da sua API a outros recursos aumenta portanto a visibilidade (e classificação) da sua API.</p>
<p>O British Geo6 escreveu uma extensa <a href="https://www.gov.uk/government/publications/search-engine-optimisation-for-publishers-best-practice-guide">boa prática sobre SEO para editores de dados</a> que oferece uma boa visão geral do SEO no âmbito das publicações de dados.</p>
<h2 id="pt-advanced-seo-ajustar-o-comportamento-dos-web-crawlers">Ajustar o comportamento dos Web Crawlers</h2>
<p>Este parágrafo apresenta alguns mecanismos que facilitam ou bloqueiam web crawlers de indexar o seu conteúdo.</p>
<p>Se não está interessado em ter o seu conteúdo indexado por motores de busca, pode fornecer um ficheiro <a href="https://en.wikipedia.org/wiki/Robots_exclusion_standard">robots.txt</a>
na raiz do seu website, especificando que pastas não devem ser indexadas. Mais drasticamente é a opção de bloquear o acesso para crawlers ou bots ao seu conteúdo
filtrando tráfego para o website baseado no cabeçalho HTTP <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent">User-Agent</a>. Tal regra pode
ser adicionada a uma configuração de firewall ou servidor web.</p>
<p>Um ficheiro <code>robots.txt</code> também pode incluir uma ligação para um <a href="https://en.wikipedia.org/wiki/Sitemaps">Sitemap</a>. Muitos motores de busca fornecem a opção de submeter um sitemap
para acelerar o rastreamento e indexação. A pygeoapi não fornece um sitemap do seu conteúdo, mas pode criar o seu próprio sitemap (publicar como <code>/sitemap.xml</code>),
especificando URLs do seu conteúdo desejado para ser indexado.</p>
<p>Os motores de busca fornecem ferramentas para avaliar o comportamento de pesquisa do seu website. Estas ferramentas podem fornecer informações valiosas sobre a capacidade de encontrar o seu website
e conteúdo (por exemplo, palavras-chave usadas para localizar o seu website).</p>
<h2 id="pt-advanced-seo-schemaorgdataset">Schema.org/Dataset</h2>
<p>Os motores de busca cooperam na iniciativa <a href="https://schema.org">Schema.org</a>. O Schema.org permite-lhe anotar o seu website usando o vocabulário <code>schema.org</code>,
para que os motores de busca indexem o conteúdo de forma estruturada. O Google foi o primeiro a empregar estas anotações para fornecer um <a href="https://datasetsearch.research.google.com/">motor de busca dedicado para conjuntos de dados</a>. A pygeoapi adiciona anotações <code>schema.org/Dataset</code> às páginas de coleção, para que as coleções sejam automaticamente incluídas na pesquisa de conjuntos de dados do Google.</p>
<div class="admonition question">
<p class="admonition-title">Avaliar as anotações schema.org em coleções</p>
<p>O Google fornece uma <a href="https://search.google.com/test/rich-results">ferramenta</a> para avaliar anotações <code>Schema.org</code> em websites. Tente avaliar um endpoint de coleção da pygeoapi
na ferramenta. Se executar a pygeoapi localmente (não acessível ao google), pode copiar o código fonte de uma página como HTML no separador <code>&lt;code&gt;</code>, caso contrário pode colar o URL da página no separador <code>URL</code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Uma ferramenta semelhante é disponibilizada pelo <a href="https://webmaster.yandex.com/tools/microtest">Yandex</a> (note que é necessário registo).</p>
</div></section><section class="print-page" id="pt-advanced-security-access-control" heading-number="6.7"><h1 id="pt-advanced-security-access-control-seguranca-e-controlo-de-acessos">Segurança e controlo de acessos</h1>
<h2 id="pt-advanced-security-access-control-visao-geral">Visão geral</h2>
<p>A segurança em geral é um tópico amplo e complexo, afetando todo o ciclo de vida de desenvolvimento.
É recomendado seguir as melhores práticas de segurança durante todas as fases de desenvolvimento como design, codificação e implementação.
Nesta workshop focaremos apenas na segurança de API e controlo de acessos, em vez da gama completa de tópicos de segurança de aplicações.</p>
<h2 id="pt-advanced-security-access-control-seguranca-de-api">Segurança de API</h2>
<p>A segurança de API é todo o processo para proteger APIs de ataques. É parte das diretrizes de segurança mais gerais que são tratadas no documento OWASP Top Ten. Portanto, essas recomendações ainda se aplicam.</p>
<div class="admonition note">
<p class="admonition-title">Segurança de Aplicações</p>
<p>O documento <a href="https://owasp.org/www-project-top-ten/">Top Ten</a> do Open Web Application Security Project (OWASP) é uma ferramenta muito boa para garantir o mínimo contra os riscos de segurança e gerir ameaças críticas que mais provavelmente afetam o seu código.</p>
</div>
<h2 id="pt-advanced-security-access-control-controlo-de-acessos">Controlo de acessos</h2>
<p>O controlo de acessos é outra parte fundamental do Open Web Application Security Project e aborda a Gestão de Identidade e Acesso (IAM) de uma API.
A IAM consiste em duas partes diferentes de um fluxo de segurança:</p>
<ul>
<li><em>Autenticação</em> (AuthN) verifica a identidade do utilizador para permitir ou negar acesso subsequente (ver próximo)</li>
<li><em>Autorização</em> (AuthZ) valida permissões de um utilizador (identidade) para aceder a um recurso. As permissões dessa identidade são verificadas contra as políticas de um recurso para (des)permitir acesso a, por exemplo, (partes de) uma API.</li>
</ul>
<p>Estas partes são geralmente geridas por infraestruturas e soluções dedicadas que geralmente fornecem a maioria dos requisitos de segurança out-of-the-box.</p>
<div class="admonition note">
<p class="admonition-title">Especificação de Segurança OpenAPI</p>
<p>A especificação OpenAPI tem elementos muito bem definidos para programadores e adotantes. Os mais relevantes são:</p>
<ul>
<li><a href="https://swagger.io/specification/#security-scheme-object">Security Scheme Object</a> define os esquemas de segurança que podem ser usados pelas operações. Os esquemas suportados são <em>Autenticação HTTP</em>, uma <em>Chave API</em>, fluxos <em>OAuth2</em> e <em>OpenID Connect</em>.</li>
<li><a href="https://swagger.io/specification/#security-requirement-object">Security Requirement Object</a> define a lista de esquemas de segurança necessários para executar uma operação.</li>
</ul>
</div>
<h2 id="pt-advanced-security-access-control-consideracoes-da-pygeoapi">Considerações da pygeoapi</h2>
<p>A pygeoapi ainda não suporta elementos de segurança OpenAPI. A implementação futura poderia incluir geração do documento OpenAPI da pygeoapi com uma configuração de segurança, ou gerar a partir de uma aplicação/solução de controlo de acessos conhecida (como <a href="https://github.com/geobeyond/fastgeoapi">fastgeoapi</a> ou <a href="https://github.com/cartologic/pygeoapi-auth">pygeoapi-auth</a>).</p>
<p>A implementação direta de controlo de acessos não está no âmbito da pygeoapi. A abordagem desejada aqui seria aproveitar uma solução existente e definir/integrar os endpoints seguros de acordo. Por exemplo, fastgeoapi ou pygeoapi-auth poderiam ser implementados downstream da pygeoapi, e governar o acesso a endpoints específicos (coleções, itens, etc.).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <a href="https://docs.pygeoapi.io/en/latest/security.html">documentação oficial da pygeoapi</a> fornece o estado oficial do projeto sobre atualizações de implementação de segurança, e deve ser visitada para se manter atualizado com o estado mais recente da implementação de segurança no projeto.</p>
</div></section><section class="print-page" id="pt-advanced-semantic-web-linked-data" heading-number="6.8"><h1 id="pt-advanced-semantic-web-linked-data-web-semantica-e-linked-data">Web Semântica e Linked Data</h1>
<p>Esta secção aborda 3 aspetos da Web Semântica:</p>
<ul>
<li><a href="#pt-advanced-semantic-web-linked-data-motores-de-busca">Motores de busca</a></li>
<li><a href="#pt-advanced-semantic-web-linked-data-publicar-dados-espaciais-na-web-semântica">Publicar dados espaciais na web semântica</a></li>
<li><a href="#pt-advanced-semantic-web-linked-data-proxy-para-a-web-semântica">Proxy para a web semântica</a></li>
</ul>
<h2 id="pt-advanced-semantic-web-linked-data-motores-de-busca">Motores de busca</h2>
<p>Os motores de busca usam tecnologia semelhante à Web Semântica para facilitar a captura de dados estruturados (também conhecidos como rich snippets) de páginas web.
A pygeoapi suporta este caso de uso através da incorporação de um snippet JSON-LD <code>schema.org</code> na codificação HTML,</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A ontologia <code>schema.org</code> não é uma ontologia formal da Web Semântica, estando portanto um pouco desconectada do resto da Web Semântica</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Consulte mais informações em <a href="#pt-advanced-seo">Otimização para Motores de Busca</a></p>
</div>
<h2 id="pt-advanced-semantic-web-linked-data-publicar-dados-espaciais-na-web-semantica">Publicar dados espaciais na Web Semântica</h2>
<p>A OGC API - Common adotou várias convenções W3C, que aproximam as OGC APIs das normas da Web Semântica,
comparado com as normas de primeira geração dos Serviços Web OGC (OWS).</p>
<p>Atualmente, a pygeoapi não pretende ser uma implementação completa da Web Semântica, no entanto é possível anunciar
alguns aspetos da Web Semântica para que os dados possam ser percorridos por clientes conscientes da Web Semântica.</p>
<div class="admonition question">
<p class="admonition-title">Usar um cliente SPARQL para consultar a pygeoapi</p>
<p><a href="https://en.wikipedia.org/wiki/SPARQL">SPARQL</a> é comummente conhecido como a linguagem de consulta para consultar triple stores. 
No entanto, também pode usar SPARQL para consultar grafos de recursos web ligados. O cliente SPARQL percorre ligações entre 
os recursos para localizar os triples solicitados. <a href="https://jena.apache.org/documentation/query/">Jena ARQ</a> é um cliente 
SPARQL de linha de comandos que consegue executar tais consultas. O Jena é bastante difícil de configurar, embora haja uma 
<a href="https://hub.docker.com/r/stain/jena">imagem Docker</a> disponível. Como alternativa, usaremos uma implementação web 
do motor ARQ. Navegue para <a href="https://demos.isl.ics.forth.gr/sparql-ld-endpoint/">https://demos.isl.ics.forth.gr/sparql-ld-endpoint</a>
e substitua a consulta na caixa de texto por:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="err">{</span><span class="w"> </span>
<span class="w">  </span><span class="n">SERVICE</span><span class="w"> </span><span class="o">&lt;</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">demo</span><span class="p">.</span><span class="n">pygeoapi</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">collections</span><span class="o">/</span><span class="n">lakes</span><span class="o">&gt;</span><span class="w"> </span><span class="err">{</span><span class="w"> </span>
<span class="w">    </span><span class="err">{</span><span class="w"> </span>
<span class="w">    </span><span class="o">?</span><span class="n">s</span><span class="w"> </span><span class="o">?</span><span class="n">p</span><span class="w"> </span><span class="o">?</span><span class="n">o</span><span class="w">  </span>
<span class="w">    </span><span class="err">}</span><span class="w"> </span>
<span class="w">  </span><span class="err">}</span><span class="w"> </span>
<span class="err">}</span>
</code></pre></div></td></tr></table></div>
<p>Uma consulta a um item retorna o item com a sua geometria:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="err">{</span><span class="w"> </span>
<span class="w">  </span><span class="n">SERVICE</span><span class="w"> </span><span class="o">&lt;</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">demo</span><span class="p">.</span><span class="n">pygeoapi</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">collections</span><span class="o">/</span><span class="n">lakes</span><span class="o">/</span><span class="n">items</span><span class="o">/</span><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="err">{{</span><span class="w"> </span><span class="o">?</span><span class="n">s</span><span class="w"> </span><span class="o">?</span><span class="n">p</span><span class="w"> </span><span class="o">?</span><span class="n">o</span><span class="w"> </span><span class="err">}}</span>
<span class="w">  </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div></td></tr></table></div>
<p>Note que o cliente SPARQL falha se codificar diretamente o formato HTML. </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="err">{</span><span class="w"> </span>
<span class="w">  </span><span class="n">SERVICE</span><span class="w"> </span><span class="o">&lt;</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">demo</span><span class="p">.</span><span class="n">pygeoapi</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">collections</span><span class="o">/</span><span class="n">lakes</span><span class="o">?</span><span class="n">f</span><span class="o">=</span><span class="n">html</span><span class="o">&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="err">{</span><span class="w"> </span><span class="o">?</span><span class="n">s</span><span class="w"> </span><span class="o">?</span><span class="n">p</span><span class="w"> </span><span class="o">?</span><span class="n">o</span><span class="w"> </span><span class="err">}</span>
<span class="w">  </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div></td></tr></table></div>
<p>O JSON-LD conforme esperado pelos motores de busca tem alguns desafios para as ferramentas da web semântica. Então como funciona se o formato não for codificado diretamente? 
O motor SPARQL <strong>negocia</strong> com o endpoint para avaliar que codificações (RDF) estão disponíveis, e baseado na negociação de conteúdo 
solicita a codificação <code>JSON_LD</code> via <code>f=jsonld</code>.</p>
</div>
<p>A pygeoapi adotou convenções da comunidade <a href="https://json-ld.org">JSON-LD</a> para anotar JSON como RDF. Para funcionalidades, cada propriedade (coluna numa tabela fonte) 
é anotada por um conceito semântico. A configuração relacionada para aplicar as anotações é gerida no elemento de contexto de uma definição de recurso</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Leia mais na <a href="https://docs.pygeoapi.io/configuration#Linked_data">documentação da pygeoapi</a>.</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">context</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">schema</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://schema.org/</span>
<span class="w">    </span><span class="nt">stn_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">schema:identifer</span>
<span class="w">    </span><span class="nt">datetime</span><span class="p">:</span>
<span class="w">        </span><span class="s">&quot;@id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">schema:observationDate</span>
<span class="w">        </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">schema:DateTime</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">        </span><span class="s">&quot;@id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">schema:value</span>
<span class="w">        </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">schema:Number</span>
</code></pre></div></td></tr></table></div>
<h2 id="pt-advanced-semantic-web-linked-data-proxy-para-a-web-semantica">Proxy para a Web Semântica</h2>
<p>Os engenheiros de dados espaciais são geralmente desafiados quando importam e visualizam fragmentos da web semântica. O número de 
<a href="https://plugins.qgis.org/plugins/sparqlunicorn">clientes espaciais que atualmente suportam interação SPARQL</a> é limitado e requer conhecimento especializado para usar. 
Um grupo dentro da comunidade da pygeoapi pretende facilitar o acesso à web semântica para engenheiros de dados espaciais introduzindo a pygeoapi como uma proxy 
entre os clientes GIS típicos e a web semântica.</p>
<p>Uma <a href="https://github.com/geopython/pygeoapi/pull/615">nova funcionalidade</a> está a ser preparada que introduz um fornecedor SPARQL na pygeoapi. 
O fornecedor permite navegar pelos resultados de uma consulta SPARQL como uma coleção OGC API - Features.</p>
<h1 id="pt-advanced-semantic-web-linked-data-resumo">Resumo</h1>
<p>Parabéns! Agora pode configurar configurações da pygeoapi com conceitos de linked data.</p></section><section class="print-page" id="pt-advanced-cloud" heading-number="6.9"><h1 id="pt-advanced-cloud-implementacao-na-cloud">Implementação na cloud</h1>
<p>A implementação em infraestruturas cloud e conceitos como Microsserviços e <a href="https://12factor.net">Twelve-Factor</a> apresentam requisitos específicos para
como o software é projetado e implementado. A pygeoapi suporta estes conceitos, tendo uma pegada baixa em CPU e memória, e não persiste estado
do utilizador, sendo portanto capaz de escalar sem riscos.</p>
<h2 id="pt-advanced-cloud-pygeoapi-e-docker">pygeoapi e Docker</h2>
<p>Uma <a href="https://hub.docker.com/r/geopython/pygeoapi">imagem Docker</a> está disponível para a pygeoapi. Pode executar a imagem localmente como:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="pt-advanced-cloud-__tabbed_1_1" name="pt-advanced-cloud-__tabbed_1" type="radio" /><input id="pt-advanced-cloud-__tabbed_1_2" name="pt-advanced-cloud-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="pt-advanced-cloud-__tabbed_1_1">Linux/Mac</label><label for="pt-advanced-cloud-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
</div>
</div>
<div class="admonition question">
<p class="admonition-title">Rever o Dockerfile da pygeoapi</p>
<p>Note no <a href="https://github.com/geopython/pygeoapi/Dockerfile">Dockerfile da pygeoapi</a> como o ficheiro open api é gerado como parte do script de arranque do Docker. </p>
</div>
<p>Numa configuração típica, substituir-se-ia o ficheiro de configuração padrão da pygeoapi na imagem por um personalizado e incluir a pasta de dados:</p>
<div class="admonition example">
<p class="admonition-title">usar configuração personalizada</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="pt-advanced-cloud-__tabbed_2_1" name="pt-advanced-cloud-__tabbed_2" type="radio" /><input id="pt-advanced-cloud-__tabbed_2_2" name="pt-advanced-cloud-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="pt-advanced-cloud-__tabbed_2_1">Linux/Mac</label><label for="pt-advanced-cloud-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span><span class="se">\ </span>
-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/pygeoapi-config.yml:/pygeoapi/local.config.yml<span class="w"> </span><span class="se">\</span>
-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/geodata:/geodata<span class="w"> </span>https://hub.docker.com/r/geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/pygeoapi-config.yml:/pygeoapi/local.config.yml<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/geodata:/geodata<span class="w"> </span>https://hub.docker.com/r/geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<p>Alternativamente, pode construir uma nova imagem Docker incluindo tanto a configuração como os dados para o serviço. </p>
<div class="highlight"><pre><span></span><code>FROM geopython/pygeoapi:latest
COPY ./my.config.yml /pygeoapi/local.config.yml
</code></pre></div>
<p>Pode ter notado que o ficheiro de configuração da pygeoapi inclui uma referência ao endpoint no qual a pygeoapi é publicada. Esta configuração deve
corresponder ao endpoint público do serviço (domínio, caminho e porta).</p>
<p>Por defeito, a imagem Docker da pygeoapi executará a partir do caminho raiz <code>/</code>. Se precisar de executar a partir de um sub-caminho e ter todos os URLs internos corretos pode
definir a variável de ambiente <code>SCRIPT_NAME</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="pt-advanced-cloud-__tabbed_3_1" name="pt-advanced-cloud-__tabbed_3" type="radio" /><input id="pt-advanced-cloud-__tabbed_3_2" name="pt-advanced-cloud-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="pt-advanced-cloud-__tabbed_3_1">Linux/Mac</label><label for="pt-advanced-cloud-__tabbed_3_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>-e<span class="w"> </span><span class="nv">SCRIPT_NAME</span><span class="o">=</span><span class="s1">&#39;/mypygeoapi&#39;</span><span class="w"> </span><span class="se">\</span>
-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/my.config.yml:/pygeoapi/local.config.yml<span class="w"> </span>-it<span class="w"> </span>geopython/pygeoapi
<span class="c1"># navegue para http://localhost:5000/mypygeoapi</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>-e<span class="w"> </span><span class="nv">SCRIPT_NAME</span><span class="o">=</span><span class="s1">&#39;/mypygeoapi&#39;</span><span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/my.config.yml:/pygeoapi/local.config.yml<span class="w"> </span>-it<span class="w"> </span>geopython/pygeoapi
<span class="c1"># navegue para http://localhost:5000/mypygeoapi</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
<h1 id="pt-advanced-cloud-resumo">Resumo</h1>
<p>Parabéns! Agora pode implementar a pygeoapi como um serviço cloud native.</p></section><section class="print-page" id="pt-advanced-inspire" heading-number="6.10"><h1 id="pt-advanced-inspire-suporte-inspire">Suporte INSPIRE</h1>
<p><a href="https://inspire.ec.europa.eu">INSPIRE</a> é uma diretiva europeia sobre partilha de dados no domínio ambiental. Os estados membros da UE 
investiram quase 20 anos de esforço para harmonizar dados no domínio ambiental e publicá-los usando normas OGC. 
A diretiva está no final do seu tempo de vida, mas a expectativa é que as convenções da diretiva INSPIRE sejam adotadas 
por diretivas futuras, como as diretivas do pacto verde e dados abertos. </p>
<p>Nos últimos 20 anos, o panorama das TI mudou consideravelmente. O INSPIRE acompanhou estes desenvolvimentos adotando uma 
série de <a href="https://inspire.ec.europa.eu/portfolio/good-practice-library">Boas Práticas</a> que substituem as 
<a href="https://inspire.ec.europa.eu/Technical-guidelines3">Diretrizes Técnicas</a> originais.</p>
<p>Algumas das boas práticas recentes e futuras focam-se nos desenvolvimentos no domínio OGC API. 
Uma boa prática já foi adotada sobre fornecer 
<a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features">serviços de descarregamento usando OGC API - Features</a> 
e outras estão em preparação, como o 
<a href="https://github.com/INSPIRE-MIF/gp-ogc-api-records">serviço de descoberta usando OGC API - Records</a>. 
Estes desenvolvimentos tornam a pygeoapi uma opção interessante 
para fornecer serviços INSPIRE.</p>
<h2 id="pt-advanced-inspire-servicos-inspire-e-a-sua-alternativa-ogc-api">Serviços INSPIRE e a sua alternativa OGC API</h2>
<p>Os serviços INSPIRE são tipicamente categorizados em serviços de visualização, serviços de descarregamento e serviços de descoberta. 
Os serviços de descarregamento são ainda divididos em fontes Vetoriais, fontes de Cobertura e fontes de Sensores.
A iniciativa OGC API fornece as APIs relacionadas para cada tipo de serviço.
A tabela abaixo destaca para cada tipo de serviço a recomendação das Diretrizes Técnicas
e as Boas Práticas relevantes. </p>
<table>
<thead>
<tr>
<th>Tipo de serviço</th>
<th>TG</th>
<th>OGC API</th>
<th>Estado da boa prática</th>
</tr>
</thead>
<tbody>
<tr>
<td>Serviço de descoberta</td>
<td>CSW</td>
<td>OGC API - Records</td>
<td><a href="https://github.com/INSPIRE-MIF/gp-ogc-api-records">Em preparação</a></td>
</tr>
<tr>
<td>Serviço de visualização</td>
<td>WM(T)S</td>
<td>OGC API - Maps / OGC API - Tiles</td>
<td>Não agendado<br> <a href="https://wikis.ec.europa.eu/display/InspireMIG/69th+MIG-T+meeting+2022-04-01">Em preparação</a></td>
</tr>
<tr>
<td>Serviço de descarregamento - Vetor</td>
<td>WFS</td>
<td>OGC API - Features</td>
<td><a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features">Adotada</a></td>
</tr>
<tr>
<td>Serviço de descarregamento - Cobertura</td>
<td>WCS</td>
<td>OGC API - Coverages / STAC <sup id="fnref:1"><a class="footnote-ref" href="#pt-advanced-inspire-fn:1">1</a></sup></td>
<td>Não agendado<br> <a href="https://github.com/INSPIRE-MIF/gp-stac">Em preparação</a></td>
</tr>
<tr>
<td>Serviço de descarregamento - Sensor</td>
<td>SOS</td>
<td>OGC API - EDR / Sensorthings API <sup id="fnref:2"><a class="footnote-ref" href="#pt-advanced-inspire-fn:2">2</a></sup></td>
<td>Não agendado<br> <a href="https://github.com/INSPIRE-MIF/gp-ogc-sensorthings-api">Adotada</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ao adotar Boas Práticas, considere que a documentação e ferramentas para validação ainda são limitadas. 
Além disso, o Portal Geo INSPIRE pode ainda não estar pronto para recolher registos de um endpoint OGC API - Records. </p>
</div>
<div class="admonition question">
<p class="admonition-title">Publicar documentos de metadados como um serviço de descoberta INSPIRE</p>
<p>Neste exercício vamos importar uma pasta de documentos de metadados para uma base de dados TinyDB e vamos configurar a base de dados como um endpoint OGC API - Records. 
Descarregue o ficheiro zip 'inspire-records.zip' do repositório. Extraia o ficheiro zip. A pasta <code>/tests</code> contém um script 
<a href="https://github.com/geopython/pygeoapi/blob/master/tests/load_tinydb_records.py">load_tinydb_records.py</a>. O script tem 2 parâmetros:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="pt-advanced-inspire-__tabbed_1_1" name="pt-advanced-inspire-__tabbed_1" type="radio" /><input id="pt-advanced-inspire-__tabbed_1_2" name="pt-advanced-inspire-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="pt-advanced-inspire-__tabbed_1_1">Linux/Mac</label><label for="pt-advanced-inspire-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>load_tinydb_records.py<span class="w"> </span>&lt;path/to/xml-files&gt;<span class="w"> </span>&lt;output.db&gt;
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>load_tinydb_records.py<span class="w"> </span>&lt;path/to/xml-files&gt;<span class="w"> </span>&lt;output.db&gt;
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Agora configure <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-records.html#tinydbcatalogue">TinyDB como fornecedor para OGC API - Records</a>. Reinicie o serviço e verifique o resultado. Verifique também a saída XML de alguns dos registos. </p>
</div>
<h2 id="pt-advanced-inspire-ogc-api-e-os-modelos-de-dados-inspire">OGC API e os modelos de dados INSPIRE</h2>
<p>A maioria dos modelos de dados INSPIRE tem uma estrutura hierárquica, que não é comum na comunidade OGC API orientada para GeoJSON. 
Em teoria é possível fornecer GML hierárquico a partir de um endpoint OGC API, mas ainda não há muitas experiências atualmente.
Duas iniciativas podem trazer melhorias a este aspeto:</p>
<ul>
<li>a pygeoapi facilita a configuração de uma codificação JSON-LD usando uma ontologia arbitrária. A 
<a href="https://inspire-eu-rdf.github.io/inspire-rdf-guidelines">boa prática sobre web semântica</a> fornece alguns dos modelos de dados
numa ontologia RDF</li>
<li>A <a href="https://github.com/INSPIRE-MIF/gp-geopackage-encodings">boa prática sobre codificações alternativas</a> sugere uma 
abordagem para publicar conjuntos de dados usando um modelo de dados relacional como GeoPackage, que se adequa melhor à comunidade OGC API</li>
</ul>
<h2 id="pt-advanced-inspire-ogc-api-como-um-registo-de-listas-de-codigos">OGC API como um registo de listas de códigos</h2>
<p>Um caso de uso típico no INSPIRE é a opção de estender uma lista de códigos INSPIRE para corresponder a um requisito local. Para este caso de uso, a 
lista de códigos estendida tem de ser publicada num registo. A OGC API - Common fornece mecanismos para publicar listas de conceitos como itens 
em coleções. A pygeoapi também fornece um mecanismo para anunciar os conceitos usando a ontologia SKOS através da sua codificação JSON-LD 
. Na coincidência de um conceito ter uma propriedade de geometria, a lista de códigos pode até ser publicada como OGC API - Features 
(num mapa).</p>
<div class="admonition question">
<p class="admonition-title">Publicar uma lista de códigos via OGC API</p>
<p>Uma lista de códigos de tipos de solo alemã foi disponibilizada em formato CSV em <code>workshop/exercises/data/bodenart.en.csv</code>. Use o <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-features.html#csv">fornecedor CSV</a> para publicar este conjunto de dados na pygeoapi. Que URL usaria para referenciar um conceito na lista publicada?</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">SoilTypes</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tipos de solo da Alemanha</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bodenarten auf Basis der Bodenkundlichen Kartieranleitung 5. Auflage (KA5)</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">soiltype</span>
<span class="w">    </span><span class="nt">links</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">          </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">          </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tipos de solo da Alemanha</span>
<span class="w">          </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://registry.gdi-de.org/codelist/de.bund.thuenen/bodenart</span>
<span class="w">          </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">de</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="nv">0</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CSV</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/bodenart.en.csv</span>
<span class="w">          </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Label</span>
<span class="w">          </span><span class="nt">geometry</span><span class="p">:</span>
<span class="w">              </span><span class="nt">x_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x</span>
<span class="w">              </span><span class="nt">y_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">y</span>
</code></pre></div></td></tr></table></div>
<h1 id="pt-advanced-inspire-resumo">Resumo</h1>
<p>Parabéns! Trabalhou com a pygeoapi para conformidade INSPIRE</p>
<div class="footnote">
<hr />
<ol>
<li id="pt-advanced-inspire-fn:1">
<p>A Sensorthings API não é uma norma OGC API e atualmente não é suportada pela pygeoapi. É listada aqui para completude&#160;<a class="footnote-backref" href="#pt-advanced-inspire-fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="pt-advanced-inspire-fn:2">
<p>STAC não é uma norma OGC API mas é suportada pela pygeoapi&#160;<a class="footnote-backref" href="#pt-advanced-inspire-fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><section class="print-page" id="pt-advanced-administration" heading-number="6.11"><h1 id="pt-advanced-administration-administracao">Administração</h1>
<h2 id="pt-advanced-administration-visao-geral">Visão geral</h2>
<p>A pygeoapi fornece uma API de administração (consulte a <a href="https://docs.pygeoapi.io/en/latest/admin-api.html">documentação</a> da pygeoapi para mais informações sobre como ativar, configurar e usar) em suporte à gestão da sua configuração. A API (não uma OGC API) é implementada como um serviço RESTful para ajudar a criar, atualizar, substituir ou eliminar vários elementos da configuração da pygeoapi. Uma UI simples apenas de leitura é implementada como parte da API de administração.</p>
<h2 id="pt-advanced-administration-interface-de-utilizador">Interface de utilizador</h2>
<p>Por design, a pygeoapi não fornece uma verdadeira interface de utilizador para administrar a configuração. Dado que a API de administração existe, algumas opções podem ser consideradas para desenvolver uma UI de administração:</p>
<ul>
<li>autónoma<ul>
<li>aplicação simples sem conectividade à API de administração da pygeoapi</li>
<li>construída a partir do <a href="https://github.com/geopython/pygeoapi/blob/master/pygeoapi/schemas/config/pygeoapi-config-0.x.yml">esquema</a> de configuração da pygeoapi</li>
<li>permite copiar uma configuração já existente da pygeoapi</li>
<li>permite gerar configuração da pygeoapi para copiar/colar numa implementação da pygeoapi</li>
<li>pode ser implementada em qualquer lugar (por exemplo, GitHub Pages)</li>
</ul>
</li>
<li>integrada<ul>
<li>aplicação conectada a uma implementação da pygeoapi</li>
<li>construída a partir do <a href="https://github.com/geopython/pygeoapi/blob/master/pygeoapi/schemas/config/pygeoapi-config-0.x.yml">esquema</a> de configuração da pygeoapi</li>
<li>lê/escreve uma configuração da pygeoapi em tempo real através da API de administração da pygeoapi (controlo de acesso)</li>
<li>implementada como parte de uma aplicação Docker Compose</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Tem a sua própria ideia para uma UI de administração da pygeoapi? Conecte-se com a <a href="https://pygeoapi.io/community">comunidade da pygeoapi</a> para discutir a sua ideia!</p>
</div></section><section class="print-page" id="pt-advanced-bridges" heading-number="6.12"><h1 id="pt-advanced-bridges-exercicio-9-pygeoapi-como-ponte-para-outros-servicos">Exercício 9 - pygeoapi como ponte para outros serviços</h1>
<p>Nesta secção vamos explorar como a pygeoapi pode ser usada como um interface para re-publicar serviços web com distintas interfaces. Estas pontes podem ajudar <a href="https://ogcapi-workshop.ogc.org/transition-and-migration">organizações a migrar de OWS para OGC API</a>.</p>
<h2 id="pt-advanced-bridges-publicar-wfs-como-ogc-api-features">Publicar WFS como OGC API - Features</h2>
<p>Um caso de uso importante para a pygeoapi é fornecer uma interface OGC API - Features sobre endpoints Web Feature Service (WFS) 
ou ESRI FeatureServer existentes. Neste cenário, diminui a barreira de acesso e aumenta a usabilidade de serviços existentes para 
uma audiência mais ampla. Vamos configurar uma API sobre um WFS existente (correndo nos servidores da cidade de Florença).</p>
<div class="admonition question">
<p class="admonition-title">Atualizar a configuração da pygeoapi</p>
<p>Abra a configuração da pygeoapi num editor de texto. 
Encontre a linha <code># START - EXERCISE 8 - WFS Proxy</code>.</p>
<p>Adicione uma nova secção de conjunto de dados descomentando as linhas até <code># END - EXERCISE 8 - WFS Proxy</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">suol_epicentri_storici</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Epicentros dos principais sismos históricos</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Localização dos epicentros dos principais sismos históricos no território da Cidade Metropolitana de Florença classificados por ano e intensidade</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sismos</span>
<span class="w">    </span><span class="nt">links</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/xml</span>
<span class="w">          </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">          </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Epicentros dos principais sismos históricos</span>
<span class="w">          </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://pubblicazioni.cittametropolitana.fi.it/geoserver/territorio/wfs?request=getCapabilities&amp;service=WFS&amp;version=2.0.0</span>
<span class="w">          </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">it</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">10.94</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">43.52</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">11.65</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">44.17</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OGR</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span>
<span class="w">              </span><span class="nt">source_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WFS</span>
<span class="w">              </span><span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WFS:http://pubblicazioni.cittametropolitana.fi.it/geoserver/territorio/wfs?</span>
<span class="w">              </span><span class="nt">source_capabilities</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">paging</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">              </span><span class="nt">source_options</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">OGR_WFS_LOAD_MULTIPLE_LAYER_DEFN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NO</span>
<span class="w">              </span><span class="nt">gdal_ogr_options</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">EMPTY_AS_NULL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NO</span>
<span class="w">                  </span><span class="nt">GDAL_CACHEMAX</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">64</span>
<span class="w">                  </span><span class="nt">CPL_DEBUG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NO</span>
<span class="w">          </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cpti_id</span>
<span class="w">          </span><span class="nt">crs</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/4258</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/3857</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/3003</span>
<span class="w">          </span><span class="nt">storage_crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/3003</span>
<span class="w">          </span><span class="nt">title_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d</span>
<span class="w">          </span><span class="nt">layer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">territorio:suol_epicentri_storici</span>
</code></pre></div></td></tr></table></div>
</div>
<p>Guarde o ficheiro e reinicie o Docker Compose. Navegue para <a href="http://localhost:5000/collections">http://localhost:5000/collections</a>
para avaliar se o novo conjunto de dados foi publicado.</p>
<p>Note estes importantes excertos de configuração sob <code>providers</code>:</p>
<ul>
<li>
<p>Usamos o <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-features.html#ogr">Fornecedor OGR</a> da pygeoapi. 
Este é o backend mais versátil da pygeoapi para suportar numerosos formatos. Usar a biblioteca GDAL/OGR (bindings Python) permite à pygeoapi conectar-se a <a href="https://gdal.org/drivers/vector">cerca de 80+ Formatos Vetoriais</a>.
Podíamos ter usado o Fornecedor <code>OGR</code> em vez do Fornecedor <code>SQLiteGPKG</code> acima no exercício <code>osm_places-vec</code> acima.</p>
</li>
<li>
<p><code>storage_crs</code> denota o CRS (Sistema de Referência de Coordenadas) no qual o conjunto de dados é armazenado (o padrão é CRS84, ou seja, 'longitude, latitude') </p>
</li>
<li><code>crs</code> é um array de CRSs que podem ser especificados para as Funcionalidades serem devolvidas (parâmetro <code>crs=</code>), ou para a sua bounding box (parâmetro <code>bbox-crs=</code>). O padrão também é CRS84.</li>
</ul>
<p>O suporte CRS permite efetivamente à pygeoapi <em>reprojetar</em> os dados do seu CRS de armazenamento (aqui EPSG:3003)
de acordo com <a href="https://docs.opengeospatial.org/is/18-058r1/18-058r1.html">OGC API - Features - Part 2: Coordinate Reference Systems by Reference</a>.
A secção Avançada desta workshop <a href="#pt-advanced-crs">elaborará o suporte CRS da pygeoapi</a>.</p>
<h2 id="pt-advanced-bridges-publicar-wms-como-ogc-api-maps">Publicar WMS como OGC API - Maps</h2>
<p>Podemos usar o provider/fornecedor WMSFacade da pygeoapi para publicar interfaces OGC Web Map Service (WMS) como OGC API - Maps.</p>
<p>Vamos configurar uma API sobre um WMS existente no Servidor de Demonstração MapServer:</p>
<p><a href="https://demo.mapserver.org/cgi-bin/msautotest">https://demo.mapserver.org/cgi-bin/msautotest</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sinta-se à vontade para usar um WMS à sua escolha!</p>
</div>
<div class="admonition question">
<p class="admonition-title">Atualizar a configuração da pygeoapi</p>
<p>Abra a configuração da pygeoapi num editor de texto. 
Encontre a linha <code>## START - EXERCISE 8 - WMS Proxy</code>.</p>
<p>Adicione uma nova secção de conjunto de dados descomentando as linhas até <code>## END - EXERCISE 8 - WMS Proxy</code>:</p>
<p>Certifique-se de manter a indentação YAML adequada.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">wms-facade-demo</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Demonstração WMS Facade</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Demonstração WMS Facade</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WMS facade</span>
<span class="w">    </span><span class="nt">links</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">          </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">          </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MapServer</span>
<span class="w">          </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://mapserver.org</span>
<span class="w">          </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-180</span><span class="p p-Indicator">,</span><span class="nv">-90</span><span class="p p-Indicator">,</span><span class="nv">180</span><span class="p p-Indicator">,</span><span class="nv">90</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">map</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WMSFacade</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://demo.mapserver.org/cgi-bin/msautotest</span>
<span class="w">          </span><span class="nt">options</span><span class="p">:</span>
<span class="w">              </span><span class="nt">layer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">world_latlong</span>
<span class="w">              </span><span class="nt">style</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">          </span><span class="nt">format</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">png</span>
<span class="w">              </span><span class="nt">mimetype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image/png</span>
</code></pre></div></td></tr></table></div>
</div>
<p>Execute os seguintes pedidos no seu navegador web:</p>
<ul>
<li>mapa padrão: <a href="http://localhost:5000/collections/wms-facade-demo/map?f=png">http://localhost:5000/collections/wms-facade-demo/map?f=png</a></li>
<li>largura/altura específicas: <a href="http://localhost:5000/collections/wms-facade-demo/map?f=png&amp;width=800&amp;height=600">http://localhost:5000/collections/wms-facade-demo/map?f=png&amp;width=800&amp;height=600</a></li>
<li>área de interesse específica (bbox do Canadá): <a href="http://localhost:5000/collections/wms-facade-demo/map?f=png&amp;width=800&amp;height=600&amp;bbox=-142,42,-52,84">http://localhost:5000/collections/wms-facade-demo/map?f=png&amp;width=800&amp;height=600&amp;bbox=-142,42,-52,84</a></li>
</ul>
<p><img alt="" src="../assets/images/maps-response.png" width="80%" /></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Experimente com os seus próprios valores de bbox e largura/altura!</p>
</div>
<h2 id="pt-advanced-bridges-publicar-csw-como-ogc-api-records">Publicar CSW como OGC API - Records</h2>
<p>Nesta secção veremos como publicar Catalogue Service for the Web (CSW) como OGC API - Records. Para isso, usaremos o serviço CSW <a href="https://demo.pycsw.org/cite/">pycsw OGC CITE demo</a>.</p>
<div class="admonition question">
<p class="admonition-title">Atualizar a configuração da pygeoapi</p>
<p>Abra a configuração da pygeoapi num editor de texto. 
Encontre a linha <code># START - EXERCISE 8 - CSW Proxy</code>.</p>
<p>Adicione uma nova secção de conjunto de dados descomentando as linhas até <code># END - EXERCISE 8 - CSW Proxy</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">cite_demo</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pycsw OGC CITE demo e Implementação de Referência</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pycsw é uma implementação de servidor OARec e OGC CSW escrita em Python. O pycsw implementa totalmente a OGC API - Records e a OpenGIS Catalogue Service Implementation Specification (Catalogue Service for the Web). O desenvolvimento inicial começou em 2010 (anunciado mais formalmente em 2011). O projeto é certificado OGC Compliant, e é uma Implementação de Referência OGC. Desde 2015, o pycsw é um Projeto OSGeo oficial. O pycsw permite a publicação e descoberta de metadados geoespaciais através de numerosas APIs (CSW 2/CSW 3, OpenSearch, OAI-PMH, SRU). Repositórios existentes de metadados geoespaciais também podem ser expostos, fornecendo um componente de metadados e catálogo baseado em normas de infraestruturas de dados espaciais. O pycsw é Open Source, lançado sob uma licença MIT, e executa em todas as principais plataformas (Windows, Linux, Mac OS X)</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ogc</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cite</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conformidade</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">interoperabilidade</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-180</span><span class="p p-Indicator">,</span><span class="nv">-90</span><span class="p p-Indicator">,</span><span class="nv">180</span><span class="p p-Indicator">,</span><span class="nv">90</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">record</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CSWFacade</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://demo.pycsw.org/cite/csw</span>
<span class="w">          </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">identifier</span>
<span class="w">          </span><span class="nt">time_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">datetime</span>
<span class="w">          </span><span class="nt">title_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">title</span>
</code></pre></div></td></tr></table></div>
</div>
<p>Pode explorar a coleção de catálogo com proxy usando estes endpoints:</p>
<ul>
<li>página de metadados da coleção: <a href="http://localhost:5000/collections/cite_demo">http://localhost:5000/collections/cite_demo</a></li>
<li>lista de registos: <a href="http://localhost:5000/collections/cite_demo/items">http://localhost:5000/collections/cite_demo/items</a></li>
<li>registo: <a href="http://localhost:5000/collections/cite_demo/items/urn:uuid:19887a8a-f6b0-4a63-ae56-7fba0e17801f">http://localhost:5000/collections/cite_demo/items/urn:uuid:19887a8a-f6b0-4a63-ae56-7fba0e17801f</a></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Lembre-se de que pode usar o cliente QGIS sugerido <a href="https://dive.pygeoapi.io/publishing/ogcapi-records/#client-access">aqui</a> para explorar esta API.</p>
</div>
<h2 id="pt-advanced-bridges-publicar-sensorthings-api-como-ogc-api-features">Publicar SensorThings API como OGC API - Features</h2>
<p>A <a href="https://ogcapi-workshop.ogc.org/api-deep-dive/sensorthings/">norma OGC SensorThings API</a> oferece interfaces RESTful para interconectar dispositivos IoT, dados, de forma aberta e unificada. Embora existam alguns clientes que suportam esta norma, há muito mais que suportam OGC API - Features.</p>
<p>A ponte SensorThings da pygeoapi permite fazer proxy das entidades SensorThings (por exemplo: <code>Thing</code> , <code>Sensor</code>, <code>DataStream</code>, <code>ObservedProperty</code> ) em coleções de funcionalidades.</p>
<p>Nesta secção veremos como Publicar um <code>Thing</code> da SensorThings API como uma coleção OGC API - Features, que pode então ser consumida por vários clientes, como <a href="#pt-publishing-ogcapi-features-client-access">os listados aqui</a></p>
<div class="admonition question">
<p class="admonition-title">Atualizar a configuração da pygeoapi</p>
<p>Abra a configuração da pygeoapi num editor de texto. 
Encontre a linha <code># START - EXERCISE 8 - SensorThings Proxy</code>.</p>
<p>Adicione uma nova secção de conjunto de dados descomentando as linhas até <code># END - EXERCISE 8 - SensorThings Proxy</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">toronto_bikes</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Toronto Bikes SensorThings</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">A localização geográfica com coordenadas para a estação de partilha de bicicletas de Toronto</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sedimentos</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-180</span><span class="p p-Indicator">,</span><span class="nv">-90</span><span class="p p-Indicator">,</span><span class="nv">180</span><span class="p p-Indicator">,</span><span class="nv">90</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SensorThings</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://toronto-bike-snapshot.sensorup.com/v1.0/</span>
<span class="w">          </span><span class="nt">entity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Things</span>
</code></pre></div></td></tr></table></div>
</div></section></section><section class="print-page" id="pt-conclusion" heading-number="7"><h1 id="pt-conclusion-conclusao">Conclusão</h1>
<p>Esperamos que esta workshop vos tenha proporcionado uma visão geral das muitas funcionalidades da pygeoapi. O objetivo do projeto é permitir a publicação de dados utilizando o conjunto de Standards OGC API de forma simples, flexível e com uma barreira baixa de entrada.</p>
<p><a href="https://pygeoapi.io"><img alt="pygeoapi logo" src="../assets/images/pygeoapi-logo.png" width="40%" /></a></p>
<p><a href="https://ogcapi.ogc.org"><img alt="OGC APIs banner" src="../assets/images/OGC_APIs_banner.jpg" width="40%" /></a></p>
<h1 id="pt-conclusion-foss4g-europe-2025">FOSS4G Europe 2025</h1>
<p>Para aqueles que estão a participar no <a href="https://2025.europe.foss4g.org">FOSS4G Europe 2025</a>:</p>
<ul>
<li>venham à apresentação sobre o <a href="https://talks.osgeo.org/foss4g-europe-2025/talk/EPWGP7">estado do projeto pygeoapi</a> na quarta-feira, 16 de julho às 17:45, na sala EL11 (Geosolutions)</li>
<li>ou às outras apresentações relacionadas com pygeoapi:</li>
<li>a equipa pygeoapi estará presente no <a href="https://2025.europe.foss4g.org/schedule/community-sprint/">Community Sprint</a> nos dias 19-20 de julho, no local da conferência, Faculdade de Humanidades e Ciências Sociais (edifício P)</li>
</ul>
<h1 id="pt-conclusion-contribuicoes">Contribuições</h1>
<p>Sugestões, melhorias e correções são sempre bem-vindas. Por favor, visitem a nossa página da <a href="https://pygeoapi.io/community">comunidade</a>
para mais informações sobre como entrar em contacto.</p>
<p>Obrigado pelo vosso interesse na pygeoapi!</p></section></div><style>.print-site-enumerate-headings #pt > h1:before { content: '1 ' }

                .print-site-enumerate-headings #pt h2:before { content: '1.' counter(counter-pt-2) ' ' }
                .print-site-enumerate-headings #pt h2 {  counter-reset: counter-pt-3 ;  counter-increment: counter-pt-2 }
            
                .print-site-enumerate-headings #pt h3:before { content: '1.' counter(counter-pt-2) '.' counter(counter-pt-3) ' ' }
                .print-site-enumerate-headings #pt h3 {  counter-increment: counter-pt-3 }
            
.print-site-enumerate-headings #pt-introduction > h1:before { content: '2 ' }

                .print-site-enumerate-headings #pt-introduction h2:before { content: '2.' counter(counter-pt-introduction-2) ' ' }
                .print-site-enumerate-headings #pt-introduction h2 {  counter-reset: counter-pt-introduction-3 ;  counter-increment: counter-pt-introduction-2 }
            
                .print-site-enumerate-headings #pt-introduction h3:before { content: '2.' counter(counter-pt-introduction-2) '.' counter(counter-pt-introduction-3) ' ' }
                .print-site-enumerate-headings #pt-introduction h3 {  counter-increment: counter-pt-introduction-3 }
            
.print-site-enumerate-headings #pt-setup > h1:before { content: '3 ' }

                .print-site-enumerate-headings #pt-setup h2:before { content: '3.' counter(counter-pt-setup-2) ' ' }
                .print-site-enumerate-headings #pt-setup h2 {  counter-reset: counter-pt-setup-3 ;  counter-increment: counter-pt-setup-2 }
            
                .print-site-enumerate-headings #pt-setup h3:before { content: '3.' counter(counter-pt-setup-2) '.' counter(counter-pt-setup-3) ' ' }
                .print-site-enumerate-headings #pt-setup h3 {  counter-increment: counter-pt-setup-3 }
            
.print-site-enumerate-headings #pt-standards > h1:before { content: '4 ' }

                .print-site-enumerate-headings #pt-standards h2:before { content: '4.' counter(counter-pt-standards-2) ' ' }
                .print-site-enumerate-headings #pt-standards h2 {  counter-reset: counter-pt-standards-3 ;  counter-increment: counter-pt-standards-2 }
            
                .print-site-enumerate-headings #pt-standards h3:before { content: '4.' counter(counter-pt-standards-2) '.' counter(counter-pt-standards-3) ' ' }
                .print-site-enumerate-headings #pt-standards h3 {  counter-increment: counter-pt-standards-3 }
            
.print-site-enumerate-headings #section-5 > h1:before { content: '5 ' }
.print-site-enumerate-headings #pt-publishing > h1:before { content: '5.1 ' }

                .print-site-enumerate-headings #pt-publishing h2:before { content: '5.1.' counter(counter-pt-publishing-2) ' ' }
                .print-site-enumerate-headings #pt-publishing h2 {  counter-increment: counter-pt-publishing-2 }
            
.print-site-enumerate-headings #pt-publishing-first > h1:before { content: '5.2 ' }

                .print-site-enumerate-headings #pt-publishing-first h2:before { content: '5.2.' counter(counter-pt-publishing-first-2) ' ' }
                .print-site-enumerate-headings #pt-publishing-first h2 {  counter-increment: counter-pt-publishing-first-2 }
            
.print-site-enumerate-headings #pt-publishing-ogcapi-features > h1:before { content: '5.3 ' }

                .print-site-enumerate-headings #pt-publishing-ogcapi-features h2:before { content: '5.3.' counter(counter-pt-publishing-ogcapi-features-2) ' ' }
                .print-site-enumerate-headings #pt-publishing-ogcapi-features h2 {  counter-increment: counter-pt-publishing-ogcapi-features-2 }
            
.print-site-enumerate-headings #pt-publishing-ogcapi-coverages > h1:before { content: '5.4 ' }

                .print-site-enumerate-headings #pt-publishing-ogcapi-coverages h2:before { content: '5.4.' counter(counter-pt-publishing-ogcapi-coverages-2) ' ' }
                .print-site-enumerate-headings #pt-publishing-ogcapi-coverages h2 {  counter-increment: counter-pt-publishing-ogcapi-coverages-2 }
            
.print-site-enumerate-headings #pt-publishing-ogcapi-maps > h1:before { content: '5.5 ' }

                .print-site-enumerate-headings #pt-publishing-ogcapi-maps h2:before { content: '5.5.' counter(counter-pt-publishing-ogcapi-maps-2) ' ' }
                .print-site-enumerate-headings #pt-publishing-ogcapi-maps h2 {  counter-increment: counter-pt-publishing-ogcapi-maps-2 }
            
.print-site-enumerate-headings #pt-publishing-ogcapi-tiles > h1:before { content: '5.6 ' }

                .print-site-enumerate-headings #pt-publishing-ogcapi-tiles h2:before { content: '5.6.' counter(counter-pt-publishing-ogcapi-tiles-2) ' ' }
                .print-site-enumerate-headings #pt-publishing-ogcapi-tiles h2 {  counter-increment: counter-pt-publishing-ogcapi-tiles-2 }
            
.print-site-enumerate-headings #pt-publishing-ogcapi-records > h1:before { content: '5.7 ' }

                .print-site-enumerate-headings #pt-publishing-ogcapi-records h2:before { content: '5.7.' counter(counter-pt-publishing-ogcapi-records-2) ' ' }
                .print-site-enumerate-headings #pt-publishing-ogcapi-records h2 {  counter-increment: counter-pt-publishing-ogcapi-records-2 }
            
.print-site-enumerate-headings #pt-publishing-ogcapi-edr > h1:before { content: '5.8 ' }

                .print-site-enumerate-headings #pt-publishing-ogcapi-edr h2:before { content: '5.8.' counter(counter-pt-publishing-ogcapi-edr-2) ' ' }
                .print-site-enumerate-headings #pt-publishing-ogcapi-edr h2 {  counter-increment: counter-pt-publishing-ogcapi-edr-2 }
            
.print-site-enumerate-headings #pt-publishing-ogcapi-processes > h1:before { content: '5.9 ' }

                .print-site-enumerate-headings #pt-publishing-ogcapi-processes h2:before { content: '5.9.' counter(counter-pt-publishing-ogcapi-processes-2) ' ' }
                .print-site-enumerate-headings #pt-publishing-ogcapi-processes h2 {  counter-increment: counter-pt-publishing-ogcapi-processes-2 }
            
.print-site-enumerate-headings #section-6 > h1:before { content: '6 ' }
.print-site-enumerate-headings #pt-advanced > h1:before { content: '6.1 ' }

                .print-site-enumerate-headings #pt-advanced h2:before { content: '6.1.' counter(counter-pt-advanced-2) ' ' }
                .print-site-enumerate-headings #pt-advanced h2 {  counter-increment: counter-pt-advanced-2 }
            
.print-site-enumerate-headings #pt-advanced-i18n > h1:before { content: '6.2 ' }

                .print-site-enumerate-headings #pt-advanced-i18n h2:before { content: '6.2.' counter(counter-pt-advanced-i18n-2) ' ' }
                .print-site-enumerate-headings #pt-advanced-i18n h2 {  counter-increment: counter-pt-advanced-i18n-2 }
            
.print-site-enumerate-headings #pt-advanced-crs > h1:before { content: '6.3 ' }

                .print-site-enumerate-headings #pt-advanced-crs h2:before { content: '6.3.' counter(counter-pt-advanced-crs-2) ' ' }
                .print-site-enumerate-headings #pt-advanced-crs h2 {  counter-increment: counter-pt-advanced-crs-2 }
            
.print-site-enumerate-headings #pt-advanced-ui-custom-templates > h1:before { content: '6.4 ' }

                .print-site-enumerate-headings #pt-advanced-ui-custom-templates h2:before { content: '6.4.' counter(counter-pt-advanced-ui-custom-templates-2) ' ' }
                .print-site-enumerate-headings #pt-advanced-ui-custom-templates h2 {  counter-increment: counter-pt-advanced-ui-custom-templates-2 }
            
.print-site-enumerate-headings #pt-advanced-downstream-applications > h1:before { content: '6.5 ' }

                .print-site-enumerate-headings #pt-advanced-downstream-applications h2:before { content: '6.5.' counter(counter-pt-advanced-downstream-applications-2) ' ' }
                .print-site-enumerate-headings #pt-advanced-downstream-applications h2 {  counter-increment: counter-pt-advanced-downstream-applications-2 }
            
.print-site-enumerate-headings #pt-advanced-seo > h1:before { content: '6.6 ' }

                .print-site-enumerate-headings #pt-advanced-seo h2:before { content: '6.6.' counter(counter-pt-advanced-seo-2) ' ' }
                .print-site-enumerate-headings #pt-advanced-seo h2 {  counter-increment: counter-pt-advanced-seo-2 }
            
.print-site-enumerate-headings #pt-advanced-security-access-control > h1:before { content: '6.7 ' }

                .print-site-enumerate-headings #pt-advanced-security-access-control h2:before { content: '6.7.' counter(counter-pt-advanced-security-access-control-2) ' ' }
                .print-site-enumerate-headings #pt-advanced-security-access-control h2 {  counter-increment: counter-pt-advanced-security-access-control-2 }
            
.print-site-enumerate-headings #pt-advanced-semantic-web-linked-data > h1:before { content: '6.8 ' }

                .print-site-enumerate-headings #pt-advanced-semantic-web-linked-data h2:before { content: '6.8.' counter(counter-pt-advanced-semantic-web-linked-data-2) ' ' }
                .print-site-enumerate-headings #pt-advanced-semantic-web-linked-data h2 {  counter-increment: counter-pt-advanced-semantic-web-linked-data-2 }
            
.print-site-enumerate-headings #pt-advanced-cloud > h1:before { content: '6.9 ' }

                .print-site-enumerate-headings #pt-advanced-cloud h2:before { content: '6.9.' counter(counter-pt-advanced-cloud-2) ' ' }
                .print-site-enumerate-headings #pt-advanced-cloud h2 {  counter-increment: counter-pt-advanced-cloud-2 }
            
.print-site-enumerate-headings #pt-advanced-inspire > h1:before { content: '6.10 ' }

                .print-site-enumerate-headings #pt-advanced-inspire h2:before { content: '6.10.' counter(counter-pt-advanced-inspire-2) ' ' }
                .print-site-enumerate-headings #pt-advanced-inspire h2 {  counter-increment: counter-pt-advanced-inspire-2 }
            
.print-site-enumerate-headings #pt-advanced-administration > h1:before { content: '6.11 ' }

                .print-site-enumerate-headings #pt-advanced-administration h2:before { content: '6.11.' counter(counter-pt-advanced-administration-2) ' ' }
                .print-site-enumerate-headings #pt-advanced-administration h2 {  counter-increment: counter-pt-advanced-administration-2 }
            
.print-site-enumerate-headings #pt-advanced-bridges > h1:before { content: '6.12 ' }

                .print-site-enumerate-headings #pt-advanced-bridges h2:before { content: '6.12.' counter(counter-pt-advanced-bridges-2) ' ' }
                .print-site-enumerate-headings #pt-advanced-bridges h2 {  counter-increment: counter-pt-advanced-bridges-2 }
            
.print-site-enumerate-headings #pt-conclusion > h1:before { content: '7 ' }

                .print-site-enumerate-headings #pt-conclusion h2:before { content: '7.' counter(counter-pt-conclusion-2) ' ' }
                .print-site-enumerate-headings #pt-conclusion h2 {  counter-reset: counter-pt-conclusion-3 ;  counter-increment: counter-pt-conclusion-2 }
            
                .print-site-enumerate-headings #pt-conclusion h3:before { content: '7.' counter(counter-pt-conclusion-2) '.' counter(counter-pt-conclusion-3) ' ' }
                .print-site-enumerate-headings #pt-conclusion h3 {  counter-increment: counter-pt-conclusion-3 }
            </style>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2025 pygeoapi community
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "/", "features": ["navigation.indexes"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado para \u00e1rea de transfer\u00eancia", "clipboard.copy": "Copiar para \u00e1rea de transfer\u00eancia", "search.result.more.one": "Mais 1 nesta p\u00e1gina", "search.result.more.other": "Mais # nesta p\u00e1gina", "search.result.none": "Nenhum resultado encontrado", "search.result.one": "1 resultado encontrado", "search.result.other": "# resultados encontrados", "search.result.placeholder": "Digite para iniciar a busca", "search.result.term.missing": "Ausente", "select.version": "Selecione a vers\u00e3o"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../assets/javascripts/termynal.js"></script>
      
        <script src="../assets/javascripts/custom.js"></script>
      
    
  </body>
</html>